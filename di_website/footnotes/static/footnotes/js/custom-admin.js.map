{"version":3,"sources":["webpack:///../../footnotes/static/footnotes/js/custom-admin.js","webpack:///./node_modules/shortid/index.js","webpack:///./footnotes/static_src/footnotes/app/footnotes.entry.js","webpack:///./footnotes/static_src/footnotes/js/decorators/Footnote.js","webpack:///./footnotes/static_src/footnotes/js/blocks/FootnoteEntity.js","webpack:///./node_modules/shortid/lib/index.js","webpack:///./node_modules/shortid/lib/random/random-from-seed.js","webpack:///./node_modules/shortid/lib/build.js","webpack:///./node_modules/shortid/lib/generate.js","webpack:///./node_modules/shortid/lib/random/random-byte-browser.js","webpack:///./node_modules/nanoid/format.js","webpack:///./node_modules/shortid/lib/is-valid.js","webpack:///./node_modules/shortid/lib/util/cluster-worker-id-browser.js","webpack:///./footnotes/static_src/footnotes/js/sources/FootnoteSource.js","webpack:///(webpack)/buildin/global.js","webpack:///./footnotes/static_src/footnotes/js/footnote-chooser-modal.js","webpack:///./footnotes/static_src/footnotes/js/DraftUtils.js","webpack:///./node_modules/shortid/lib/alphabet.js"],"names":["customJsonpFunction","130","module","exports","__webpack_require__","332","__webpack_exports__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__js_decorators_Footnote__","__WEBPACK_IMPORTED_MODULE_1__js_sources_FootnoteSource__","draftail","window","type","source","FootnoteSource","decorator","Footnote","forEach","registerPlugin","333","__WEBPACK_IMPORTED_MODULE_0__blocks_FootnoteEntity__","TooltipEntity","props","entityKey","contentState","React","createElement","334","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","d","FootnoteEntity","_extends","assign","target","i","arguments","length","key","hasOwnProperty","_createClass","defineProperties","descriptor","protoProps","staticProps","Component","Icon","wagtail","components","ICON","name","className","shortid","require","$","jQuery","getAttributes","data","icon","label","text","footnoteUUIDList","checkExistingUUID","uuid","verifiedUUID","generate","handleUUID","lastChangeType","replaceEntityData","_Component","this","_this","getPrototypeOf","_this$props","_props","getEditorState","getLastChangeType","children","getEntity","getData","hide","role","335","seed","seedValue","alphabet","worker","workerId","clusterWorkerId","characters","newCharacters","undefined","shuffled","build","isValid","336","getNextValue","setSeed","_seed_","nextValue","337","str","seconds","Math","floor","Date","now","REDUCE_TIME","previousSeconds","counter","version","338","number","done","loopCounter","format","random","get","pow","339","randomByte","crypto","msCrypto","getRandomValues","size","Uint8Array","bytes","push","340","mask","log","LN2","step","ceil","id","byte","341","isShortId","RegExp","replace","test","342","343","global","__WEBPACK_IMPORTED_MODULE_0__footnote_chooser_modal__","__WEBPACK_IMPORTED_MODULE_1__DraftUtils__","Modifier","DraftJS","RichUtils","EditorState","Draftail","ENTITY_TYPE","STRINGS","wagtailConfig","MUTABILITY","getChooserConfig","entityType","entity","selectedText","urlParams","url","onload","FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS","filterEntityData","onChosen","bind","onClose","_this2","editorState","getSelectionText","_getChooserConfig","document","body","on","workflow","ModalWorkflow","responses","footnoteChosen","onError","alert","SERVER_ERROR","off","_props2","onComplete","content","getCurrentContent","selection","getSelection","entityData","mutability","contentWithEntity","createEntity","getLastCreatedEntityKey","nextState","isCollapsed","newText","newContent","replaceText","toggleLink","close","e","preventDefault","defaultProps","344","g","Function","eval","345","chooser","modal","jsonData","formdata","FormData","ajax","action","processData","contentType","dataType","success","loadResponseText","footnote_chosen","respond","346","getSelectedBlocksList","selectionState","startKey","getStartKey","endKey","getEndKey","blockMap","getBlockMap","toSeq","skipUntil","_","k","takeUntil","concat","toList","start","getAnchorOffset","end","getFocusOffset","selectedBlocks","getIsBackward","temp","blockStart","blockEnd","getText","slice","66","reset","setCharacters","_alphabet_","ORIGINAL","Error","unique","split","filter","item","ind","arr","lastIndexOf","join","randomFromSeed","previousSeed","shuffle","characterIndex","sourceArray","targetArray","r","splice","getShuffled","lookup","index"],"mappings":"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","file":"../../footnotes/static/footnotes/js/custom-admin.js","sourcesContent":["customJsonpFunction([1],{\n\n/***/ 130:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nmodule.exports = __webpack_require__(335);\n\n\n/***/ }),\n\n/***/ 332:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__js_decorators_Footnote__ = __webpack_require__(333);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__js_sources_FootnoteSource__ = __webpack_require__(343);\n\n\n\nvar draftail = window.draftail;\n\n// Plugins for the built-in entities.\nvar plugins = [{\n  type: 'FOOTNOTE',\n  source: __WEBPACK_IMPORTED_MODULE_1__js_sources_FootnoteSource__[\"a\" /* default */],\n  decorator: __WEBPACK_IMPORTED_MODULE_0__js_decorators_Footnote__[\"a\" /* default */]\n}];\n\nplugins.forEach(draftail.registerPlugin);\n\n/***/ }),\n\n/***/ 333:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__blocks_FootnoteEntity__ = __webpack_require__(334);\n\nvar TooltipEntity = window.draftail.TooltipEntity;\n\n\nvar Footnote = function Footnote(props) {\n    var entityKey = props.entityKey,\n        contentState = props.contentState;\n\n\n    return React.createElement(__WEBPACK_IMPORTED_MODULE_0__blocks_FootnoteEntity__[\"a\" /* FootnoteEntity */], props);\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Footnote);\n\n/***/ }),\n\n/***/ 334:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return FootnoteEntity; });\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Component = window.React.Component;\nvar Icon = window.wagtail.components.Icon;\nvar TooltipEntity = window.draftail.TooltipEntity;\nvar ICON = React.createElement(Icon, { name: \"asterisk\", className: \"asterisk\" });\nvar shortid = __webpack_require__(130);\nvar $ = window.jQuery;\n\nvar getAttributes = function getAttributes(data) {\n    var icon = ICON;\n    var label = data.text || null;\n\n    return {\n        icon: icon,\n        label: label\n    };\n};\n\nwindow.footnoteUUIDList = window.footnoteUUIDList || {};\n\nvar checkExistingUUID = function checkExistingUUID(entityKey, uuid) {\n\n    // check that this uuid doesn't already exist (which would happen with a copy/paste action)\n    var verifiedUUID = void 0;\n\n    if (typeof window.footnoteUUIDList[uuid] === 'undefined') {\n        verifiedUUID = uuid;\n    } else if (window.footnoteUUIDList[uuid] !== entityKey) {\n        verifiedUUID = shortid.generate();\n    } else if (window.footnoteUUIDList[uuid] === entityKey) {\n        verifiedUUID = uuid;\n    }\n\n    window.footnoteUUIDList[verifiedUUID] = entityKey;\n    return verifiedUUID;\n};\n\nvar handleUUID = function handleUUID(lastChangeType, contentState, entityKey, data) {\n\n    var verifiedUUID = data.uuid;\n\n    if (lastChangeType === 'insert-fragment') {\n        verifiedUUID = checkExistingUUID(entityKey, data.uuid);\n    } else {\n        window.footnoteUUIDList[verifiedUUID] = entityKey;\n    }\n\n    contentState.replaceEntityData(entityKey, {\n        text: data.text,\n        uuid: verifiedUUID\n    });\n};\n\nvar FootnoteEntity = function (_Component) {\n    _inherits(FootnoteEntity, _Component);\n\n    function FootnoteEntity(props) {\n        _classCallCheck(this, FootnoteEntity);\n\n        var _this = _possibleConstructorReturn(this, (FootnoteEntity.__proto__ || Object.getPrototypeOf(FootnoteEntity)).call(this, props));\n\n        var _this$props = _this.props,\n            contentState = _this$props.contentState,\n            entityKey = _this$props.entityKey;\n        return _this;\n    }\n\n    _createClass(FootnoteEntity, [{\n        key: \"render\",\n        value: function render() {\n            var _props = this.props,\n                contentState = _props.contentState,\n                entityKey = _props.entityKey;\n\n\n            var lastChangeType = this.props.getEditorState().getLastChangeType();\n\n            this.props.children = '';\n            var data = contentState.getEntity(entityKey).getData();\n            handleUUID(lastChangeType, contentState, entityKey, data);\n\n            // TODO: find a way to set the 'showTooltipAt' state of the tooltip entity properly\n            // This .hide() instruction is here as the tooltip entity appears on sibling entities when a footnote is removed\n            $('.Tooltip.Tooltip--top').hide();\n\n            return React.createElement(\n                \"span\",\n                {\n                    role: \"button\",\n                    className: \"FootnoteEntity\"\n                },\n                React.createElement(TooltipEntity, _extends({}, this.props, getAttributes(data)))\n            );\n        }\n    }]);\n\n    return FootnoteEntity;\n}(Component);\n\n/***/ }),\n\n/***/ 335:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(66);\nvar build = __webpack_require__(337);\nvar isValid = __webpack_require__(341);\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = __webpack_require__(342) || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n\n\n/***/ }),\n\n/***/ 336:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n\n\n/***/ }),\n\n/***/ 337:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar generate = __webpack_require__(338);\nvar alphabet = __webpack_require__(66);\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1459707606518;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 6;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n\n\n/***/ }),\n\n/***/ 338:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(66);\nvar random = __webpack_require__(339);\nvar format = __webpack_require__(340);\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n\n\n/***/ }),\n\n/***/ 339:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar crypto = typeof window === 'object' && (window.crypto || window.msCrypto); // IE 11 uses window.msCrypto\n\nvar randomByte;\n\nif (!crypto || !crypto.getRandomValues) {\n    randomByte = function(size) {\n        var bytes = [];\n        for (var i = 0; i < size; i++) {\n            bytes.push(Math.floor(Math.random() * 256));\n        }\n        return bytes;\n    };\n} else {\n    randomByte = function(size) {\n        return crypto.getRandomValues(new Uint8Array(size));\n    };\n}\n\nmodule.exports = randomByte;\n\n\n/***/ }),\n\n/***/ 340:\n/***/ (function(module, exports) {\n\n/**\n * Secure random string generator with custom alphabet.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {generator} random The random bytes generator.\n * @param {string} alphabet Symbols to be used in new random string.\n * @param {size} size The number of symbols in new random string.\n *\n * @return {string} Random string.\n *\n * @example\n * const format = require('nanoid/format')\n *\n * function random (size) {\n *   const result = []\n *   for (let i = 0; i < size; i++) {\n *     result.push(randomByte())\n *   }\n *   return result\n * }\n *\n * format(random, \"abcdef\", 5) //=> \"fbaef\"\n *\n * @name format\n * @function\n */\nmodule.exports = function (random, alphabet, size) {\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  var step = Math.ceil(1.6 * mask * size / alphabet.length)\n  size = +size\n\n  var id = ''\n  while (true) {\n    var bytes = random(step)\n    for (var i = 0; i < step; i++) {\n      var byte = bytes[i] & mask\n      if (alphabet[byte]) {\n        id += alphabet[byte]\n        if (id.length === size) return id\n      }\n    }\n  }\n}\n\n/**\n * @callback generator\n * @param {number} bytes The number of bytes to generate.\n * @return {number[]} Random bytes.\n */\n\n\n/***/ }),\n\n/***/ 341:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar alphabet = __webpack_require__(66);\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n\n\n/***/ }),\n\n/***/ 342:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = 0;\n\n\n/***/ }),\n\n/***/ 343:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(global) {/* unused harmony export getChooserConfig */\n/* unused harmony export filterEntityData */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__footnote_chooser_modal__ = __webpack_require__(345);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__DraftUtils__ = __webpack_require__(346);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Component = window.React.Component;\nvar Modifier = window.DraftJS.Modifier;\nvar RichUtils = window.DraftJS.RichUtils;\nvar EditorState = window.DraftJS.EditorState;\nvar ENTITY_TYPE = window.Draftail.ENTITY_TYPE;\n\n\nvar shortid = __webpack_require__(130);\nvar $ = window.jQuery;\n\nvar STRINGS = window.wagtailConfig.STRINGS.STRINGS;\n\nvar FOOTNOTE = 'FOOTNOTE';\nvar MUTABILITY = {};\nMUTABILITY[FOOTNOTE] = 'IMMUTABLE';\n\nvar getChooserConfig = function getChooserConfig(entityType, entity, selectedText) {\n    var url = void 0;\n    var urlParams = void 0;\n    switch (entityType.type) {\n        case FOOTNOTE:\n            urlParams = {\n                text: selectedText,\n                uuid: shortid.generate()\n            };\n\n            if (entity) {\n                var data = entity.getData();\n                if (data.text) {\n                    urlParams.text = data.text;\n                }\n                if (data.uuid) {\n                    urlParams.uuid = data.uuid;\n                }\n            }\n\n            return {\n                url: '/admin/footnotes/chooser/',\n                urlParams: urlParams,\n                onload: __WEBPACK_IMPORTED_MODULE_0__footnote_chooser_modal__[\"a\" /* FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS */]\n            };\n\n        default:\n            return {\n                url: null,\n                urlParams: {},\n                onload: {}\n            };\n    }\n};\n\nvar filterEntityData = function filterEntityData(entityType, data) {\n    switch (entityType.type) {\n        case FOOTNOTE:\n            return {\n                text: data.text,\n                uuid: data.uuid\n            };\n        default:\n            return {};\n    }\n};\n\n/**\n * Interfaces with Wagtail's ModalWorkflow to open the chooser,\n * and create new content in Draft.js based on the data.\n */\n\nvar FootnoteSource = function (_Component) {\n    _inherits(FootnoteSource, _Component);\n\n    function FootnoteSource(props) {\n        _classCallCheck(this, FootnoteSource);\n\n        var _this = _possibleConstructorReturn(this, (FootnoteSource.__proto__ || Object.getPrototypeOf(FootnoteSource)).call(this, props));\n\n        _this.onChosen = _this.onChosen.bind(_this);\n        _this.onClose = _this.onClose.bind(_this);\n        return _this;\n    }\n\n    _createClass(FootnoteSource, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            var _this2 = this;\n\n            var _props = this.props,\n                onClose = _props.onClose,\n                entityType = _props.entityType,\n                entity = _props.entity,\n                editorState = _props.editorState;\n\n            var selectedText = Object(__WEBPACK_IMPORTED_MODULE_1__DraftUtils__[\"a\" /* getSelectionText */])(editorState);\n\n            var _getChooserConfig = getChooserConfig(entityType, entity, selectedText),\n                url = _getChooserConfig.url,\n                urlParams = _getChooserConfig.urlParams,\n                onload = _getChooserConfig.onload;\n\n            $(document.body).on('hidden.bs.modal', this.onClose);\n\n            // eslint-disable-next-line new-cap\n            this.workflow = global.ModalWorkflow({\n                url: url,\n                urlParams: urlParams,\n                onload: onload,\n                responses: {\n                    footnoteChosen: function footnoteChosen(data) {\n                        return _this2.onChosen(data);\n                    }\n                },\n                onError: function onError() {\n                    // eslint-disable-next-line no-alert\n                    window.alert(STRINGS.SERVER_ERROR);\n                    onClose();\n                }\n            });\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            this.workflow = null;\n            $(document.body).off('hidden.bs.modal', this.onClose);\n        }\n    }, {\n        key: 'onChosen',\n        value: function onChosen(data) {\n            var _props2 = this.props,\n                editorState = _props2.editorState,\n                entityType = _props2.entityType,\n                onComplete = _props2.onComplete;\n\n            var content = editorState.getCurrentContent();\n            var selection = editorState.getSelection();\n\n            var entityData = filterEntityData(entityType, data);\n            var mutability = MUTABILITY[entityType.type];\n            var contentWithEntity = content.createEntity(entityType.type, mutability, entityData);\n            var entityKey = contentWithEntity.getLastCreatedEntityKey();\n\n            var nextState = void 0;\n\n            // Replace text if the chooser demands it, or if there is no selected text in the first place.\n            var shouldReplaceText = data.text || selection.isCollapsed();\n\n            if (shouldReplaceText) {\n                var newText = data.text;\n                var newContent = Modifier.replaceText(content, selection, newText, null, entityKey);\n                nextState = EditorState.push(editorState, newContent, 'insert-characters');\n            } else {\n                nextState = RichUtils.toggleLink(editorState, selection, entityKey);\n            }\n\n            // IE11 crashes when rendering the new entity in contenteditable if the modal is still open.\n            // Other browsers do not mind. This is probably a focus management problem.\n            // From the user's perspective, this is all happening too fast to notice either way.\n            this.workflow.close();\n\n            onComplete(nextState);\n        }\n    }, {\n        key: 'onClose',\n        value: function onClose(e) {\n            var onClose = this.props.onClose;\n\n            e.preventDefault();\n\n            onClose();\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            return null;\n        }\n    }]);\n\n    return FootnoteSource;\n}(Component);\n\nFootnoteSource.defaultProps = {\n    entity: null\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (FootnoteSource);\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(344)))\n\n/***/ }),\n\n/***/ 344:\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ }),\n\n/***/ 345:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS; });\nvar FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS = {\n    'chooser': function chooser(modal, jsonData) {\n        $('form.footnote-form', modal.body).on('submit', function () {\n            var formdata = new FormData(this);\n\n            $.ajax({\n                url: this.action,\n                data: formdata,\n                processData: false,\n                contentType: false,\n                type: 'POST',\n                dataType: 'text',\n                success: modal.loadResponseText\n            });\n\n            return false;\n        });\n    },\n    'footnote_chosen': function footnote_chosen(modal, jsonData) {\n        modal.respond('footnoteChosen', jsonData['footnote_data']);\n        modal.close();\n    }\n};\n\n/***/ }),\n\n/***/ 346:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return getSelectionText; });\n\n/**\n* Returns collection of currently selected blocks.\n* See https://github.com/jpuri/draftjs-utils/blob/e81c0ae19c3b0fdef7e0c1b70d924398956be126/js/block.js#L19.\n*/\nvar getSelectedBlocksList = function getSelectedBlocksList(editorState) {\n  var selectionState = editorState.getSelection();\n  var content = editorState.getCurrentContent();\n  var startKey = selectionState.getStartKey();\n  var endKey = selectionState.getEndKey();\n  var blockMap = content.getBlockMap();\n  var blocks = blockMap.toSeq().skipUntil(function (_, k) {\n    return k === startKey;\n  }).takeUntil(function (_, k) {\n    return k === endKey;\n  }).concat([[endKey, blockMap.get(endKey)]]);\n  return blocks.toList();\n};\n\n/**\n* Returns the currently selected text in the editor.\n* See https://github.com/jpuri/draftjs-utils/blob/e81c0ae19c3b0fdef7e0c1b70d924398956be126/js/block.js#L106.\n*/\nvar getSelectionText = function getSelectionText(editorState) {\n  var selection = editorState.getSelection();\n  var start = selection.getAnchorOffset();\n  var end = selection.getFocusOffset();\n  var selectedBlocks = getSelectedBlocksList(editorState);\n\n  if (selection.getIsBackward()) {\n    var temp = start;\n    start = end;\n    end = temp;\n  }\n\n  var selectedText = '';\n  for (var i = 0; i < selectedBlocks.size; i += 1) {\n    var blockStart = i === 0 ? start : 0;\n    var blockEnd = i === selectedBlocks.size - 1 ? end : selectedBlocks.get(i).getText().length;\n    selectedText += selectedBlocks.get(i).getText().slice(blockStart, blockEnd);\n  }\n\n  return selectedText;\n};\n\n/***/ }),\n\n/***/ 66:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar randomFromSeed = __webpack_require__(336);\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n\n\n/***/ })\n\n},[332]);\n\n\n// WEBPACK FOOTER //\n// ../../footnotes/static/footnotes/js/custom-admin.js","'use strict';\nmodule.exports = require('./lib/index');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/index.js\n// module id = 130\n// module chunks = 1","import Footnote from '../js/decorators/Footnote';\nimport FootnoteSource from '../js/sources/FootnoteSource';\n\nconst draftail = window.draftail;\n\n// Plugins for the built-in entities.\nconst plugins = [\n  {\n    type: 'FOOTNOTE',\n    source: FootnoteSource,\n    decorator: Footnote,\n  },\n];\n\nplugins.forEach(draftail.registerPlugin);\n\n\n\n// WEBPACK FOOTER //\n// ./footnotes/static_src/footnotes/app/footnotes.entry.js","import PropTypes from 'prop-types';\nconst TooltipEntity = window.draftail.TooltipEntity;\nimport { FootnoteEntity } from '../blocks/FootnoteEntity';\n\nconst Footnote = (props) => {\n    const { entityKey, contentState } = props;\n\n    return (\n        <FootnoteEntity\n            {...props}\n        />\n    );\n};\n\nFootnote.propTypes = {\n    entityKey: PropTypes.string.isRequired,\n    contentState: PropTypes.object.isRequired,\n};\n\nexport default Footnote;\n\n\n\n// WEBPACK FOOTER //\n// ./footnotes/static_src/footnotes/js/decorators/Footnote.js","import PropTypes from 'prop-types';\nconst Component = window.React.Component;\nconst Icon = window.wagtail.components.Icon;\nconst TooltipEntity = window.draftail.TooltipEntity;\nconst ICON = <Icon name=\"asterisk\" className=\"asterisk\" />;\nconst shortid = require('shortid');\nconst $ = window.jQuery;\n\nconst getAttributes = (data) => {\n    const icon = ICON;\n    const label = data.text || null;\n\n    return {\n        icon,\n        label,\n    };\n};\n\nwindow.footnoteUUIDList = window.footnoteUUIDList || {};\n\nconst checkExistingUUID = (entityKey, uuid) => {\n\n    // check that this uuid doesn't already exist (which would happen with a copy/paste action)\n    let verifiedUUID;\n\n    if (typeof window.footnoteUUIDList[uuid] === 'undefined') {\n        verifiedUUID = uuid;\n    } else if (window.footnoteUUIDList[uuid] !== entityKey) {\n        verifiedUUID = shortid.generate();\n    } else if (window.footnoteUUIDList[uuid] === entityKey) {\n        verifiedUUID = uuid;\n    }\n\n    window.footnoteUUIDList[verifiedUUID] = entityKey;\n    return verifiedUUID;\n}\n\nconst handleUUID = (lastChangeType, contentState, entityKey, data) => {\n\n    let verifiedUUID = data.uuid;\n\n    if (lastChangeType === 'insert-fragment') {\n        verifiedUUID = checkExistingUUID(entityKey, data.uuid);\n    } else {\n        window.footnoteUUIDList[verifiedUUID] = entityKey;\n    }\n\n    contentState.replaceEntityData(\n        entityKey,\n        {\n            text: data.text,\n            uuid: verifiedUUID\n        }\n    );\n}\n\nexport class FootnoteEntity extends Component {\n    constructor(props) {\n        super(props);\n\n        const {\n            contentState,\n            entityKey,\n        } = this.props;\n    }\n\n    render() {\n        const {\n            contentState,\n            entityKey,\n        } = this.props;\n\n        const lastChangeType = this.props.getEditorState().getLastChangeType();\n\n        this.props.children = '';\n        const data = contentState.getEntity(entityKey).getData();\n        handleUUID(lastChangeType, contentState, entityKey, data);\n\n        // TODO: find a way to set the 'showTooltipAt' state of the tooltip entity properly\n        // This .hide() instruction is here as the tooltip entity appears on sibling entities when a footnote is removed\n        $('.Tooltip.Tooltip--top').hide();\n\n        return (\n            <span\n                role=\"button\"\n                className=\"FootnoteEntity\"\n            >\n                <TooltipEntity\n                    {...this.props}\n                    {...getAttributes(data)}\n                />\n            </span>\n        );\n    }\n}\n\nFootnoteEntity.propTypes = {\n    entityKey: PropTypes.string.isRequired,\n    children: PropTypes.node.isRequired,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./footnotes/static_src/footnotes/js/blocks/FootnoteEntity.js","'use strict';\n\nvar alphabet = require('./alphabet');\nvar build = require('./build');\nvar isValid = require('./is-valid');\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = require('./util/cluster-worker-id') || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/index.js\n// module id = 335\n// module chunks = 1","'use strict';\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/random/random-from-seed.js\n// module id = 336\n// module chunks = 1","'use strict';\n\nvar generate = require('./generate');\nvar alphabet = require('./alphabet');\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1459707606518;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 6;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/build.js\n// module id = 337\n// module chunks = 1","'use strict';\n\nvar alphabet = require('./alphabet');\nvar random = require('./random/random-byte');\nvar format = require('nanoid/format');\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/generate.js\n// module id = 338\n// module chunks = 1","'use strict';\n\nvar crypto = typeof window === 'object' && (window.crypto || window.msCrypto); // IE 11 uses window.msCrypto\n\nvar randomByte;\n\nif (!crypto || !crypto.getRandomValues) {\n    randomByte = function(size) {\n        var bytes = [];\n        for (var i = 0; i < size; i++) {\n            bytes.push(Math.floor(Math.random() * 256));\n        }\n        return bytes;\n    };\n} else {\n    randomByte = function(size) {\n        return crypto.getRandomValues(new Uint8Array(size));\n    };\n}\n\nmodule.exports = randomByte;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/random/random-byte-browser.js\n// module id = 339\n// module chunks = 1","/**\n * Secure random string generator with custom alphabet.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {generator} random The random bytes generator.\n * @param {string} alphabet Symbols to be used in new random string.\n * @param {size} size The number of symbols in new random string.\n *\n * @return {string} Random string.\n *\n * @example\n * const format = require('nanoid/format')\n *\n * function random (size) {\n *   const result = []\n *   for (let i = 0; i < size; i++) {\n *     result.push(randomByte())\n *   }\n *   return result\n * }\n *\n * format(random, \"abcdef\", 5) //=> \"fbaef\"\n *\n * @name format\n * @function\n */\nmodule.exports = function (random, alphabet, size) {\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  var step = Math.ceil(1.6 * mask * size / alphabet.length)\n  size = +size\n\n  var id = ''\n  while (true) {\n    var bytes = random(step)\n    for (var i = 0; i < step; i++) {\n      var byte = bytes[i] & mask\n      if (alphabet[byte]) {\n        id += alphabet[byte]\n        if (id.length === size) return id\n      }\n    }\n  }\n}\n\n/**\n * @callback generator\n * @param {number} bytes The number of bytes to generate.\n * @return {number[]} Random bytes.\n */\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/nanoid/format.js\n// module id = 340\n// module chunks = 1","'use strict';\nvar alphabet = require('./alphabet');\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/is-valid.js\n// module id = 341\n// module chunks = 1","'use strict';\n\nmodule.exports = 0;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/util/cluster-worker-id-browser.js\n// module id = 342\n// module chunks = 1","import PropTypes from 'prop-types';\nconst Component = window.React.Component;\nconst Modifier = window.DraftJS.Modifier;\nconst RichUtils = window.DraftJS.RichUtils;\nconst EditorState = window.DraftJS.EditorState;\nconst ENTITY_TYPE = window.Draftail.ENTITY_TYPE;\nimport { FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS } from '../footnote-chooser-modal';\nimport { getSelectionText } from '../DraftUtils';\nconst shortid = require('shortid');\nconst $ = window.jQuery;\n\nconst { STRINGS } = window.wagtailConfig.STRINGS;\nconst FOOTNOTE = 'FOOTNOTE';\nconst MUTABILITY = {};\nMUTABILITY[FOOTNOTE] = 'IMMUTABLE';\n\nexport const getChooserConfig = (entityType, entity, selectedText) => {\n    let url;\n    let urlParams;\n    switch (entityType.type) {\n        case FOOTNOTE:\n            urlParams = {\n                text: selectedText,\n                uuid: shortid.generate(),\n            };\n\n            if (entity) {\n                const data = entity.getData();\n                if (data.text) {\n                     urlParams.text = data.text;\n                }\n                if (data.uuid) {\n                     urlParams.uuid = data.uuid;\n                }\n            }\n\n            return {\n                url: '/admin/footnotes/chooser/',\n                urlParams: urlParams,\n                onload: FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS,\n            };\n\n        default:\n            return {\n                url: null,\n                urlParams: {},\n                onload: {},\n            };\n    }\n};\n\nexport const filterEntityData = (entityType, data) => {\n    switch (entityType.type) {\n    case FOOTNOTE:\n        return {\n            text: data.text,\n            uuid: data.uuid,\n        };\n    default:\n        return {};\n    }\n};\n\n/**\n * Interfaces with Wagtail's ModalWorkflow to open the chooser,\n * and create new content in Draft.js based on the data.\n */\nclass FootnoteSource extends Component {\n    constructor(props) {\n        super(props);\n        this.onChosen = this.onChosen.bind(this);\n        this.onClose = this.onClose.bind(this);\n    }\n\n    componentDidMount() {\n        const { onClose, entityType, entity, editorState } = this.props;\n        const selectedText = getSelectionText(editorState);\n        const { url, urlParams, onload } = getChooserConfig(entityType, entity, selectedText);\n\n        $(document.body).on('hidden.bs.modal', this.onClose);\n\n        // eslint-disable-next-line new-cap\n        this.workflow = global.ModalWorkflow({\n            url,\n            urlParams,\n            onload,\n            responses: {\n                footnoteChosen: (data) => this.onChosen(data),\n            },\n            onError: () => {\n                // eslint-disable-next-line no-alert\n                window.alert(STRINGS.SERVER_ERROR);\n                onClose();\n            },\n        });\n    }\n\n    componentWillUnmount() {\n        this.workflow = null;\n        $(document.body).off('hidden.bs.modal', this.onClose);\n    }\n\n    onChosen(data) {\n        const { editorState, entityType, onComplete } = this.props;\n        const content = editorState.getCurrentContent();\n        const selection = editorState.getSelection();\n\n        const entityData = filterEntityData(entityType, data);\n        const mutability = MUTABILITY[entityType.type];\n        const contentWithEntity = content.createEntity(entityType.type, mutability, entityData);\n        const entityKey = contentWithEntity.getLastCreatedEntityKey();\n\n        let nextState;\n\n        // Replace text if the chooser demands it, or if there is no selected text in the first place.\n        const shouldReplaceText = data.text || selection.isCollapsed();\n\n        if (shouldReplaceText) {\n            const newText = data.text;\n            const newContent = Modifier.replaceText(content, selection, newText, null, entityKey);\n            nextState = EditorState.push(editorState, newContent, 'insert-characters');\n        }\n        else {\n            nextState = RichUtils.toggleLink(editorState, selection, entityKey);\n        }\n\n        // IE11 crashes when rendering the new entity in contenteditable if the modal is still open.\n        // Other browsers do not mind. This is probably a focus management problem.\n        // From the user's perspective, this is all happening too fast to notice either way.\n        this.workflow.close();\n\n        onComplete(nextState);\n    }\n\n    onClose(e) {\n        const { onClose } = this.props;\n        e.preventDefault();\n\n        onClose();\n    }\n\n    render() {\n        return null;\n    }\n}\n\nFootnoteSource.propTypes = {\n    editorState: PropTypes.object.isRequired,\n    entityType: PropTypes.object.isRequired,\n    entity: PropTypes.object,\n    onComplete: PropTypes.func.isRequired,\n    onClose: PropTypes.func.isRequired,\n};\n\nFootnoteSource.defaultProps = {\n    entity: null,\n};\n\nexport default FootnoteSource;\n\n\n\n// WEBPACK FOOTER //\n// ./footnotes/static_src/footnotes/js/sources/FootnoteSource.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 344\n// module chunks = 1","export const FOOTNOTE_CHOOSER_MODAL_ONLOAD_HANDLERS = {\n    'chooser': function(modal, jsonData) {\n        $('form.footnote-form', modal.body).on('submit', function() {\n            var formdata = new FormData(this);\n\n            $.ajax({\n                url: this.action,\n                data: formdata,\n                processData: false,\n                contentType: false,\n                type: 'POST',\n                dataType: 'text',\n                success: modal.loadResponseText\n            });\n\n            return false;\n        });\n    },\n    'footnote_chosen': function(modal, jsonData) {\n        modal.respond('footnoteChosen', jsonData['footnote_data']);\n        modal.close();\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./footnotes/static_src/footnotes/js/footnote-chooser-modal.js","\n  /**\n  * Returns collection of currently selected blocks.\n  * See https://github.com/jpuri/draftjs-utils/blob/e81c0ae19c3b0fdef7e0c1b70d924398956be126/js/block.js#L19.\n  */\n  const getSelectedBlocksList = (editorState) => {\n    const selectionState = editorState.getSelection();\n    const content = editorState.getCurrentContent();\n    const startKey = selectionState.getStartKey();\n    const endKey = selectionState.getEndKey();\n    const blockMap = content.getBlockMap();\n    const blocks =  blockMap\n      .toSeq()\n      .skipUntil((_, k) => k === startKey)\n      .takeUntil((_, k) => k === endKey)\n      .concat([[endKey, blockMap.get(endKey)]]);\n    return blocks.toList();\n  };\n\n  /**\n  * Returns the currently selected text in the editor.\n  * See https://github.com/jpuri/draftjs-utils/blob/e81c0ae19c3b0fdef7e0c1b70d924398956be126/js/block.js#L106.\n  */\n  export const getSelectionText = (editorState) => {\n    const selection = editorState.getSelection();\n    let start = selection.getAnchorOffset();\n    let end = selection.getFocusOffset();\n    const selectedBlocks = getSelectedBlocksList(editorState);\n\n    if (selection.getIsBackward()) {\n      const temp = start;\n      start = end;\n      end = temp;\n    }\n\n    let selectedText = '';\n    for (let i = 0; i < selectedBlocks.size; i += 1) {\n      const blockStart = i === 0 ? start : 0;\n      const blockEnd = i === (selectedBlocks.size - 1) ? end : selectedBlocks.get(i).getText().length;\n      selectedText += selectedBlocks.get(i).getText().slice(blockStart, blockEnd);\n    }\n\n    return selectedText;\n  };\n\n\n\n// WEBPACK FOOTER //\n// ./footnotes/static_src/footnotes/js/DraftUtils.js","'use strict';\n\nvar randomFromSeed = require('./random/random-from-seed');\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/shortid/lib/alphabet.js\n// module id = 66\n// module chunks = 1"],"sourceRoot":""}