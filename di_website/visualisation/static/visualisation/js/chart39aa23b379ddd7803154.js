(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1062:function(e,t,n){"use strict";e.exports=function(e,t){for(var n,a=e._fullData.length,r=0;r<a;r++){var o=e._fullData[r];if(o.index!==t.index&&("carpet"===o.type&&(n||(n=o),o.carpet===t.carpet)))return o}return n}},1145:function(e,t,n){"use strict";var a=n(380).isArrayOrTypedArray;e.exports=function(e,t,n){var r;for(a(e)?e.length>t.length&&(e=e.slice(0,t.length)):e=[],r=0;r<t.length;r++)e[r]=n(t[r]);return e}},1146:function(e,t,n){"use strict";e.exports=function(e,t,n){if(0===e.length)return"";var a,r=[],o=n?3:1;for(a=0;a<e.length;a+=o)r.push(e[a]+","+t[a]),n&&a<e.length-o&&(r.push("C"),r.push([e[a+1]+","+t[a+1],e[a+2]+","+t[a+2]+" "].join(" ")));return r.join(n?"":"L")}},1287:function(e,t,n){"use strict";var a=n(484),r=n(591),o=n(396),i=n(387).extendFlat,s=r.contours;e.exports=i({carpet:{valType:"string",role:"info",editType:"calc",description:["The `carpet` of the carpet axes on which this contour trace lies"].join(" ")},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:r.fillcolor,autocontour:r.autocontour,ncontours:r.ncontours,contours:{type:s.type,start:s.start,end:s.end,size:s.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",role:"style",editType:"calc",description:["Determines the coloring method showing the contour values.","If *fill*, coloring is done evenly between each contour level","If *lines*, coloring is done on the contour lines.","If *none*, no coloring is applied on this trace."].join(" ")},showlines:s.showlines,showlabels:s.showlabels,labelfont:s.labelfont,labelformat:s.labelformat,operation:s.operation,value:s.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:r.line.color,width:r.line.width,dash:r.line.dash,smoothing:r.line.smoothing,editType:"plot"},transforms:void 0},o("",{cLetter:"z",autoColorDflt:!1}))},1288:function(e,t,n){"use strict";var a=n(380),r=n(678),o=n(1287),i=n(854),s=n(708),l=n(709);e.exports=function(e,t,n,c){function h(n,r){return a.coerce(e,t,o,n,r)}if(h("carpet"),e.a&&e.b){if(!r(e,t,h,c,"a","b"))return void(t.visible=!1);h("text"),"constraint"===h("contours.type")?i(e,t,h,c,n,{hasHover:!1}):(s(e,t,h,(function(n){return a.coerce2(e,t,o,n)})),l(e,t,h,c,{hasHover:!1}))}else t._defaultColor=n,t._length=null}},1525:function(e,t,n){"use strict";e.exports=n(1587)},1587:function(e,t,n){"use strict";e.exports={attributes:n(1287),supplyDefaults:n(1288),colorbar:n(710),calc:n(1588),plot:n(1589),style:n(856),moduleType:"trace",name:"contourcarpet",basePlotModule:n(409),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{hrName:"contour_carpet",description:["Plots contours on either the first carpet axis or the","carpet axis with a matching `carpet` attribute. Data `z`","is interpreted as matching that of the corresponding carpet","axis."].join(" ")}}},1588:function(e,t,n){"use strict";var a=n(421),r=n(380),o=n(557),i=n(556),s=n(544),l=n(545),c=n(612),h=n(1288),u=n(1062),p=n(737);e.exports=function(e,t){var n=t._carpetTrace=u(e,t);if(n&&n.visible&&"legendonly"!==n.visible){if(!t.a||!t.b){var f=e.data[n.index],d=e.data[t.index];d.a||(d.a=f.a),d.b||(d.b=f.b),h(d,t,t._defaultColor,e._fullLayout)}var g=function(e,t){var n,h,u,p,f,d,g,v=t._carpetTrace,y=v.aaxis,m=v.baxis;y._minDtick=0,m._minDtick=0,r.isArray1D(t.z)&&o(t,y,m,"a","b",["z"]);n=t._a=t._a||t.a,p=t._b=t._b||t.b,n=n?y.makeCalcdata(t,"_a"):[],p=p?m.makeCalcdata(t,"_b"):[],h=t.a0||0,u=t.da||1,f=t.b0||0,d=t.db||1,g=t._z=i(t._z||t.z,t.transpose),t._emptypoints=l(g),s(g,t._emptypoints);var x=r.maxRowLength(g),b="scaled"===t.xtype?"":n,T=c(t,b,h,u,x,y),M="scaled"===t.ytype?"":p,A=c(t,M,f,d,g.length,m),w={a:T,b:A,z:g};"levels"===t.contours.type&&"none"!==t.contours.coloring&&a(e,t,{vals:g,containerStr:"",cLetter:"z"});return[w]}(e,t);return p(t,t._z),g}}},1589:function(e,t,n){"use strict";var a=n(383),r=n(1145),o=n(1146),i=n(386),s=n(380),l=n(886),c=n(887),h=n(855),u=n(592),p=n(889),f=n(888),d=n(890),g=n(1062),v=n(1590);function y(e,t,n){var a=e.getPointAtLength(t),r=e.getPointAtLength(n),o=r.x-a.x,i=r.y-a.y,s=Math.sqrt(o*o+i*i);return[o/s,i/s]}function m(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function x(e,t){var n=Math.abs(e[0]*t[0]+e[1]*t[1]);return Math.sqrt(1-n*n)/n}e.exports=function(e,t,n,b){var T=t.xaxis,M=t.yaxis;s.makeTraceGroups(b,n,"contour").each((function(n){var b=a.select(this),A=n[0],w=A.trace,L=w._carpetTrace=g(e,w),_=e.calcdata[L.index][0];if(L.visible&&"legendonly"!==L.visible){var S=A.a,z=A.b,E=w.contours,O=f(E,t,A),I="constraint"===E.type,k=E._operation,C=I?"="===k?"lines":"fill":E.coloring,D=[[S[0],z[z.length-1]],[S[S.length-1],z[z.length-1]],[S[S.length-1],z[0]],[S[0],z[0]]];l(O);var N=1e-8*(S[S.length-1]-S[0]),R=1e-8*(z[z.length-1]-z[0]);c(O,N,R);var j,B,F,P,H=O;"constraint"===E.type&&(H=p(O,k)),function(e,t){var n,a,r,o,i,s,l,c,h;for(n=0;n<e.length;n++){for(o=e[n],i=o.pedgepaths=[],s=o.ppaths=[],a=0;a<o.edgepaths.length;a++){for(h=o.edgepaths[a],l=[],r=0;r<h.length;r++)l[r]=t(h[r]);i.push(l)}for(a=0;a<o.paths.length;a++){for(h=o.paths[a],c=[],r=0;r<h.length;r++)c[r]=t(h[r]);s.push(c)}}}(O,V);var G=[];for(P=_.clipsegments.length-1;P>=0;P--)j=_.clipsegments[P],B=r([],j.x,T.c2p),F=r([],j.y,M.c2p),B.reverse(),F.reverse(),G.push(o(B,F,j.bicubic));var q="M"+G.join("L")+"Z";!function(e,t,n,a,i,l){var c,h,u,p,f=s.ensureSingle(e,"g","contourbg").selectAll("path").data("fill"!==l||i?[]:[0]);f.enter().append("path"),f.exit().remove();var d=[];for(p=0;p<t.length;p++)c=t[p],h=r([],c.x,n.c2p),u=r([],c.y,a.c2p),d.push(o(h,u,c.bicubic));f.attr("d","M"+d.join("L")+"Z").style("stroke","none")}(b,_.clipsegments,T,M,I,C),function(e,t,n,r,o,l,c,h,u,p,f){var g="fill"===p;g&&d(o,e.contours);var y=s.ensureSingle(t,"g","contourfill").selectAll("path").data(g?o:[]);y.enter().append("path"),y.exit().remove(),y.each((function(e){var t=(e.prefixBoundary?f:"")+function(e,t,n,a,r,o,l,c){var h,u,p,f,d,g,y,m="",x=t.edgepaths.map((function(e,t){return t})),b=!0,T=1e-4*Math.abs(n[0][0]-n[2][0]),M=1e-4*Math.abs(n[0][1]-n[2][1]);function A(e){return Math.abs(e[1]-n[0][1])<M}function w(e){return Math.abs(e[1]-n[2][1])<M}function L(e){return Math.abs(e[0]-n[0][0])<T}function _(e){return Math.abs(e[0]-n[2][0])<T}function S(e,t){var n,a,i,s,h="";for(A(e)&&!_(e)||w(e)&&!L(e)?(s=r.aaxis,i=v(r,o,[e[0],t[0]],.5*(e[1]+t[1]))):(s=r.baxis,i=v(r,o,.5*(e[0]+t[0]),[e[1],t[1]])),n=1;n<i.length;n++)for(h+=s.smoothing?"C":"L",a=0;a<i[n].length;a++){var u=i[n][a];h+=[l.c2p(u[0]),c.c2p(u[1])]+" "}return h}h=0,u=null;for(;x.length;){var z=t.edgepaths[h][0];for(u&&(m+=S(u,z)),y=i.smoothopen(t.edgepaths[h].map(a),t.smoothing),m+=b?y:y.replace(/^M/,"L"),x.splice(x.indexOf(h),1),u=t.edgepaths[h][t.edgepaths[h].length-1],d=-1,f=0;f<4;f++){if(!u){s.log("Missing end?",h,t);break}for(A(u)&&!_(u)?p=n[1]:L(u)?p=n[0]:w(u)?p=n[3]:_(u)&&(p=n[2]),g=0;g<t.edgepaths.length;g++){var E=t.edgepaths[g][0];Math.abs(u[0]-p[0])<T?Math.abs(u[0]-E[0])<T&&(E[1]-u[1])*(p[1]-E[1])>=0&&(p=E,d=g):Math.abs(u[1]-p[1])<M?Math.abs(u[1]-E[1])<M&&(E[0]-u[0])*(p[0]-E[0])>=0&&(p=E,d=g):s.log("endpt to newendpt is not vert. or horz.",u,p,E)}if(d>=0)break;m+=S(u,p),u=p}if(d===t.edgepaths.length){s.log("unclosed perimeter path");break}h=d,(b=-1===x.indexOf(h))&&(h=x[0],m+=S(u,p)+"Z",u=null)}for(h=0;h<t.paths.length;h++)m+=i.smoothclosed(t.paths[h].map(a),t.smoothing);return m}(0,e,l,c,h,u,n,r);t?a.select(this).attr("d",t).style("stroke","none"):a.select(this).remove()}))}(w,b,T,M,H,D,V,L,_,C,q),function(e,t,n,r,o,l,c){var p=s.ensureSingle(e,"g","contourlines"),f=!1!==o.showlines,d=o.showlabels,g=f&&d,v=h.createLines(p,f||d,t),b=h.createLineClip(p,g,n,r.trace.uid),T=e.selectAll("g.contourlabels").data(d?[0]:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlabels",!0),d){var M=l.xaxis,A=l.yaxis,w=M._length,L=A._length,_=[[[0,0],[w,0],[w,L],[0,L]]],S=[];s.clearLocationCache();var z=h.labelFormatter(n,r),E=i.tester.append("text").attr("data-notex",1).call(i.font,o.labelfont),O={left:0,right:w,center:w/2,top:0,bottom:L,middle:L/2},I=Math.sqrt(w*w+L*L),k=u.LABELDISTANCE*I/Math.max(1,t.length/u.LABELINCREASE);v.each((function(e){var t=h.calcTextOpts(e.level,z,E,n);a.select(this).selectAll("path").each((function(n){var a=s.getVisibleSegment(this,O,t.height/2);if(a&&(function(e,t,n,a,r,o){for(var i,s=0;s<n.pedgepaths.length;s++)t===n.pedgepaths[s]&&(i=n.edgepaths[s]);if(!i)return;var l=r.a[0],c=r.a[r.a.length-1],h=r.b[0],u=r.b[r.b.length-1];function p(e,t){var n,a=0;return(Math.abs(e[0]-l)<.1||Math.abs(e[0]-c)<.1)&&(n=m(r.dxydb_rough(e[0],e[1],.1)),a=Math.max(a,o*x(t,n)/2)),(Math.abs(e[1]-h)<.1||Math.abs(e[1]-u)<.1)&&(n=m(r.dxyda_rough(e[0],e[1],.1)),a=Math.max(a,o*x(t,n)/2)),a}var f=y(e,0,1),d=y(e,a.total,a.total-1),g=p(i[0],f),v=a.total-p(i[i.length-1],d);a.min<g&&(a.min=g);a.max>v&&(a.max=v);a.len=a.max-a.min}(this,n,e,a,c,t.height),!(a.len<(t.width+t.height)*u.LABELMIN)))for(var r=Math.min(Math.ceil(a.len/k),u.LABELMAX),o=0;o<r;o++){var i=h.findBestTextLocation(this,a,t,S,O);if(!i)break;h.addLabelData(i,t,S,_)}}))})),E.remove(),h.drawLabels(T,S,n,b,g?_:null)}d&&!f&&v.remove()}(b,O,e,A,E,t,L),i.setClipUrl(b,L._clipPathId,e)}function V(e){var t=L.ab2xy(e[0],e[1],!0);return[T.c2p(t[0]),M.c2p(t[1])]}}))}},1590:function(e,t,n){"use strict";var a=n(380).isArrayOrTypedArray;e.exports=function(e,t,n,r){var o,i,s,l,c,h,u,p,f,d,g,v,y,m=a(n)?"a":"b",x=("a"===m?e.aaxis:e.baxis).smoothing,b="a"===m?e.a2i:e.b2j,T="a"===m?n:r,M="a"===m?r:n,A="a"===m?t.a.length:t.b.length,w="a"===m?t.b.length:t.a.length,L=Math.floor("a"===m?e.b2j(M):e.a2i(M)),_="a"===m?function(t){return e.evalxy([],t,L)}:function(t){return e.evalxy([],L,t)};x&&(s=Math.max(0,Math.min(w-2,L)),l=L-s,i="a"===m?function(t,n){return e.dxydi([],t,s,n,l)}:function(t,n){return e.dxydj([],s,t,l,n)});var S=b(T[0]),z=b(T[1]),E=S<z?1:-1,O=1e-8*(z-S),I=E>0?Math.floor:Math.ceil,k=E>0?Math.ceil:Math.floor,C=E>0?Math.min:Math.max,D=E>0?Math.max:Math.min,N=I(S+O),R=k(z-O),j=[[u=_(S)]];for(o=N;o*E<R*E;o+=E)c=[],g=D(S,o),y=(v=C(z,o+E))-g,h=Math.max(0,Math.min(A-2,Math.floor(.5*(g+v)))),p=_(v),x&&(f=i(h,g-h),d=i(h,v-h),c.push([u[0]+f[0]/3*y,u[1]+f[1]/3*y]),c.push([p[0]-d[0]/3*y,p[1]-d[1]/3*y])),c.push(p),j.push(c),u=p;return j}},484:function(e,t,n){"use strict";var a=n(398),r=n(399),o=n(391).hovertemplateAttrs,i=n(396),s=n(485).FORMAT_LINK,l=n(387).extendFlat;e.exports=l({z:{valType:"data_array",editType:"calc",description:"Sets the z data."},x:l({},a.x,{impliedEdits:{xtype:"array"}}),x0:l({},a.x0,{impliedEdits:{xtype:"scaled"}}),dx:l({},a.dx,{impliedEdits:{xtype:"scaled"}}),y:l({},a.y,{impliedEdits:{ytype:"array"}}),y0:l({},a.y0,{impliedEdits:{ytype:"scaled"}}),dy:l({},a.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc",description:"Sets the text elements associated with each z value."},hovertext:{valType:"data_array",editType:"calc",description:"Same as `text`."},transpose:{valType:"boolean",dflt:!1,role:"info",editType:"calc",description:"Transposes the z data."},xtype:{valType:"enumerated",values:["array","scaled"],role:"info",editType:"calc+clearAxisTypes",description:["If *array*, the heatmap's x coordinates are given by *x*","(the default behavior when `x` is provided).","If *scaled*, the heatmap's x coordinates are given by *x0* and *dx*","(the default behavior when `x` is not provided)."].join(" ")},ytype:{valType:"enumerated",values:["array","scaled"],role:"info",editType:"calc+clearAxisTypes",description:["If *array*, the heatmap's y coordinates are given by *y*","(the default behavior when `y` is provided)","If *scaled*, the heatmap's y coordinates are given by *y0* and *dy*","(the default behavior when `y` is not provided)"].join(" ")},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,role:"style",editType:"calc",description:["Picks a smoothing algorithm use to smooth `z` data."].join(" ")},hoverongaps:{valType:"boolean",dflt:!0,role:"style",editType:"none",description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data have hover labels associated with them."].join(" ")},connectgaps:{valType:"boolean",role:"info",editType:"calc",description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data are filled in.","It is defaulted to true if `z` is a","one dimensional array and `zsmooth` is not false;","otherwise it is defaulted to false."].join(" ")},xgap:{valType:"number",dflt:0,min:0,role:"style",editType:"plot",description:"Sets the horizontal gap (in pixels) between bricks."},ygap:{valType:"number",dflt:0,min:0,role:"style",editType:"plot",description:"Sets the vertical gap (in pixels) between bricks."},zhoverformat:{valType:"string",dflt:"",role:"style",editType:"none",description:["Sets the hover text formatting rule using d3 formatting mini-languages","which are very similar to those in Python. See:",s].join(" ")},hovertemplate:o(),showlegend:l({},r.showlegend,{dflt:!1})},{transforms:void 0},i("",{cLetter:"z",autoColorDflt:!1}))},496:function(e,t,n){"use strict";e.exports=function(e){return e.end+e.size/1e6}},544:function(e,t,n){"use strict";var a=n(380),r=[[-1,0],[1,0],[0,-1],[0,1]];function o(e){return.5-.25*Math.min(1,.5*e)}function i(e,t,n){var a,o,i,s,l,c,h,u,p,f,d,g,v,y=0;for(s=0;s<t.length;s++){for(o=(a=t[s])[0],i=a[1],d=e[o][i],f=0,p=0,l=0;l<4;l++)(h=e[o+(c=r[l])[0]])&&void 0!==(u=h[i+c[1]])&&(0===f?g=v=u:(g=Math.min(g,u),v=Math.max(v,u)),p++,f+=u);if(0===p)throw"iterateInterp2d order is wrong: no defined neighbors";e[o][i]=f/p,void 0===d?p<4&&(y=1):(e[o][i]=(1+n)*e[o][i]-n*d,v>g&&(y=Math.max(y,Math.abs(e[o][i]-d)/(v-g))))}return y}e.exports=function(e,t){var n,r=1;for(i(e,t),n=0;n<t.length&&!(t[n][2]<4);n++);for(t=t.slice(n),n=0;n<100&&r>.01;n++)r=i(e,t,o(r));return r>.01&&a.log("interp2d didn't converge quickly",r),e}},545:function(e,t,n){"use strict";var a=n(380).maxRowLength;e.exports=function(e){var t,n,r,o,i,s,l,c,h=[],u={},p=[],f=e[0],d=[],g=[0,0,0],v=a(e);for(n=0;n<e.length;n++)for(t=d,d=f,f=e[n+1]||[],r=0;r<v;r++)void 0===d[r]&&((s=(void 0!==d[r-1]?1:0)+(void 0!==d[r+1]?1:0)+(void 0!==t[r]?1:0)+(void 0!==f[r]?1:0))?(0===n&&s++,0===r&&s++,n===e.length-1&&s++,r===d.length-1&&s++,s<4&&(u[[n,r]]=[n,r,s]),h.push([n,r,s])):p.push([n,r]));for(;p.length;){for(l={},c=!1,i=p.length-1;i>=0;i--)(s=((u[[(n=(o=p[i])[0])-1,r=o[1]]]||g)[2]+(u[[n+1,r]]||g)[2]+(u[[n,r-1]]||g)[2]+(u[[n,r+1]]||g)[2])/20)&&(l[o]=[n,r,s],p.splice(i,1),c=!0);if(!c)throw"findEmpties iterated with no new neighbors";for(o in l)u[o]=l[o],h.push(l[o])}return h.sort((function(e,t){return t[2]-e[2]}))}},556:function(e,t,n){"use strict";var a=n(385),r=n(380),o=n(390).BADNUM;e.exports=function(e,t,n,i){var s,l,c,h,u,p;function f(e){if(a(e))return+e}if(t&&t.transpose){for(s=0,u=0;u<e.length;u++)s=Math.max(s,e[u].length);if(0===s)return!1;c=function(e){return e.length},h=function(e,t,n){return(e[n]||[])[t]}}else s=e.length,c=function(e,t){return e[t].length},h=function(e,t,n){return(e[t]||[])[n]};var d=function(e,t,n){return t===o||n===o?o:h(e,t,n)};function g(e){if(t&&"carpet"!==t.type&&"contourcarpet"!==t.type&&e&&"category"===e.type&&t["_"+e._id.charAt(0)].length){var n=e._id.charAt(0),a={},i=t["_"+n+"CategoryMap"]||t[n];for(u=0;u<i.length;u++)a[i[u]]=u;return function(t){var n=a[e._categories[t]];return n+1?n:o}}return r.identity}var v=g(n),y=g(i);i&&"category"===i.type&&(s=i._categories.length);var m=new Array(s);for(u=0;u<s;u++)for(l=n&&"category"===n.type?n._categories.length:c(e,u),m[u]=new Array(l),p=0;p<l;p++)m[u][p]=f(d(e,y(u),v(p)));return m}},557:function(e,t,n){"use strict";var a=n(380),r=n(390).BADNUM;e.exports=function(e,t,n,o,i,s){var l,c,h,u,p=e._length,f=t.makeCalcdata(e,o),d=n.makeCalcdata(e,i),g=e.text,v=void 0!==g&&a.isArray1D(g),y=e.hovertext,m=void 0!==y&&a.isArray1D(y),x=a.distinctVals(f),b=x.vals,T=a.distinctVals(d),M=T.vals,A=[],w=M.length,L=b.length;for(l=0;l<s.length;l++)A[l]=a.init2dArray(w,L);v&&(h=a.init2dArray(w,L)),m&&(u=a.init2dArray(w,L));var _=a.init2dArray(w,L);for(l=0;l<p;l++)if(f[l]!==r&&d[l]!==r){var S=a.findBin(f[l]+x.minDiff/2,b),z=a.findBin(d[l]+T.minDiff/2,M);for(c=0;c<s.length;c++){var E=e[s[c]];A[c][z][S]=E[l],_[z][S]=l}v&&(h[z][S]=g[l]),m&&(u[z][S]=y[l])}for(e["_"+o]=b,e["_"+i]=M,c=0;c<s.length;c++)e["_"+s[c]]=A[c];v&&(e._text=h),m&&(e._hovertext=u),t&&"category"===t.type&&(e["_"+o+"CategoryMap"]=b.map((function(e){return t._categories[e]}))),n&&"category"===n.type&&(e["_"+i+"CategoryMap"]=M.map((function(e){return n._categories[e]}))),e._after2before=_}},591:function(e,t,n){"use strict";var a=n(484),r=n(398),o=n(396),i=n(490).dash,s=n(406),l=n(387).extendFlat,c=n(617),h=c.COMPARISON_OPS2,u=c.INTERVAL_OPS,p=n(485).FORMAT_LINK,f=r.line;e.exports=l({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,zhoverformat:a.zhoverformat,hovertemplate:a.hovertemplate,hoverongaps:a.hoverongaps,connectgaps:l({},a.connectgaps,{description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data are filled in.","It is defaulted to true if `z` is a","one dimensional array","otherwise it is defaulted to false."].join(" ")}),fillcolor:{valType:"color",role:"style",editType:"calc",description:["Sets the fill color if `contours.type` is *constraint*.","Defaults to a half-transparent variant of the line color,","marker color, or marker line color, whichever is available."].join(" ")},autocontour:{valType:"boolean",dflt:!0,role:"style",editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0},description:["Determines whether or not the contour level attributes are","picked by an algorithm.","If *true*, the number of contour levels can be set in `ncontours`.","If *false*, set the contour level attributes in `contours`."].join(" ")},ncontours:{valType:"integer",dflt:15,min:1,role:"style",editType:"calc",description:["Sets the maximum number of contour levels. The actual number","of contours will be chosen automatically to be less than or","equal to the value of `ncontours`.","Has an effect only if `autocontour` is *true* or if","`contours.size` is missing."].join(" ")},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",role:"info",editType:"calc",description:["If `levels`, the data is represented as a contour plot with multiple","levels displayed. If `constraint`, the data is represented as constraints","with the invalid region shaded as specified by the `operation` and","`value` parameters."].join(" ")},start:{valType:"number",dflt:null,role:"style",editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the starting contour level value.","Must be less than `contours.end`"].join(" ")},end:{valType:"number",dflt:null,role:"style",editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the end contour level value.","Must be more than `contours.start`"].join(" ")},size:{valType:"number",dflt:null,min:0,role:"style",editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the step between each contour level.","Must be positive."].join(" ")},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",role:"style",editType:"calc",description:["Determines the coloring method showing the contour values.","If *fill*, coloring is done evenly between each contour level","If *heatmap*, a heatmap gradient coloring is applied","between each contour level.","If *lines*, coloring is done on the contour lines.","If *none*, no coloring is applied on this trace."].join(" ")},showlines:{valType:"boolean",dflt:!0,role:"style",editType:"plot",description:["Determines whether or not the contour lines are drawn.","Has an effect only if `contours.coloring` is set to *fill*."].join(" ")},showlabels:{valType:"boolean",dflt:!1,role:"style",editType:"plot",description:["Determines whether to label the contour lines with their values."].join(" ")},labelfont:s({editType:"plot",colorEditType:"style",description:["Sets the font used for labeling the contour levels.","The default color comes from the lines, if shown.","The default family and size come from `layout.font`."].join(" ")}),labelformat:{valType:"string",dflt:"",role:"style",editType:"plot",description:["Sets the contour label formatting rule using d3 formatting","mini-language which is very similar to Python, see:",p].join(" ")},operation:{valType:"enumerated",values:[].concat(h).concat(u),role:"info",dflt:"=",editType:"calc",description:["Sets the constraint operation.","*=* keeps regions equal to `value`","*<* and *<=* keep regions less than `value`","*>* and *>=* keep regions greater than `value`","*[]*, *()*, *[)*, and *(]* keep regions inside `value[0]` to `value[1]`","*][*, *)(*, *](*, *)[* keep regions outside `value[0]` to value[1]`","Open vs. closed intervals make no difference to constraint display, but","all versions are allowed for consistency with filter transforms."].join(" ")},value:{valType:"any",dflt:0,role:"info",editType:"calc",description:["Sets the value or values of the constraint boundary.","When `operation` is set to one of the comparison values","("+h+")","*value* is expected to be a number.","When `operation` is set to one of the interval values","("+u+")","*value* is expected to be an array of two numbers where the first","is the lower bound and the second is the upper bound."].join(" ")},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:l({},f.color,{editType:"style+colorbars",description:["Sets the color of the contour level.","Has no effect if `contours.coloring` is set to *lines*."].join(" ")}),width:{valType:"number",min:0,role:"style",editType:"style+colorbars",description:["Sets the contour line width in (in px)","Defaults to *0.5* when `contours.type` is *levels*.","Defaults to *2* when `contour.type` is *constraint*."].join(" ")},dash:i,smoothing:l({},f.smoothing,{description:["Sets the amount of smoothing for the contour lines,","where *0* corresponds to no smoothing."].join(" ")}),editType:"plot"}},o("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},592:function(e,t,n){"use strict";e.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},612:function(e,t,n){"use strict";var a=n(381),r=n(380).isArrayOrTypedArray;e.exports=function(e,t,n,o,i,s){var l,c,h,u=[],p=a.traceIs(e,"contour"),f=a.traceIs(e,"histogram"),d=a.traceIs(e,"gl2d");if(r(t)&&t.length>1&&!f&&"category"!==s.type){var g=t.length;if(!(g<=i))return p?t.slice(0,i):t.slice(0,i+1);if(p||d)u=t.slice(0,i);else if(1===i)u=[t[0]-.5,t[0]+.5];else{for(u=[1.5*t[0]-.5*t[1]],h=1;h<g;h++)u.push(.5*(t[h-1]+t[h]));u.push(1.5*t[g-1]-.5*t[g-2])}if(g<i){var v=u[u.length-1],y=v-u[u.length-2];for(h=g;h<i;h++)v+=y,u.push(v)}}else{var m=e[s._id.charAt(0)+"calendar"];if(f)l=s.r2c(n,0,m);else if(r(t)&&1===t.length)l=t[0];else if(void 0===n)l=0;else{l=("log"===s.type?s.d2c:s.r2c)(n,0,m)}for(c=o||1,h=p||d?0:-.5;h<i;h++)u.push(l+c*h)}return u}},613:function(e,t,n){"use strict";var a=n(383),r=n(402),o=n(496);e.exports=function(e){var t=e.contours,n=t.start,i=o(t),s=t.size||1,l=Math.floor((i-n)/s)+1,c="lines"===t.coloring?0:1,h=r.extractOpts(e);isFinite(s)||(s=1,l=1);var u,p,f=h.reversescale?r.flipScale(h.colorscale):h.colorscale,d=f.length,g=new Array(d),v=new Array(d);if("heatmap"===t.coloring){var y=h.min,m=h.max;for(p=0;p<d;p++)u=f[p],g[p]=u[0]*(m-y)+y,v[p]=u[1];var x=a.extent([y,m,t.start,t.start+s*(l-1)]),b=x[y<m?0:1],T=x[y<m?1:0];b!==y&&(g.splice(0,0,b),v.splice(0,0,v[0])),T!==m&&(g.push(T),v.push(v[v.length-1]))}else for(p=0;p<d;p++)u=f[p],g[p]=(u[0]*(l+c-1)-c/2)*s+n,v[p]=u[1];return r.makeColorScaleFunc({domain:g,range:v},{noNumericCheck:!0})}},678:function(e,t,n){"use strict";var a=n(385),r=n(380),o=n(381);function i(e,t){var n=t(e);return"scaled"===(n?t(e+"type","array"):"scaled")&&(t(e+"0"),t("d"+e)),n}e.exports=function(e,t,n,s,l,c){var h,u,p=n("z");if(l=l||"x",c=c||"y",void 0===p||!p.length)return 0;if(r.isArray1D(e.z)){h=n(l),u=n(c);var f=r.minRowLength(h),d=r.minRowLength(u);if(0===f||0===d)return 0;t._length=Math.min(f,d,p.length)}else{if(h=i(l,n),u=i(c,n),!function(e){for(var t,n=!0,o=!1,i=!1,s=0;s<e.length;s++){if(t=e[s],!r.isArrayOrTypedArray(t)){n=!1;break}t.length>0&&(o=!0);for(var l=0;l<t.length;l++)if(a(t[l])){i=!0;break}}return n&&o&&i}(p))return 0;n("transpose"),t._length=null}return o.getComponentMethod("calendars","handleTraceDefaults")(e,t,[l,c],s),!0}},679:function(e,t,n){"use strict";var a=n(380);e.exports=function(e,t,n,r){if(r||(r={}),e("contours.showlabels")){var o=t.font;a.coerceFont(e,"contours.labelfont",{family:o.family,size:o.size,color:n}),e("contours.labelformat")}!1!==r.hasHover&&e("zhoverformat")}},700:function(e,t,n){"use strict";var a=n(383),r=n(411),o=n(381),i=n(380),s=n(402).makeColorScaleFuncFromTrace,l=n(429);function c(e,t){var n=t.length-2,a=i.constrain(i.findBin(e,t),0,n),r=t[a],o=t[a+1],s=i.constrain(a+(e-r)/(o-r)-.5,0,n),l=Math.round(s),c=Math.abs(s-l);return s&&s!==n&&c?{bin0:l,frac:c,bin1:Math.round(l+c/(s-l))}:{bin0:l,bin1:l,frac:0}}function h(e,t){var n=t.length-1,a=i.constrain(i.findBin(e,t),0,n),r=t[a],o=(e-r)/(t[a+1]-r)||0;return o<=0?{bin0:a,bin1:a,frac:0}:o<.5?{bin0:a,bin1:a+1,frac:o}:{bin0:a+1,bin1:a,frac:1-o}}function u(e,t,n){e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=Math.round(255*n[3])}e.exports=function(e,t,n,p){var f=t.xaxis,d=t.yaxis;i.makeTraceGroups(p,n,"hm").each((function(t){var n,p,g,v,y,m,x=a.select(this),b=t[0],T=b.trace,M=b.z,A=b.x,w=b.y,L=b.xCenter,_=b.yCenter,S=o.traceIs(T,"contour"),z=S?"best":T.zsmooth,E=M.length,O=i.maxRowLength(M),I=!1,k=!1;for(m=0;void 0===n&&m<A.length-1;)n=f.c2p(A[m]),m++;for(m=A.length-1;void 0===p&&m>0;)p=f.c2p(A[m]),m--;for(p<n&&(g=p,p=n,n=g,I=!0),m=0;void 0===v&&m<w.length-1;)v=d.c2p(w[m]),m++;for(m=w.length-1;void 0===y&&m>0;)y=d.c2p(w[m]),m--;if(y<v&&(g=v,v=y,y=g,k=!0),S&&(L=A,_=w,A=b.xfill,w=b.yfill),"fast"!==z){var C="best"===z?0:.5;n=Math.max(-C*f._length,n),p=Math.min((1+C)*f._length,p),v=Math.max(-C*d._length,v),y=Math.min((1+C)*d._length,y)}var D=Math.round(p-n),N=Math.round(y-v);if(D<=0||N<=0){x.selectAll("image").data([]).exit().remove()}else{var R,j;"fast"===z?(R=O,j=E):(R=D,j=N);var B=document.createElement("canvas");B.width=R,B.height=j;var F,P,H=B.getContext("2d"),G=s(T,{noNumericCheck:!0,returnArray:!0});"fast"===z?(F=I?function(e){return O-1-e}:i.identity,P=k?function(e){return E-1-e}:i.identity):(F=function(e){return i.constrain(Math.round(f.c2p(A[e])-n),0,D)},P=function(e){return i.constrain(Math.round(d.c2p(w[e])-v),0,N)});var q,V,Z,U,X,W=P(0),J=[W,W],K=I?0:1,Q=k?0:1,Y=0,$=0,ee=0,te=0;if(z){var ne,ae=0;try{ne=new Uint8Array(D*N*4)}catch(e){ne=new Array(D*N*4)}if("best"===z){var re,oe,ie,se=L||A,le=_||w,ce=new Array(se.length),he=new Array(le.length),ue=new Array(D),pe=L?h:c,fe=_?h:c;for(m=0;m<se.length;m++)ce[m]=Math.round(f.c2p(se[m])-n);for(m=0;m<le.length;m++)he[m]=Math.round(d.c2p(le[m])-v);for(m=0;m<D;m++)ue[m]=pe(m,ce);for(V=0;V<N;V++)for(oe=M[(re=fe(V,he)).bin0],ie=M[re.bin1],m=0;m<D;m++,ae+=4)u(ne,ae,X=we(oe,ie,ue[m],re))}else for(V=0;V<E;V++)for(U=M[V],J=P(V),m=0;m<D;m++)X=Ae(U[m],1),u(ne,ae=4*(J*D+F(m)),X);var de=H.createImageData(D,N);try{de.data.set(ne)}catch(e){var ge=de.data,ve=ge.length;for(V=0;V<ve;V++)ge[V]=ne[V]}H.putImageData(de,0,0)}else{var ye=T.xgap,me=T.ygap,xe=Math.floor(ye/2),be=Math.floor(me/2);for(V=0;V<E;V++)if(U=M[V],J.reverse(),J[Q]=P(V+1),J[0]!==J[1]&&void 0!==J[0]&&void 0!==J[1])for(q=[Z=F(0),Z],m=0;m<O;m++)q.reverse(),q[K]=F(m+1),q[0]!==q[1]&&void 0!==q[0]&&void 0!==q[1]&&(X=Ae(U[m],(q[1]-q[0])*(J[1]-J[0])),H.fillStyle="rgba("+X.join(",")+")",H.fillRect(q[0]+xe,J[0]+be,q[1]-q[0]-ye,J[1]-J[0]-me))}$=Math.round($/Y),ee=Math.round(ee/Y),te=Math.round(te/Y);var Te=r("rgb("+$+","+ee+","+te+")");e._hmpixcount=(e._hmpixcount||0)+Y,e._hmlumcount=(e._hmlumcount||0)+Y*Te.getLuminance();var Me=x.selectAll("image").data(t);Me.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"}),Me.attr({height:N,width:D,x:n,y:v,"xlink:href":B.toDataURL("image/png")})}function Ae(e,t){if(void 0!==e){var n=G(e);return n[0]=Math.round(n[0]),n[1]=Math.round(n[1]),n[2]=Math.round(n[2]),Y+=t,$+=n[0]*t,ee+=n[1]*t,te+=n[2]*t,n}return[0,0,0,0]}function we(e,t,n,a){var r=e[n.bin0];if(void 0===r)return Ae(void 0,1);var o,i=e[n.bin1],s=t[n.bin0],l=t[n.bin1],c=i-r||0,h=s-r||0;return o=void 0===i?void 0===l?0:void 0===s?2*(l-r):2*(2*l-s-r)/3:void 0===l?void 0===s?0:2*(2*r-i-s)/3:void 0===s?2*(2*l-i-r)/3:l+r-i-s,Ae(r+n.frac*c+a.frac*(h+n.frac*o))}}))}},701:function(e,t,n){"use strict";var a=n(383);e.exports=function(e){a.select(e).selectAll(".hm image").style("opacity",(function(e){return e.trace.opacity}))}},708:function(e,t,n){"use strict";e.exports=function(e,t,n,a){var r=a("contours.start"),o=a("contours.end"),i=!1===r||!1===o,s=n("contours.size");!(i?t.autocontour=!0:n("autocontour",!1))&&s||n("ncontours")}},709:function(e,t,n){"use strict";var a=n(403),r=n(679);e.exports=function(e,t,n,o,i){var s,l=n("contours.coloring"),c="";"fill"===l&&(s=n("contours.showlines")),!1!==s&&("lines"!==l&&(c=n("line.color","#000")),n("line.width",.5),n("line.dash")),"none"!==l&&(!0!==e.showlegend&&(t.showlegend=!1),t._dfltShowLegend=!1,a(e,t,o,n,{prefix:"",cLetter:"z"})),n("line.smoothing"),r(n,o,c,i)}},710:function(e,t,n){"use strict";var a=n(402),r=n(613),o=n(496);e.exports={min:"zmin",max:"zmax",calc:function(e,t,n){var i=t.contours,s=t.line,l=i.size||1,c=i.coloring,h=r(t,{isColorbar:!0});if("heatmap"===c){var u=a.extractOpts(t);n._fillgradient=u.reversescale?a.flipScale(u.colorscale):u.colorscale,n._zrange=[u.min,u.max]}else"fill"===c&&(n._fillcolor=h);n._line={color:"lines"===c?h:s.color,width:!1!==i.showlines?s.width:0,dash:s.dash},n._levels={start:i.start,end:o(i),size:l}}}},737:function(e,t,n){"use strict";var a=n(384),r=n(380);function o(e,t,n){var r={type:"linear",range:[e,t]};return a.autoTicks(r,(t-e)/(n||15)),r}e.exports=function(e,t){var n=e.contours;if(e.autocontour){var i=e.zmin,s=e.zmax;(e.zauto||void 0===i)&&(i=r.aggNums(Math.min,null,t)),(e.zauto||void 0===s)&&(s=r.aggNums(Math.max,null,t));var l=o(i,s,e.ncontours);n.size=l.dtick,n.start=a.tickFirst(l),l.range.reverse(),n.end=a.tickFirst(l),n.start===i&&(n.start+=n.size),n.end===s&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),r.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if("constraint"!==n.type){var c,h=n.start,u=n.end,p=e._input.contours;if(h>u&&(n.start=p.start=u,u=n.end=p.end=h,h=n.start),!(n.size>0))c=h===u?1:o(h,u,e.ncontours).dtick,p.size=n.size=c}}},854:function(e,t,n){"use strict";var a=n(385),r=n(679),o=n(382),i=o.addOpacity,s=o.opacity,l=n(617),c=l.CONSTRAINT_REDUCTION,h=l.COMPARISON_OPS2;e.exports=function(e,t,n,o,l,u){var p,f,d,g=t.contours,v=n("contours.operation");(g._operation=c[v],function(e,t){var n;-1===h.indexOf(t.operation)?(e("contours.value",[0,1]),Array.isArray(t.value)?t.value.length>2?t.value=t.value.slice(2):0===t.length?t.value=[0,1]:t.length<2?(n=parseFloat(t.value[0]),t.value=[n,n+1]):t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]:a(t.value)&&(n=parseFloat(t.value),t.value=[n,n+1])):(e("contours.value",0),a(t.value)||(Array.isArray(t.value)?t.value=parseFloat(t.value[0]):t.value=0))}(n,g),"="===v?p=g.showlines=!0:(p=n("contours.showlines"),d=n("fillcolor",i((e.line||{}).color||l,.5))),p)&&(f=n("line.color",d&&s(d)?i(t.fillcolor,1):l),n("line.width",2),n("line.dash"));n("line.smoothing"),r(n,o,f,u)}},855:function(e,t,n){"use strict";var a=n(383),r=n(380),o=n(386),i=n(402),s=n(393),l=n(384),c=n(523),h=n(700),u=n(886),p=n(887),f=n(888),d=n(889),g=n(890),v=n(592),y=v.LABELOPTIMIZER;function m(e,t){var n,a,i,s,l,c,h,u="",p=0,f=e.edgepaths.map((function(e,t){return t})),d=!0;function g(e){return Math.abs(e[1]-t[2][1])<.01}function v(e){return Math.abs(e[0]-t[0][0])<.01}function y(e){return Math.abs(e[0]-t[2][0])<.01}for(;f.length;){for(c=o.smoothopen(e.edgepaths[p],e.smoothing),u+=d?c:c.replace(/^M/,"L"),f.splice(f.indexOf(p),1),n=e.edgepaths[p][e.edgepaths[p].length-1],s=-1,i=0;i<4;i++){if(!n){r.log("Missing end?",p,e);break}for(h=n,Math.abs(h[1]-t[0][1])<.01&&!y(n)?a=t[1]:v(n)?a=t[0]:g(n)?a=t[3]:y(n)&&(a=t[2]),l=0;l<e.edgepaths.length;l++){var m=e.edgepaths[l][0];Math.abs(n[0]-a[0])<.01?Math.abs(n[0]-m[0])<.01&&(m[1]-n[1])*(a[1]-m[1])>=0&&(a=m,s=l):Math.abs(n[1]-a[1])<.01?Math.abs(n[1]-m[1])<.01&&(m[0]-n[0])*(a[0]-m[0])>=0&&(a=m,s=l):r.log("endpt to newendpt is not vert. or horz.",n,a,m)}if(n=a,s>=0)break;u+="L"+a}if(s===e.edgepaths.length){r.log("unclosed perimeter path");break}p=s,(d=-1===f.indexOf(p))&&(p=f[0],u+="Z")}for(p=0;p<e.paths.length;p++)u+=o.smoothclosed(e.paths[p],e.smoothing);return u}function x(e,t,n,a){var o=t.width/2,i=t.height/2,s=e.x,l=e.y,c=e.theta,h=Math.cos(c)*o,u=Math.sin(c)*o,p=(s>a.center?a.right-s:s-a.left)/(h+Math.abs(Math.sin(c)*i)),f=(l>a.middle?a.bottom-l:l-a.top)/(Math.abs(u)+Math.cos(c)*i);if(p<1||f<1)return 1/0;var d=y.EDGECOST*(1/(p-1)+1/(f-1));d+=y.ANGLECOST*c*c;for(var g=s-h,v=l-u,m=s+h,x=l+u,b=0;b<n.length;b++){var T=n[b],M=Math.cos(T.theta)*T.width/2,A=Math.sin(T.theta)*T.width/2,w=2*r.segmentDistance(g,v,m,x,T.x-M,T.y-A,T.x+M,T.y+A)/(t.height+T.height),L=T.level===t.level,_=L?y.SAMELEVELDISTANCE:1;if(w<=_)return 1/0;d+=y.NEIGHBORCOST*(L?y.SAMELEVELFACTOR:1)/(w-_)}return d}function b(e){var t,n,a=e.trace._emptypoints,r=[],o=e.z.length,i=e.z[0].length,s=[];for(t=0;t<i;t++)s.push(1);for(t=0;t<o;t++)r.push(s.slice());for(t=0;t<a.length;t++)r[(n=a[t])[0]][n[1]]=0;return e.zmask=r,r}t.plot=function(e,n,i,s){var l=n.xaxis,c=n.yaxis;r.makeTraceGroups(s,i,"contour").each((function(i){var s=a.select(this),y=i[0],x=y.trace,T=y.x,M=y.y,A=x.contours,w=f(A,n,y),L=r.ensureSingle(s,"g","heatmapcoloring"),_=[];"heatmap"===A.coloring&&(_=[i]),h(e,n,_,L),u(w),p(w);var S=l.c2p(T[0],!0),z=l.c2p(T[T.length-1],!0),E=c.c2p(M[0],!0),O=c.c2p(M[M.length-1],!0),I=[[S,O],[z,O],[z,E],[S,E]],k=w;"constraint"===A.type&&(k=d(w,A._operation)),function(e,t,n){var a=r.ensureSingle(e,"g","contourbg").selectAll("path").data("fill"===n.coloring?[0]:[]);a.enter().append("path"),a.exit().remove(),a.attr("d","M"+t.join("L")+"Z").style("stroke","none")}(s,I,A),function(e,t,n,o){var i="fill"===o.coloring||"constraint"===o.type&&"="!==o._operation,s="M"+n.join("L")+"Z";i&&g(t,o);var l=r.ensureSingle(e,"g","contourfill").selectAll("path").data(i?t:[]);l.enter().append("path"),l.exit().remove(),l.each((function(e){var t=(e.prefixBoundary?s:"")+m(e,n);t?a.select(this).attr("d",t).style("stroke","none"):a.select(this).remove()}))}(s,k,I,A),function(e,n,i,s,l){var c=r.ensureSingle(e,"g","contourlines"),h=!1!==l.showlines,u=l.showlabels,p=h&&u,f=t.createLines(c,h||u,n),d=t.createLineClip(c,p,i,s.trace.uid),g=e.selectAll("g.contourlabels").data(u?[0]:[]);if(g.exit().remove(),g.enter().append("g").classed("contourlabels",!0),u){var y=[],m=[];r.clearLocationCache();var x=t.labelFormatter(i,s),b=o.tester.append("text").attr("data-notex",1).call(o.font,l.labelfont),T=n[0].xaxis,M=n[0].yaxis,A=T._length,w=M._length,L=T.range,_=M.range,S=r.aggNums(Math.min,null,s.x),z=r.aggNums(Math.max,null,s.x),E=r.aggNums(Math.min,null,s.y),O=r.aggNums(Math.max,null,s.y),I=Math.max(T.c2p(S,!0),0),k=Math.min(T.c2p(z,!0),A),C=Math.max(M.c2p(O,!0),0),D=Math.min(M.c2p(E,!0),w),N={};L[0]<L[1]?(N.left=I,N.right=k):(N.left=k,N.right=I),_[0]<_[1]?(N.top=C,N.bottom=D):(N.top=D,N.bottom=C),N.middle=(N.top+N.bottom)/2,N.center=(N.left+N.right)/2,y.push([[N.left,N.top],[N.right,N.top],[N.right,N.bottom],[N.left,N.bottom]]);var R=Math.sqrt(A*A+w*w),j=v.LABELDISTANCE*R/Math.max(1,n.length/v.LABELINCREASE);f.each((function(e){var n=t.calcTextOpts(e.level,x,b,i);a.select(this).selectAll("path").each((function(){var e=r.getVisibleSegment(this,N,n.height/2);if(e&&!(e.len<(n.width+n.height)*v.LABELMIN))for(var a=Math.min(Math.ceil(e.len/j),v.LABELMAX),o=0;o<a;o++){var i=t.findBestTextLocation(this,e,n,m,N);if(!i)break;t.addLabelData(i,n,m,y)}}))})),b.remove(),t.drawLabels(g,m,i,d,p?y:null)}u&&!h&&f.remove()}(s,w,e,y,A),function(e,t,n,a,i){var s=a.trace,l=n._fullLayout._clips,c="clip"+s.uid,h=l.selectAll("#"+c).data(s.connectgaps?[]:[0]);if(h.enter().append("clipPath").classed("contourclip",!0).attr("id",c),h.exit().remove(),!1===s.connectgaps){var f={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:a.x,y:a.y,z:b(a),smoothing:0};u([f]),p([f]),g([f],{type:"levels"}),r.ensureSingle(h,"path","").attr("d",(f.prefixBoundary?"M"+i.join("L")+"Z":"")+m(f,i))}else c=null;o.setClipUrl(e,c,n)}(s,n,e,y,I)}))},t.createLines=function(e,t,n){var a=n[0].smoothing,r=e.selectAll("g.contourlevel").data(t?n:[]);if(r.exit().remove(),r.enter().append("g").classed("contourlevel",!0),t){var i=r.selectAll("path.openline").data((function(e){return e.pedgepaths||e.edgepaths}));i.exit().remove(),i.enter().append("path").classed("openline",!0),i.attr("d",(function(e){return o.smoothopen(e,a)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var s=r.selectAll("path.closedline").data((function(e){return e.ppaths||e.paths}));s.exit().remove(),s.enter().append("path").classed("closedline",!0),s.attr("d",(function(e){return o.smoothclosed(e,a)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return r},t.createLineClip=function(e,t,n,a){var r=t?"clipline"+a:null,i=n._fullLayout._clips.selectAll("#"+r).data(t?[0]:[]);return i.exit().remove(),i.enter().append("clipPath").classed("contourlineclip",!0).attr("id",r),o.setClipUrl(e,r,n),i},t.labelFormatter=function(e,t){var n=e._fullLayout,a=t.trace,r=a.contours,o={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(r.labelformat)o.tickformat=r.labelformat,c(o,n);else{var s=i.extractOpts(a);if(s&&s.colorbar&&s.colorbar._axis)o=s.colorbar._axis;else{if("constraint"===r.type){var h=r.value;Array.isArray(h)?o.range=[h[0],h[h.length-1]]:o.range=[h,h]}else o.range=[r.start,r.end],o.nticks=(r.end-r.start)/r.size;o.range[0]===o.range[1]&&(o.range[1]+=o.range[0]||1),o.nticks||(o.nticks=1e3),c(o,n),l.prepTicks(o),o._tmin=null,o._tmax=null}}return function(e){return l.tickText(o,e).text}},t.calcTextOpts=function(e,t,n,a){var r=t(e);n.text(r).call(s.convertToTspans,a);var i=n.node(),l=o.bBox(i,!0);return{text:r,width:l.width,height:l.height,fontSize:+i.style["font-size"].replace("px",""),level:e,dy:(l.top+l.bottom)/2}},t.findBestTextLocation=function(e,t,n,a,o){var i,s,l,c,h,u=n.width;t.isClosed?(s=t.len/y.INITIALSEARCHPOINTS,i=t.min+s/2,l=t.max):(s=(t.len-u)/(y.INITIALSEARCHPOINTS+1),i=t.min+s+u/2,l=t.max-(s+u)/2);for(var p=1/0,f=0;f<y.ITERATIONS;f++){for(var d=i;d<l;d+=s){var g=r.getTextLocation(e,t.total,d,u),v=x(g,n,a,o);v<p&&(p=v,h=g,c=d)}if(p>2*y.MAXCOST)break;f&&(s/=2),l=(i=c-s/2)+1.5*s}if(p<=y.MAXCOST)return h},t.addLabelData=function(e,t,n,a){var r=t.fontSize,o=t.width+r/3,i=Math.max(0,t.height-r/3),s=e.x,l=e.y,c=e.theta,h=Math.sin(c),u=Math.cos(c),p=function(e,t){return[s+e*u-t*h,l+e*h+t*u]},f=[p(-o/2,-i/2),p(-o/2,i/2),p(o/2,i/2),p(o/2,-i/2)];n.push({text:t.text,x:s,y:l,dy:t.dy,theta:c,level:t.level,width:o,height:i}),a.push(f)},t.drawLabels=function(e,t,n,o,i){var l=e.selectAll("text").data(t,(function(e){return e.text+","+e.x+","+e.y+","+e.theta}));if(l.exit().remove(),l.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each((function(e){var t=e.x+Math.sin(e.theta)*e.dy,r=e.y-Math.cos(e.theta)*e.dy;a.select(this).text(e.text).attr({x:t,y:r,transform:"rotate("+180*e.theta/Math.PI+" "+t+" "+r+")"}).call(s.convertToTspans,n)})),i){for(var c="",h=0;h<i.length;h++)c+="M"+i[h].join("L")+"Z";r.ensureSingle(o,"path","").attr("d",c)}}},856:function(e,t,n){"use strict";var a=n(383),r=n(386),o=n(701),i=n(613);e.exports=function(e){var t=a.select(e).selectAll("g.contour");t.style("opacity",(function(e){return e[0].trace.opacity})),t.each((function(e){var t=a.select(this),n=e[0].trace,o=n.contours,s=n.line,l=o.size||1,c=o.start,h="constraint"===o.type,u=!h&&"lines"===o.coloring,p=!h&&"fill"===o.coloring,f=u||p?i(n):null;t.selectAll("g.contourlevel").each((function(e){a.select(this).selectAll("path").call(r.lineGroupStyle,s.width,u?f(e.level):s.color,s.dash)}));var d=o.labelfont;if(t.selectAll("g.contourlabels text").each((function(e){r.font(a.select(this),{family:d.family,size:d.size,color:d.color||(u?f(e.level):s.color)})})),h)t.selectAll("g.contourfill path").style("fill",n.fillcolor);else if(p){var g;t.selectAll("g.contourfill path").style("fill",(function(e){return void 0===g&&(g=e.level),f(e.level+.5*l)})),void 0===g&&(g=c),t.selectAll("g.contourbg path").style("fill",f(g-.5*l))}})),o(e)}},886:function(e,t,n){"use strict";var a=n(592);function r(e,t){var n=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);return 5===n||10===n?e>(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4?5===n?713:1114:5===n?104:208:15===n?0:n}e.exports=function(e){var t,n,o,i,s,l,c,h,u,p=e[0].z,f=p.length,d=p[0].length,g=2===f||2===d;for(n=0;n<f-1;n++)for(i=[],0===n&&(i=i.concat(a.BOTTOMSTART)),n===f-2&&(i=i.concat(a.TOPSTART)),t=0;t<d-1;t++)for(o=i.slice(),0===t&&(o=o.concat(a.LEFTSTART)),t===d-2&&(o=o.concat(a.RIGHTSTART)),s=t+","+n,l=[[p[n][t],p[n][t+1]],[p[n+1][t],p[n+1][t+1]]],u=0;u<e.length;u++)(c=r((h=e[u]).level,l))&&(h.crossings[s]=c,-1!==o.indexOf(c)&&(h.starts.push([t,n]),g&&-1!==o.indexOf(c,o.indexOf(c)+1)&&h.starts.push([t,n])))}},887:function(e,t,n){"use strict";var a=n(380),r=n(592);function o(e,t,n,a){return Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<a}function i(e,t,n,i,l){var c,h=t.join(","),u=e.crossings[h],p=function(e,t,n){var a=0,o=0;e>20&&t?208===e||1114===e?a=0===n[0]?1:-1:o=0===n[1]?1:-1:-1!==r.BOTTOMSTART.indexOf(e)?o=1:-1!==r.LEFTSTART.indexOf(e)?a=1:-1!==r.TOPSTART.indexOf(e)?o=-1:a=-1;return[a,o]}(u,n,t),f=[s(e,t,[-p[0],-p[1]])],d=e.z.length,g=e.z[0].length,v=t.slice(),y=p.slice();for(c=0;c<1e4;c++){if(u>20?(u=r.CHOOSESADDLE[u][(p[0]||p[1])<0?0:1],e.crossings[h]=r.SADDLEREMAINDER[u]):delete e.crossings[h],!(p=r.NEWDELTA[u])){a.log("Found bad marching index:",u,t,e.level);break}f.push(s(e,t,p)),t[0]+=p[0],t[1]+=p[1],h=t.join(","),o(f[f.length-1],f[f.length-2],i,l)&&f.pop();var m=p[0]&&(t[0]<0||t[0]>g-2)||p[1]&&(t[1]<0||t[1]>d-2);if(t[0]===v[0]&&t[1]===v[1]&&p[0]===y[0]&&p[1]===y[1]||n&&m)break;u=e.crossings[h]}1e4===c&&a.log("Infinite loop in contour?");var x,b,T,M,A,w,L,_,S,z,E,O,I,k,C,D=o(f[0],f[f.length-1],i,l),N=0,R=.2*e.smoothing,j=[],B=0;for(c=1;c<f.length;c++)O=f[c],I=f[c-1],k=void 0,C=void 0,k=O[2]-I[2],C=O[3]-I[3],N+=L=Math.sqrt(k*k+C*C),j.push(L);var F=N/j.length*R;function P(e){return f[e%f.length]}for(c=f.length-2;c>=B;c--)if((x=j[c])<F){for(T=0,b=c-1;b>=B&&x+j[b]<F;b--)x+=j[b];if(D&&c===f.length-2)for(T=0;T<b&&x+j[T]<F;T++)x+=j[T];A=c-b+T+1,w=Math.floor((c+b+T+2)/2),M=D||c!==f.length-2?D||-1!==b?A%2?P(w):[(P(w)[0]+P(w+1)[0])/2,(P(w)[1]+P(w+1)[1])/2]:f[0]:f[f.length-1],f.splice(b+1,c-b+1,M),c=b+1,T&&(B=T),D&&(c===f.length-2?f[T]=f[f.length-1]:0===c&&(f[f.length-1]=f[0]))}for(f.splice(0,B),c=0;c<f.length;c++)f[c].length=2;if(!(f.length<2))if(D)f.pop(),e.paths.push(f);else{n||a.log("Unclosed interior contour?",e.level,v.join(","),f.join("L"));var H=!1;for(_=0;_<e.edgepaths.length;_++)if(z=e.edgepaths[_],!H&&o(z[0],f[f.length-1],i,l)){f.pop(),H=!0;var G=!1;for(S=0;S<e.edgepaths.length;S++)if(o((E=e.edgepaths[S])[E.length-1],f[0],i,l)){G=!0,f.shift(),e.edgepaths.splice(_,1),S===_?e.paths.push(f.concat(E)):(S>_&&S--,e.edgepaths[S]=E.concat(f,z));break}G||(e.edgepaths[_]=f.concat(z))}for(_=0;_<e.edgepaths.length&&!H;_++)o((z=e.edgepaths[_])[z.length-1],f[0],i,l)&&(f.shift(),e.edgepaths[_]=z.concat(f),H=!0);H||e.edgepaths.push(f)}}function s(e,t,n){var a=t[0]+Math.max(n[0],0),r=t[1]+Math.max(n[1],0),o=e.z[r][a],i=e.xaxis,s=e.yaxis;if(n[1]){var l=(e.level-o)/(e.z[r][a+1]-o);return[i.c2p((1-l)*e.x[a]+l*e.x[a+1],!0),s.c2p(e.y[r],!0),a+l,r]}var c=(e.level-o)/(e.z[r+1][a]-o);return[i.c2p(e.x[a],!0),s.c2p((1-c)*e.y[r]+c*e.y[r+1],!0),a,r+c]}e.exports=function(e,t,n){var r,o,s,l;for(t=t||.01,n=n||.01,o=0;o<e.length;o++){for(s=e[o],l=0;l<s.starts.length;l++)i(s,s.starts[l],"edge",t,n);for(r=0;Object.keys(s.crossings).length&&r<1e4;)r++,i(s,Object.keys(s.crossings)[0].split(",").map(Number),void 0,t,n);1e4===r&&a.log("Infinite loop in contour?")}}},888:function(e,t,n){"use strict";var a=n(380),r=n(934),o=n(496);e.exports=function(e,t,n){for(var i="constraint"===e.type?r[e._operation](e.value):e,s=i.size,l=[],c=o(i),h=n.trace._carpetTrace,u=h?{xaxis:h.aaxis,yaxis:h.baxis,x:n.a,y:n.b}:{xaxis:t.xaxis,yaxis:t.yaxis,x:n.x,y:n.y},p=i.start;p<c;p+=s)if(l.push(a.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},u)),l.length>1e3){a.warn("Too many contours, clipping at 1000",e);break}return l}},889:function(e,t,n){"use strict";var a=n(380);function r(e){return a.extendFlat({},e,{edgepaths:a.extendDeep([],e.edgepaths),paths:a.extendDeep([],e.paths),starts:a.extendDeep([],e.starts)})}e.exports=function(e,t){var n,o,i,s=function(e){return e.reverse()},l=function(e){return e};switch(t){case"=":case"<":return e;case">":for(1!==e.length&&a.warn("Contour data invalid for the specified inequality operation."),o=e[0],n=0;n<o.edgepaths.length;n++)o.edgepaths[n]=s(o.edgepaths[n]);for(n=0;n<o.paths.length;n++)o.paths[n]=s(o.paths[n]);for(n=0;n<o.starts.length;n++)o.starts[n]=s(o.starts[n]);return e;case"][":var c=s;s=l,l=c;case"[]":for(2!==e.length&&a.warn("Contour data invalid for the specified inequality range operation."),o=r(e[0]),i=r(e[1]),n=0;n<o.edgepaths.length;n++)o.edgepaths[n]=s(o.edgepaths[n]);for(n=0;n<o.paths.length;n++)o.paths[n]=s(o.paths[n]);for(n=0;n<o.starts.length;n++)o.starts[n]=s(o.starts[n]);for(;i.edgepaths.length;)o.edgepaths.push(l(i.edgepaths.shift()));for(;i.paths.length;)o.paths.push(l(i.paths.shift()));for(;i.starts.length;)o.starts.push(l(i.starts.shift()));return[o]}}},890:function(e,t,n){"use strict";e.exports=function(e,t){var n,a=e[0],r=a.z;switch(t.type){case"levels":var o=Math.min(r[0][0],r[0][1]);for(n=0;n<e.length;n++){var i=e[n];i.prefixBoundary=!i.edgepaths.length&&(o>i.level||i.starts.length&&o===i.level)}break;case"constraint":if(a.prefixBoundary=!1,a.edgepaths.length)return;var s=a.x.length,l=a.y.length,c=-1/0,h=1/0;for(n=0;n<l;n++)h=Math.min(h,r[n][0]),h=Math.min(h,r[n][s-1]),c=Math.max(c,r[n][0]),c=Math.max(c,r[n][s-1]);for(n=1;n<s-1;n++)h=Math.min(h,r[0][n]),h=Math.min(h,r[l-1][n]),c=Math.max(c,r[0][n]),c=Math.max(c,r[l-1][n]);var u,p,f=t.value;switch(t._operation){case">":f>c&&(a.prefixBoundary=!0);break;case"<":(f<h||a.starts.length&&f===h)&&(a.prefixBoundary=!0);break;case"[]":u=Math.min(f[0],f[1]),((p=Math.max(f[0],f[1]))<h||u>c||a.starts.length&&p===h)&&(a.prefixBoundary=!0);break;case"][":u=Math.min(f[0],f[1]),p=Math.max(f[0],f[1]),u<h&&p>c&&(a.prefixBoundary=!0)}}}},934:function(e,t,n){"use strict";var a=n(617),r=n(385);function o(e,t){var n,o=Array.isArray(t);function i(e){return r(e)?+e:null}return-1!==a.COMPARISON_OPS2.indexOf(e)?n=i(o?t[0]:t):-1!==a.INTERVAL_OPS.indexOf(e)?n=o?[i(t[0]),i(t[1])]:[i(t),i(t)]:-1!==a.SET_OPS.indexOf(e)&&(n=o?t.map(i):[i(t)]),n}function i(e){return function(t){t=o(e,t);var n=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]);return{start:n,end:a,size:a-n}}}function s(e){return function(t){return{start:t=o(e,t),end:1/0,size:1/0}}}e.exports={"[]":i("[]"),"][":i("]["),">":s(">"),"<":s("<"),"=":s("=")}}}]);