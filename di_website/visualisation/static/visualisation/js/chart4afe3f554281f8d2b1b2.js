(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1210:function(t,e,i){"use strict";var o=i(15),r=i(3),s=i(155),n=i(824);function a(t,e,i,o){var r=o("opacityscale");"max"===r?e.opacityscale=[[0,.1],[1,1]]:"min"===r?e.opacityscale=[[0,1],[1,.1]]:"extremes"===r?e.opacityscale=function(t,e){for(var i=[],o=0;o<32;o++){var r=o/31,s=e+(1-e)*(1-Math.pow(Math.sin(t*r*Math.PI),2));i.push([r,Math.max(0,Math.min(1,s))])}return i}(1,.1):function(t){var e=0;if(!Array.isArray(t)||t.length<2)return!1;if(!t[0]||!t[t.length-1])return!1;if(0!=+t[0][0]||1!=+t[t.length-1][0])return!1;for(var i=0;i<t.length;i++){var o=t[i];if(2!==o.length||+o[0]<e)return!1;e=+o[0]}return!0}(r)||(e.opacityscale=void 0)}function h(t,e,i){e in t&&!(i in t)&&(t[i]=t[e])}t.exports={supplyDefaults:function(t,e,i,l){var c,u;function f(i,o){return r.coerce(t,e,n,i,o)}var d=f("x"),p=f("y"),v=f("z");if(!v||!v.length||d&&d.length<1||p&&p.length<1)e.visible=!1;else{e._xlength=Array.isArray(d)&&r.isArrayOrTypedArray(d[0])?v.length:v[0].length,e._ylength=v.length,o.getComponentMethod("calendars","handleTraceDefaults")(t,e,["x","y","z"],l),f("text"),f("hovertext"),f("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach((function(t){f(t)}));var g=f("surfacecolor"),m=["x","y","z"];for(c=0;c<3;++c){var y="contours."+m[c],_=f(y+".show"),b=f(y+".highlight");if(_||b)for(u=0;u<3;++u)f(y+".project."+m[u]);_&&(f(y+".color"),f(y+".width"),f(y+".usecolormap")),b&&(f(y+".highlightcolor"),f(y+".highlightwidth")),f(y+".start"),f(y+".end"),f(y+".size")}g||(h(t,"zmin","cmin"),h(t,"zmax","cmax"),h(t,"zauto","cauto")),s(t,e,l,f,{prefix:"",cLetter:"c"}),a(t,e,l,f),e._length=null}},opacityscaleDefaults:a}},1577:function(t,e,i){"use strict";t.exports={attributes:i(824),supplyDefaults:i(1210).supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:i(1578),plot:i(1579),moduleType:"trace",name:"surface",basePlotModule:i(780),categories:["gl3d","2dMap","showLegend"],meta:{description:["The data the describes the coordinates of the surface is set in `z`.","Data in `z` should be a {2D array}.","Coordinates in `x` and `y` can either be 1D {arrays}","or {2D arrays} (e.g. to graph parametric surfaces).","If not provided in `x` and `y`, the x and y coordinates are assumed","to be linear starting at 0 with a unit step.","The color scale corresponds to the `z` values by default.","For custom color scales, use `surfacecolor` which should be a {2D array},","where its bounds can be controlled using `cmin` and `cmax`."].join(" ")}}},1578:function(t,e,i){"use strict";var o=i(221);t.exports=function(t,e){e.surfacecolor?o(t,e,{vals:e.surfacecolor,containerStr:"",cLetter:"c"}):o(t,e,{vals:e.z,containerStr:"",cLetter:"c"})}},1579:function(t,e,i){"use strict";var o=i(1580),r=i(669),s=i(1585).d2,n=i(765),a=i(766),h=i(3).isArrayOrTypedArray,l=i(714).parseColorScale,c=i(684),u=i(219).extractOpts;function f(t,e,i){this.scene=t,this.uid=i,this.surface=e,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var d=f.prototype;d.getXat=function(t,e,i,o){var r=h(this.data.x)?h(this.data.x[0])?this.data.x[e][t]:this.data.x[t]:t;return void 0===i?r:o.d2l(r,0,i)},d.getYat=function(t,e,i,o){var r=h(this.data.y)?h(this.data.y[0])?this.data.y[e][t]:this.data.y[e]:e;return void 0===i?r:o.d2l(r,0,i)},d.getZat=function(t,e,i,o){var r=this.data.z[e][t];return null===r&&this.data.connectgaps&&this.data._interpolatedZ&&(r=this.data._interpolatedZ[e][t]),void 0===i?r:o.d2l(r,0,i)},d.handlePick=function(t){if(t.object===this.surface){var e=(t.data.index[0]-1)/this.dataScaleX-1,i=(t.data.index[1]-1)/this.dataScaleY-1,o=Math.max(Math.min(Math.round(e),this.data.z[0].length-1),0),r=Math.max(Math.min(Math.round(i),this.data._ylength-1),0);t.index=[o,r],t.traceCoordinate=[this.getXat(o,r),this.getYat(o,r),this.getZat(o,r)],t.dataCoordinate=[this.getXat(o,r,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(o,r,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(o,r,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var s=0;s<3;s++){var n=t.dataCoordinate[s];null!=n&&(t.dataCoordinate[s]*=this.scene.dataScale[s])}var a=this.data.hovertext||this.data.text;return Array.isArray(a)&&a[r]&&void 0!==a[r][o]?t.textLabel=a[r][o]:t.textLabel=a||"",t.data.dataCoordinate=t.dataCoordinate.slice(),this.surface.highlight(t.data),this.scene.glplot.spikes.position=t.dataCoordinate,!0}};var p=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function v(t,e){if(t<e)return 0;for(var i=0;0===Math.floor(t%e);)t/=e,i++;return i}function g(t){for(var e=[],i=0;i<p.length;i++){var o=p[i];e.push(v(t,o))}return e}function m(t){for(var e=g(t),i=t,o=0;o<p.length;o++)if(e[o]>0){i=p[o];break}return i}function y(t,e){if(!(t<1||e<1)){for(var i=g(t),o=g(e),r=1,s=0;s<p.length;s++)r*=Math.pow(p[s],Math.max(i[s],o[s]));return r}}d.calcXnums=function(t){var e,i=[];for(e=1;e<t;e++){var o=this.getXat(e-1,0),r=this.getXat(e,0);i[e-1]=r!==o&&null!=o&&null!=r?Math.abs(r-o):0}var s=0;for(e=1;e<t;e++)s+=i[e-1];for(e=1;e<t;e++)0===i[e-1]?i[e-1]=1:i[e-1]=Math.round(s/i[e-1]);return i},d.calcYnums=function(t){var e,i=[];for(e=1;e<t;e++){var o=this.getYat(0,e-1),r=this.getYat(0,e);i[e-1]=r!==o&&null!=o&&null!=r?Math.abs(r-o):0}var s=0;for(e=1;e<t;e++)s+=i[e-1];for(e=1;e<t;e++)0===i[e-1]?i[e-1]=1:i[e-1]=Math.round(s/i[e-1]);return i};var _=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],b=_[9],x=_[13];function w(t,e,i){var o=i[8]+i[2]*e[0]+i[5]*e[1];return t[0]=(i[6]+i[0]*e[0]+i[3]*e[1])/o,t[1]=(i[7]+i[1]*e[0]+i[4]*e[1])/o,t}function j(t,e,i){return function(t,e,i,o){for(var r=[0,0],n=t.shape[0],a=t.shape[1],h=0;h<n;h++)for(var l=0;l<a;l++)i(r,[h,l],o),t.set(h,l,s(e,r[0],r[1]))}(t,e,w,i),t}function C(t,e){for(var i=!1,o=0;o<t.length;o++)if(e===t[o]){i=!0;break}!1===i&&t.push(e)}d.estimateScale=function(t,e){for(var i=1+function(t){if(0!==t.length){for(var e=1,i=0;i<t.length;i++)e=y(e,t[i]);return e}}(0===e?this.calcXnums(t):this.calcYnums(t));i<b;)i*=2;for(;i>x;)i--,i/=m(i),++i<b&&(i=x);var o=Math.round(i/t);return o>1?o:1},d.refineCoords=function(t){for(var e=this.dataScaleX,i=this.dataScaleY,o=t[0].shape[0],s=t[0].shape[1],n=0|Math.floor(t[0].shape[0]*e+1),a=0|Math.floor(t[0].shape[1]*i+1),h=1+o+1,l=1+s+1,c=r(new Float32Array(h*l),[h,l]),u=[1/e,0,0,0,1/i,0,0,0,1],f=0;f<t.length;++f){this.surface.padField(c,t[f]);var d=r(new Float32Array(n*a),[n,a]);j(d,c,u),t[f]=d}},d.setContourLevels=function(){var t,e,i,o=[[],[],[]],r=[!1,!1,!1],s=!1;for(t=0;t<3;++t)if(this.showContour[t]&&(s=!0,this.contourSize[t]>0&&null!==this.contourStart[t]&&null!==this.contourEnd[t]&&this.contourEnd[t]>this.contourStart[t]))for(r[t]=!0,e=this.contourStart[t];e<this.contourEnd[t];e+=this.contourSize[t])i=e*this.scene.dataScale[t],C(o[t],i);if(s){var n=[[],[],[]];for(t=0;t<3;++t)this.showContour[t]&&(n[t]=r[t]?o[t]:this.scene.contourLevels[t]);this.surface.update({levels:n})}},d.update=function(t){var e,i,o,s,h=this.scene,f=h.fullSceneLayout,d=this.surface,p=t.opacity,v=l(t,p),g=h.dataScale,m=t.z[0].length,y=t._ylength,_=h.contourLevels;this.data=t;var b=[];for(e=0;e<3;e++)for(b[e]=[],i=0;i<m;i++)b[e][i]=[];for(i=0;i<m;i++)for(o=0;o<y;o++)b[0][i][o]=this.getXat(i,o,t.xcalendar,f.xaxis),b[1][i][o]=this.getYat(i,o,t.ycalendar,f.yaxis),b[2][i][o]=this.getZat(i,o,t.zcalendar,f.zaxis);if(t.connectgaps)for(t._emptypoints=a(b[2]),n(b[2],t._emptypoints),t._interpolatedZ=[],i=0;i<m;i++)for(t._interpolatedZ[i]=[],o=0;o<y;o++)t._interpolatedZ[i][o]=b[2][i][o];for(e=0;e<3;e++)for(i=0;i<m;i++)for(o=0;o<y;o++)null==(s=b[e][i][o])?b[e][i][o]=NaN:s=b[e][i][o]*=g[e];for(e=0;e<3;e++)for(i=0;i<m;i++)for(o=0;o<y;o++)null!=(s=b[e][i][o])&&(this.minValues[e]>s&&(this.minValues[e]=s),this.maxValues[e]<s&&(this.maxValues[e]=s));for(e=0;e<3;e++)this.objectOffset[e]=.5*(this.minValues[e]+this.maxValues[e]);for(e=0;e<3;e++)for(i=0;i<m;i++)for(o=0;o<y;o++)null!=(s=b[e][i][o])&&(b[e][i][o]-=this.objectOffset[e]);var w=[r(new Float32Array(m*y),[m,y]),r(new Float32Array(m*y),[m,y]),r(new Float32Array(m*y),[m,y])];for(e=0;e<3;e++)for(i=0;i<m;i++)for(o=0;o<y;o++)w[e].set(i,o,b[e][i][o]);b=[];var j={colormap:v,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!t.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:t.opacityscale,opacity:t.opacity},C=u(t);if(j.intensityBounds=[C.min,C.max],t.surfacecolor){var S=r(new Float32Array(m*y),[m,y]);for(i=0;i<m;i++)for(o=0;o<y;o++)S.set(i,o,t.surfacecolor[o][i]);w.push(S)}else j.intensityBounds[0]*=g[2],j.intensityBounds[1]*=g[2];(x<w[0].shape[0]||x<w[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(w[0].shape[0],0),this.dataScaleY=this.estimateScale(w[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(w)),t.surfacecolor&&(j.intensity=w.pop());var T=[!0,!0,!0],M=["x","y","z"];for(e=0;e<3;++e){var L=t.contours[M[e]];T[e]=L.highlight,j.showContour[e]=L.show||L.highlight,j.showContour[e]&&(j.contourProject[e]=[L.project.x,L.project.y,L.project.z],L.show?(this.showContour[e]=!0,j.levels[e]=_[e],d.highlightColor[e]=j.contourColor[e]=c(L.color),L.usecolormap?d.highlightTint[e]=j.contourTint[e]=0:d.highlightTint[e]=j.contourTint[e]=1,j.contourWidth[e]=L.width,this.contourStart[e]=L.start,this.contourEnd[e]=L.end,this.contourSize[e]=L.size):(this.showContour[e]=!1,this.contourStart[e]=null,this.contourEnd[e]=null,this.contourSize[e]=0),L.highlight&&(j.dynamicColor[e]=c(L.highlightcolor),j.dynamicWidth[e]=L.highlightwidth))}(function(t){var e=t[0].rgb,i=t[t.length-1].rgb;return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]})(v)&&(j.vertexColor=!0),j.objectOffset=this.objectOffset,j.coords=w,d.update(j),d.visible=t.visible,d.enableDynamic=T,d.enableHighlight=T,d.snapToData=!0,"lighting"in t&&(d.ambientLight=t.lighting.ambient,d.diffuseLight=t.lighting.diffuse,d.specularLight=t.lighting.specular,d.roughness=t.lighting.roughness,d.fresnel=t.lighting.fresnel),"lightposition"in t&&(d.lightPosition=[t.lightposition.x,t.lightposition.y,t.lightposition.z]),p&&p<1&&(d.supportsTransparency=!0)},d.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},t.exports=function(t,e){var i=t.glplot.gl,r=o({gl:i}),s=new f(t,r,e.uid);return r._trace=s,s.update(e),t.glplot.add(r),s}},1580:function(t,e,i){"use strict";t.exports=function(t){var e=t.gl,i=y(e),o=b(e),a=_(e),h=x(e),l=r(e),c=s(e,[{buffer:l,size:4,stride:40,offset:0},{buffer:l,size:3,stride:40,offset:16},{buffer:l,size:3,stride:40,offset:28}]),u=r(e),f=s(e,[{buffer:u,size:4,stride:20,offset:0},{buffer:u,size:1,stride:20,offset:16}]),d=r(e),p=s(e,[{buffer:d,size:2,type:e.FLOAT}]),v=n(e,1,256,e.RGBA,e.UNSIGNED_BYTE);v.minFilter=e.LINEAR,v.magFilter=e.LINEAR;var g=new T(e,[0,0],[[0,0,0],[0,0,0]],i,o,l,c,v,a,h,u,f,d,p,[0,0,0]),m={levels:[[],[],[]]};for(var w in t)m[w]=t[w];return m.colormap=m.colormap||"jet",g.update(m),g};var o=i(666),r=i(651),s=i(704),n=i(763),a=i(648),h=i(1076),l=i(784),c=i(1581),u=i(669),f=i(896),d=i(782),p=i(781),v=i(662),g=i(1583),m=i(1584),y=m.createShader,_=m.createContourShader,b=m.createPickShader,x=m.createPickContourShader,w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],j=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],C=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function S(t,e,i,o,r){this.position=t,this.index=e,this.uv=i,this.level=o,this.dataCoordinate=r}!function(){for(var t=0;t<3;++t){var e=C[t],i=(t+2)%3;e[(t+1)%3+0]=1,e[i+3]=1,e[t+6]=1}}();function T(t,e,i,o,r,s,n,h,l,c,f,d,p,v,g){this.gl=t,this.shape=e,this.bounds=i,this.objectOffset=g,this.intensityBounds=[],this._shader=o,this._pickShader=r,this._coordinateBuffer=s,this._vao=n,this._colorMap=h,this._contourShader=l,this._contourPickShader=c,this._contourBuffer=f,this._contourVAO=d,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new S([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=p,this._dynamicVAO=v,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[u(a.mallocFloat(1024),[0,0]),u(a.mallocFloat(1024),[0,0]),u(a.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.opacityscale=!1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var M=T.prototype;M.isTransparent=function(){return this.opacity<1||this.opacityscale},M.isOpaque=function(){if(this.opacityscale)return!1;if(this.opacity<1)return!1;if(this.opacity>=1)return!0;for(var t=0;t<3;++t)if(this._contourCounts[t].length>0)return!0;return!1},M.pickSlots=1,M.setPickBase=function(t){this.pickId=t};var L=[0,0,0],A={showSurface:!1,showContour:!1,projections:[w.slice(),w.slice(),w.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function z(t,e){var i,o,r,s=e.axes&&e.axes.lastCubeProps.axis||L,n=e.showSurface,a=e.showContour;for(i=0;i<3;++i)for(n=n||e.surfaceProject[i],o=0;o<3;++o)a=a||e.contourProject[i][o];for(i=0;i<3;++i){var h=A.projections[i];for(o=0;o<16;++o)h[o]=0;for(o=0;o<4;++o)h[5*o]=1;h[5*i]=0,h[12+i]=e.axesBounds[+(s[i]>0)][i],d(h,t.model,h);var l=A.clipBounds[i];for(r=0;r<2;++r)for(o=0;o<3;++o)l[r][o]=t.clipBounds[r][o];l[0][i]=-1e8,l[1][i]=1e8}return A.showSurface=n,A.showContour=a,A}var k={model:w,view:w,projection:w,inverseModel:w.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},B=w.slice(),O=[1,0,0,0,1,0,0,0,1];function N(t,e){t=t||{};var i=this.gl;i.disable(i.CULL_FACE),this._colorMap.bind(0);var o=k;o.model=t.model||w,o.view=t.view||w,o.projection=t.projection||w,o.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],o.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],o.objectOffset=this.objectOffset,o.contourColor=this.contourColor[0],o.inverseModel=p(o.inverseModel,o.model);for(var r=0;r<2;++r)for(var s=o.clipBounds[r],n=0;n<3;++n)s[n]=Math.min(Math.max(this.clipBounds[r][n],-1e8),1e8);o.kambient=this.ambientLight,o.kdiffuse=this.diffuseLight,o.kspecular=this.specularLight,o.roughness=this.roughness,o.fresnel=this.fresnel,o.opacity=this.opacity,o.height=0,o.permutation=O,o.vertexColor=this.vertexColor;var a=B;for(d(a,o.view,o.model),d(a,o.projection,a),p(a,a),r=0;r<3;++r)o.eyePosition[r]=a[12+r]/a[15];var h=a[15];for(r=0;r<3;++r)h+=this.lightPosition[r]*a[4*r+3];for(r=0;r<3;++r){var l=a[12+r];for(n=0;n<3;++n)l+=a[4*n+r]*this.lightPosition[n];o.lightPosition[r]=l/h}var c=z(o,this);if(c.showSurface){for(this._shader.bind(),this._shader.uniforms=o,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(i.TRIANGLES,this._vertexCount),r=0;r<3;++r)this.surfaceProject[r]&&this.vertexCount&&(this._shader.uniforms.model=c.projections[r],this._shader.uniforms.clipBounds=c.clipBounds[r],this._vao.draw(i.TRIANGLES,this._vertexCount));this._vao.unbind()}if(c.showContour){var u=this._contourShader;o.kambient=1,o.kdiffuse=0,o.kspecular=0,o.opacity=1,u.bind(),u.uniforms=o;var f=this._contourVAO;for(f.bind(),r=0;r<3;++r)for(u.uniforms.permutation=C[r],i.lineWidth(this.contourWidth[r]*this.pixelRatio),n=0;n<this.contourLevels[r].length;++n)n===this.highlightLevel[r]?(u.uniforms.contourColor=this.highlightColor[r],u.uniforms.contourTint=this.highlightTint[r]):0!==n&&n-1!==this.highlightLevel[r]||(u.uniforms.contourColor=this.contourColor[r],u.uniforms.contourTint=this.contourTint[r]),this._contourCounts[r][n]&&(u.uniforms.height=this.contourLevels[r][n],f.draw(i.LINES,this._contourCounts[r][n],this._contourOffsets[r][n]));for(r=0;r<3;++r)for(u.uniforms.model=c.projections[r],u.uniforms.clipBounds=c.clipBounds[r],n=0;n<3;++n)if(this.contourProject[r][n]){u.uniforms.permutation=C[n],i.lineWidth(this.contourWidth[n]*this.pixelRatio);for(var v=0;v<this.contourLevels[n].length;++v)v===this.highlightLevel[n]?(u.uniforms.contourColor=this.highlightColor[n],u.uniforms.contourTint=this.highlightTint[n]):0!==v&&v-1!==this.highlightLevel[n]||(u.uniforms.contourColor=this.contourColor[n],u.uniforms.contourTint=this.contourTint[n]),this._contourCounts[n][v]&&(u.uniforms.height=this.contourLevels[n][v],f.draw(i.LINES,this._contourCounts[n][v],this._contourOffsets[n][v]))}for(f.unbind(),(f=this._dynamicVAO).bind(),r=0;r<3;++r)if(0!==this._dynamicCounts[r])for(u.uniforms.model=o.model,u.uniforms.clipBounds=o.clipBounds,u.uniforms.permutation=C[r],i.lineWidth(this.dynamicWidth[r]*this.pixelRatio),u.uniforms.contourColor=this.dynamicColor[r],u.uniforms.contourTint=this.dynamicTint[r],u.uniforms.height=this.dynamicLevel[r],f.draw(i.LINES,this._dynamicCounts[r],this._dynamicOffsets[r]),n=0;n<3;++n)this.contourProject[n][r]&&(u.uniforms.model=c.projections[n],u.uniforms.clipBounds=c.clipBounds[n],f.draw(i.LINES,this._dynamicCounts[r],this._dynamicOffsets[r]));f.unbind()}}M.draw=function(t){return N.call(this,t,!1)},M.drawTransparent=function(t){return N.call(this,t,!0)};var P={model:w,view:w,projection:w,inverseModel:w,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function F(t,e){return Array.isArray(t)?[e(t[0]),e(t[1]),e(t[2])]:[e(t),e(t),e(t)]}function E(t){return Array.isArray(t)?3===t.length?[t[0],t[1],t[2],1]:[t[0],t[1],t[2],t[3]]:[0,0,0,1]}function D(t){if(Array.isArray(t)){if(Array.isArray(t))return[E(t[0]),E(t[1]),E(t[2])];var e=E(t);return[e.slice(),e.slice(),e.slice()]}}M.drawPick=function(t){t=t||{};var e=this.gl;e.disable(e.CULL_FACE);var i=P;i.model=t.model||w,i.view=t.view||w,i.projection=t.projection||w,i.shape=this._field[2].shape,i.pickId=this.pickId/255,i.lowerBound=this.bounds[0],i.upperBound=this.bounds[1],i.objectOffset=this.objectOffset,i.permutation=O;for(var o=0;o<2;++o)for(var r=i.clipBounds[o],s=0;s<3;++s)r[s]=Math.min(Math.max(this.clipBounds[o][s],-1e8),1e8);var n=z(i,this);if(n.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=i,this._vao.bind(),this._vao.draw(e.TRIANGLES,this._vertexCount),o=0;o<3;++o)this.surfaceProject[o]&&(this._pickShader.uniforms.model=n.projections[o],this._pickShader.uniforms.clipBounds=n.clipBounds[o],this._vao.draw(e.TRIANGLES,this._vertexCount));this._vao.unbind()}if(n.showContour){var a=this._contourPickShader;a.bind(),a.uniforms=i;var h=this._contourVAO;for(h.bind(),s=0;s<3;++s)for(e.lineWidth(this.contourWidth[s]*this.pixelRatio),a.uniforms.permutation=C[s],o=0;o<this.contourLevels[s].length;++o)this._contourCounts[s][o]&&(a.uniforms.height=this.contourLevels[s][o],h.draw(e.LINES,this._contourCounts[s][o],this._contourOffsets[s][o]));for(o=0;o<3;++o)for(a.uniforms.model=n.projections[o],a.uniforms.clipBounds=n.clipBounds[o],s=0;s<3;++s)if(this.contourProject[o][s]){a.uniforms.permutation=C[s],e.lineWidth(this.contourWidth[s]*this.pixelRatio);for(var l=0;l<this.contourLevels[s].length;++l)this._contourCounts[s][l]&&(a.uniforms.height=this.contourLevels[s][l],h.draw(e.LINES,this._contourCounts[s][l],this._contourOffsets[s][l]))}h.unbind()}},M.pick=function(t){if(!t)return null;if(t.id!==this.pickId)return null;var e=this._field[2].shape,i=this._pickResult,o=e[0]*(t.value[0]+(t.value[2]>>4)/16)/255,r=Math.floor(o),s=o-r,n=e[1]*(t.value[1]+(15&t.value[2])/16)/255,a=Math.floor(n),h=n-a;r+=1,a+=1;var l=i.position;l[0]=l[1]=l[2]=0;for(var c=0;c<2;++c)for(var u=c?s:1-s,f=0;f<2;++f)for(var d=r+c,p=a+f,g=u*(f?h:1-h),m=0;m<3;++m)l[m]+=this._field[m].get(d,p)*g;for(var y=this._pickResult.level,_=0;_<3;++_)if(y[_]=v.le(this.contourLevels[_],l[_]),y[_]<0)this.contourLevels[_].length>0&&(y[_]=0);else if(y[_]<this.contourLevels[_].length-1){var b=this.contourLevels[_][y[_]],x=this.contourLevels[_][y[_]+1];Math.abs(b-l[_])>Math.abs(x-l[_])&&(y[_]+=1)}for(i.index[0]=s<.5?r:r+1,i.index[1]=h<.5?a:a+1,i.uv[0]=o/e[0],i.uv[1]=n/e[1],m=0;m<3;++m)i.dataCoordinate[m]=this._field[m].get(i.index[0],i.index[1]);return i},M.padField=function(t,e){var i=e.shape.slice(),o=t.shape.slice();l.assign(t.lo(1,1).hi(i[0],i[1]),e),l.assign(t.lo(1).hi(i[0],1),e.hi(i[0],1)),l.assign(t.lo(1,o[1]-1).hi(i[0],1),e.lo(0,i[1]-1).hi(i[0],1)),l.assign(t.lo(0,1).hi(1,i[1]),e.hi(1)),l.assign(t.lo(o[0]-1,1).hi(1,i[1]),e.lo(i[0]-1)),t.set(0,0,e.get(0,0)),t.set(0,o[1]-1,e.get(0,i[1]-1)),t.set(o[0]-1,0,e.get(i[0]-1,0)),t.set(o[0]-1,o[1]-1,e.get(i[0]-1,i[1]-1))},M.update=function(t){t=t||{},this.objectOffset=t.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in t&&(this.contourWidth=F(t.contourWidth,Number)),"showContour"in t&&(this.showContour=F(t.showContour,Boolean)),"showSurface"in t&&(this.showSurface=!!t.showSurface),"contourTint"in t&&(this.contourTint=F(t.contourTint,Boolean)),"contourColor"in t&&(this.contourColor=D(t.contourColor)),"contourProject"in t&&(this.contourProject=F(t.contourProject,(function(t){return F(t,Boolean)}))),"surfaceProject"in t&&(this.surfaceProject=t.surfaceProject),"dynamicColor"in t&&(this.dynamicColor=D(t.dynamicColor)),"dynamicTint"in t&&(this.dynamicTint=F(t.dynamicTint,Number)),"dynamicWidth"in t&&(this.dynamicWidth=F(t.dynamicWidth,Number)),"opacity"in t&&(this.opacity=t.opacity),"opacityscale"in t&&(this.opacityscale=t.opacityscale),"colorBounds"in t&&(this.colorBounds=t.colorBounds),"vertexColor"in t&&(this.vertexColor=t.vertexColor?1:0);var e=t.field||t.coords&&t.coords[2]||null,i=!1;if(e||(e=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in t||"coords"in t){var r=(e.shape[0]+2)*(e.shape[1]+2);r>this._field[2].data.length&&(a.freeFloat(this._field[2].data),this._field[2].data=a.mallocFloat(o.nextPow2(r))),this._field[2]=u(this._field[2].data,[e.shape[0]+2,e.shape[1]+2]),this.padField(this._field[2],e),this.shape=e.shape.slice();for(var s=this.shape,n=0;n<2;++n)this._field[2].size>this._field[n].data.length&&(a.freeFloat(this._field[n].data),this._field[n].data=a.mallocFloat(this._field[2].size)),this._field[n]=u(this._field[n].data,[s[0]+2,s[1]+2]);if(t.coords){var d=t.coords;if(!Array.isArray(d)||3!==d.length)throw new Error("gl-surface: invalid coordinates for x/y");for(n=0;n<2;++n){var p=d[n];for(b=0;b<2;++b)if(p.shape[b]!==s[b])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[n],p)}}else if(t.ticks){var v=t.ticks;if(!Array.isArray(v)||2!==v.length)throw new Error("gl-surface: invalid ticks");for(n=0;n<2;++n){var m=v[n];if((Array.isArray(m)||m.length)&&(m=u(m)),m.shape[0]!==s[n])throw new Error("gl-surface: invalid tick length");var y=u(m.data,s);y.stride[n]=m.stride[0],y.stride[1^n]=0,this.padField(this._field[n],y)}}else{for(n=0;n<2;++n){var _=[0,0];_[n]=1,this._field[n]=u(this._field[n].data,[s[0]+2,s[1]+2],_,0)}this._field[0].set(0,0,0);for(var b=0;b<s[0];++b)this._field[0].set(b+1,0,b);for(this._field[0].set(s[0]+1,0,s[0]-1),this._field[1].set(0,0,0),b=0;b<s[1];++b)this._field[1].set(0,b+1,b);this._field[1].set(0,s[1]+1,s[1]-1)}var x=this._field,w=u(a.mallocFloat(3*x[2].size*2),[3,s[0]+2,s[1]+2,2]);for(n=0;n<3;++n)g(w.pick(n),x[n],"mirror");var C=u(a.mallocFloat(3*x[2].size),[s[0]+2,s[1]+2,3]);for(n=0;n<s[0]+2;++n)for(b=0;b<s[1]+2;++b){var S=w.get(0,n,b,0),T=w.get(0,n,b,1),M=w.get(1,n,b,0),L=w.get(1,n,b,1),A=w.get(2,n,b,0),z=w.get(2,n,b,1),k=M*z-L*A,B=A*T-z*S,O=S*L-T*M,N=Math.sqrt(k*k+B*B+O*O);N<1e-8?(N=Math.max(Math.abs(k),Math.abs(B),Math.abs(O)))<1e-8?(O=1,B=k=0,N=1):N=1/N:N=1/Math.sqrt(N),C.set(n,b,0,k*N),C.set(n,b,1,B*N),C.set(n,b,2,O*N)}a.free(w.data);var P=[1/0,1/0,1/0],E=[-1/0,-1/0,-1/0],V=1/0,I=-1/0,W=(s[0]-1)*(s[1]-1)*6,R=a.mallocFloat(o.nextPow2(10*W)),Y=0,X=0;for(n=0;n<s[0]-1;++n)t:for(b=0;b<s[1]-1;++b){for(var Z=0;Z<2;++Z)for(var q=0;q<2;++q)for(var G=0;G<3;++G){var U=this._field[G].get(1+n+Z,1+b+q);if(isNaN(U)||!isFinite(U))continue t}for(G=0;G<6;++G){var H=n+j[G][0],J=b+j[G][1],K=this._field[0].get(H+1,J+1),Q=this._field[1].get(H+1,J+1);U=this._field[2].get(H+1,J+1),k=C.get(H+1,J+1,0),B=C.get(H+1,J+1,1),O=C.get(H+1,J+1,2),t.intensity&&($=t.intensity.get(H,J));var $=t.intensity?t.intensity.get(H,J):U+this.objectOffset[2];R[Y++]=H,R[Y++]=J,R[Y++]=K,R[Y++]=Q,R[Y++]=U,R[Y++]=0,R[Y++]=$,R[Y++]=k,R[Y++]=B,R[Y++]=O,P[0]=Math.min(P[0],K+this.objectOffset[0]),P[1]=Math.min(P[1],Q+this.objectOffset[1]),P[2]=Math.min(P[2],U+this.objectOffset[2]),V=Math.min(V,$),E[0]=Math.max(E[0],K+this.objectOffset[0]),E[1]=Math.max(E[1],Q+this.objectOffset[1]),E[2]=Math.max(E[2],U+this.objectOffset[2]),I=Math.max(I,$),X+=1}}for(t.intensityBounds&&(V=+t.intensityBounds[0],I=+t.intensityBounds[1]),n=6;n<Y;n+=10)R[n]=(R[n]-V)/(I-V);this._vertexCount=X,this._coordinateBuffer.update(R.subarray(0,Y)),a.freeFloat(R),a.free(C.data),this.bounds=[P,E],this.intensity=t.intensity||this._field[2],this.intensityBounds[0]===V&&this.intensityBounds[1]===I||(i=!0),this.intensityBounds=[V,I]}if("levels"in t){var tt=t.levels;for(tt=Array.isArray(tt[0])?tt.slice():[[],[],tt],n=0;n<3;++n)tt[n]=tt[n].slice(),tt[n].sort((function(t,e){return t-e}));for(n=0;n<3;++n)for(b=0;b<tt[n].length;++b)tt[n][b]-=this.objectOffset[n];t:for(n=0;n<3;++n){if(tt[n].length!==this.contourLevels[n].length){i=!0;break}for(b=0;b<tt[n].length;++b)if(tt[n][b]!==this.contourLevels[n][b]){i=!0;break t}}this.contourLevels=tt}if(i){x=this._field,s=this.shape;for(var et=[],it=0;it<3;++it){var ot=this.contourLevels[it],rt=[],st=[],nt=[0,0,0];for(n=0;n<ot.length;++n){var at=f(this._field[it],ot[n]);rt.push(et.length/5|0),X=0;t:for(b=0;b<at.cells.length;++b){var ht=at.cells[b];for(G=0;G<2;++G){var lt=at.positions[ht[G]],ct=lt[0],ut=0|Math.floor(ct),ft=ct-ut,dt=lt[1],pt=0|Math.floor(dt),vt=dt-pt,gt=!1;e:for(var mt=0;mt<3;++mt){nt[mt]=0;var yt=(it+mt+1)%3;for(Z=0;Z<2;++Z){var _t=Z?ft:1-ft;for(H=0|Math.min(Math.max(ut+Z,0),s[0]),q=0;q<2;++q){var bt=q?vt:1-vt;if(J=0|Math.min(Math.max(pt+q,0),s[1]),U=mt<2?this._field[yt].get(H,J):(this.intensity.get(H,J)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(U)||isNaN(U)){gt=!0;break e}var xt=_t*bt;nt[mt]+=xt*U}}}if(gt){if(G>0){for(var wt=0;wt<5;++wt)et.pop();X-=1}continue t}et.push(nt[0],nt[1],lt[0],lt[1],nt[2]),X+=1}}st.push(X)}this._contourOffsets[it]=rt,this._contourCounts[it]=st}var jt=a.mallocFloat(et.length);for(n=0;n<et.length;++n)jt[n]=et[n];this._contourBuffer.update(jt),a.freeFloat(jt)}t.colormap&&this._colorMap.setPixels(function(t,e){var i=c([h({colormap:t,nshades:256,format:"rgba"}).map((function(t,i){var o=e?function(t,e){if(!e)return 1;if(!e.length)return 1;for(var i=0;i<e.length;++i){if(e.length<2)return 1;if(e[i][0]===t)return e[i][1];if(e[i][0]>t&&i>0){var o=(e[i][0]-t)/(e[i][0]-e[i-1][0]);return e[i][1]*(1-o)+o*e[i-1][1]}}return 1}(i/255,e):1;return[t[0],t[1],t[2],255*o]}))]);return l.divseq(i,255),i}(t.colormap,this.opacityscale))},M.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var t=0;t<3;++t)a.freeFloat(this._field[t].data)},M.highlight=function(t){var e,i;if(!t)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(e=0;e<3;++e)this.enableHighlight[e]?this.highlightLevel[e]=t.level[e]:this.highlightLevel[e]=-1;for(i=this.snapToData?t.dataCoordinate:t.position,e=0;e<3;++e)i[e]-=this.objectOffset[e];if(this.enableDynamic[0]&&i[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&i[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&i[2]!==this.dynamicLevel[2]){for(var o=0,r=this.shape,s=a.mallocFloat(12*r[0]*r[1]),n=0;n<3;++n)if(this.enableDynamic[n]){this.dynamicLevel[n]=i[n];var h=(n+1)%3,l=(n+2)%3,c=this._field[n],u=this._field[h],d=this._field[l],p=f(c,i[n]),v=p.cells,g=p.positions;for(this._dynamicOffsets[n]=o,e=0;e<v.length;++e)for(var m=v[e],y=0;y<2;++y){var _=g[m[y]],b=+_[0],x=0|b,w=0|Math.min(x+1,r[0]),j=b-x,C=1-j,S=+_[1],T=0|S,M=0|Math.min(T+1,r[1]),L=S-T,A=1-L,z=C*A,k=C*L,B=j*A,O=j*L,N=z*u.get(x,T)+k*u.get(x,M)+B*u.get(w,T)+O*u.get(w,M),P=z*d.get(x,T)+k*d.get(x,M)+B*d.get(w,T)+O*d.get(w,M);if(isNaN(N)||isNaN(P)){y&&(o-=1);break}s[2*o+0]=N,s[2*o+1]=P,o+=1}this._dynamicCounts[n]=o-this._dynamicOffsets[n]}else this.dynamicLevel[n]=NaN,this._dynamicCounts[n]=0;this._dynamicBuffer.update(s.subarray(0,2*o)),a.freeFloat(s)}}},1581:function(t,e,i){"use strict";var o=i(669),r=i(1582);t.exports=function(t,e){for(var i=[],s=t,n=1;Array.isArray(s);)i.push(s.length),n*=s.length,s=s[0];return 0===i.length?o():(e||(e=o(new Float64Array(n),i)),r(e,t),e)}},1582:function(t,e,i){t.exports=i(752)({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},1583:function(t,e,i){"use strict";t.exports=function(t,e,i){if(Array.isArray(i)){if(i.length!==e.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else i=o(e.dimension,"string"==typeof i?i:"clamp");if(t.dimension!==e.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(t.shape[e.dimension]!==e.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var r=0;r<e.dimension;++r)if(t.shape[r]!==e.shape[r])throw new Error("ndarray-gradient: shape mismatch");if(0===e.size)return t;if(e.dimension<=0)return t.set(0),t;return function(t){var e=t.join();if(m=n[e])return m;var i=t.length,o=["function gradient(dst,src){var s=src.shape.slice();"];function r(e){for(var r=i-e.length,s=[],n=[],a=[],h=0;h<i;++h)e.indexOf(h+1)>=0?a.push("0"):e.indexOf(-(h+1))>=0?a.push("s["+h+"]-1"):(a.push("-1"),s.push("1"),n.push("s["+h+"]-2"));var l=".lo("+s.join()+").hi("+n.join()+")";if(0===s.length&&(l=""),r>0){o.push("if(1");for(h=0;h<i;++h)e.indexOf(h+1)>=0||e.indexOf(-(h+1))>=0||o.push("&&s[",h,"]>2");o.push("){grad",r,"(src.pick(",a.join(),")",l);for(h=0;h<i;++h)e.indexOf(h+1)>=0||e.indexOf(-(h+1))>=0||o.push(",dst.pick(",a.join(),",",h,")",l);o.push(");")}for(h=0;h<e.length;++h){var c=Math.abs(e[h])-1,u="dst.pick("+a.join()+","+c+")"+l;switch(t[c]){case"clamp":var f=a.slice(),d=a.slice();e[h]<0?f[c]="s["+c+"]-2":d[c]="1",0===r?o.push("if(s[",c,"]>1){dst.set(",a.join(),",",c,",0.5*(src.get(",f.join(),")-src.get(",d.join(),")))}else{dst.set(",a.join(),",",c,",0)};"):o.push("if(s[",c,"]>1){diff(",u,",src.pick(",f.join(),")",l,",src.pick(",d.join(),")",l,");}else{zero(",u,");};");break;case"mirror":0===r?o.push("dst.set(",a.join(),",",c,",0);"):o.push("zero(",u,");");break;case"wrap":var p=a.slice(),v=a.slice();e[h]<0?(p[c]="s["+c+"]-2",v[c]="0"):(p[c]="s["+c+"]-1",v[c]="1"),0===r?o.push("if(s[",c,"]>2){dst.set(",a.join(),",",c,",0.5*(src.get(",p.join(),")-src.get(",v.join(),")))}else{dst.set(",a.join(),",",c,",0)};"):o.push("if(s[",c,"]>2){diff(",u,",src.pick(",p.join(),")",l,",src.pick(",v.join(),")",l,");}else{zero(",u,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}r>0&&o.push("};")}for(var a=0;a<1<<i;++a){for(var u=[],f=0;f<i;++f)a&1<<f&&u.push(f+1);for(var d=0;d<1<<u.length;++d){var p=u.slice();for(f=0;f<u.length;++f)d&1<<f&&(p[f]=-p[f]);r(p)}}o.push("return dst;};return gradient");var v=["diff","zero"],g=[h,l];for(a=1;a<=i;++a)v.push("grad"+a),g.push(c(a));v.push(o.join(""));var m=Function.apply(void 0,v).apply(void 0,g);return s[e]=m,m}(i)(t,e)};var o=i(783),r=i(752),s={},n={},a={body:"",args:[],thisVars:[],localVars:[]},h=r({args:["array","array","array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),l=r({args:["array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function c(t){if(t in s)return s[t];for(var e=[],i=0;i<t;++i)e.push("out",i,"s=0.5*(inp",i,"l-inp",i,"r);");var n=["array"],h=["junk"];for(i=0;i<t;++i){n.push("array"),h.push("out"+i+"s");var l=o(t);l[i]=-1,n.push({array:0,offset:l.slice()}),l[i]=1,n.push({array:0,offset:l.slice()}),h.push("inp"+i+"l","inp"+i+"r")}return s[t]=r({args:n,pre:a,post:a,body:{body:e.join(""),args:h.map((function(t){return{name:t,lvalue:0===t.indexOf("out"),rvalue:0===t.indexOf("inp"),count:"junk"!==t|0}})),thisVars:[],localVars:[]},funcName:"fdTemplate"+t})}},1584:function(t,e,i){var o=i(658),r=i(653),s=r("../shaders/vertex.glsl"),n=r("../shaders/fragment.glsl"),a=r("../shaders/contour-vertex.glsl"),h=r("../shaders/pick.glsl");e.createShader=function(t){var e=o(t,s,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return e.attributes.uv.location=0,e.attributes.f.location=1,e.attributes.normal.location=2,e},e.createPickShader=function(t){var e=o(t,s,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return e.attributes.uv.location=0,e.attributes.f.location=1,e.attributes.normal.location=2,e},e.createContourShader=function(t){var e=o(t,a,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return e.attributes.uv.location=0,e.attributes.f.location=1,e},e.createPickContourShader=function(t){var e=o(t,a,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return e.attributes.uv.location=0,e.attributes.f.location=1,e}},1585:function(t,e,i){"use strict";function o(t,e){var i=Math.floor(e),o=e-i,r=0<=i&&i<t.shape[0],s=0<=i+1&&i+1<t.shape[0];return(1-o)*(r?+t.get(i):0)+o*(s?+t.get(i+1):0)}function r(t,e,i){var o=Math.floor(e),r=e-o,s=0<=o&&o<t.shape[0],n=0<=o+1&&o+1<t.shape[0],a=Math.floor(i),h=i-a,l=0<=a&&a<t.shape[1],c=0<=a+1&&a+1<t.shape[1],u=s&&l?t.get(o,a):0,f=s&&c?t.get(o,a+1):0;return(1-h)*((1-r)*u+r*(n&&l?t.get(o+1,a):0))+h*((1-r)*f+r*(n&&c?t.get(o+1,a+1):0))}function s(t,e,i,o){var r=Math.floor(e),s=e-r,n=0<=r&&r<t.shape[0],a=0<=r+1&&r+1<t.shape[0],h=Math.floor(i),l=i-h,c=0<=h&&h<t.shape[1],u=0<=h+1&&h+1<t.shape[1],f=Math.floor(o),d=o-f,p=0<=f&&f<t.shape[2],v=0<=f+1&&f+1<t.shape[2],g=n&&c&&p?t.get(r,h,f):0,m=n&&u&&p?t.get(r,h+1,f):0,y=a&&c&&p?t.get(r+1,h,f):0,_=a&&u&&p?t.get(r+1,h+1,f):0,b=n&&c&&v?t.get(r,h,f+1):0,x=n&&u&&v?t.get(r,h+1,f+1):0;return(1-d)*((1-l)*((1-s)*g+s*y)+l*((1-s)*m+s*_))+d*((1-l)*((1-s)*b+s*(a&&c&&v?t.get(r+1,h,f+1):0))+l*((1-s)*x+s*(a&&u&&v?t.get(r+1,h+1,f+1):0)))}function n(t){var e,i,o=0|t.shape.length,r=new Array(o),s=new Array(o),n=new Array(o),a=new Array(o);for(e=0;e<o;++e)i=+arguments[e+1],r[e]=Math.floor(i),s[e]=i-r[e],n[e]=0<=r[e]&&r[e]<t.shape[e],a[e]=0<=r[e]+1&&r[e]+1<t.shape[e];var h,l,c,u=0;t:for(e=0;e<1<<o;++e){for(l=1,c=t.offset,h=0;h<o;++h)if(e&1<<h){if(!a[h])continue t;l*=s[h],c+=t.stride[h]*(r[h]+1)}else{if(!n[h])continue t;l*=1-s[h],c+=t.stride[h]*r[h]}u+=l*t.data[c]}return u}t.exports=function(t,e,i,a){switch(t.shape.length){case 0:return 0;case 1:return o(t,e);case 2:return r(t,e,i);case 3:return s(t,e,i,a);default:return n.apply(void 0,arguments)}},t.exports.d1=o,t.exports.d2=r,t.exports.d3=s},280:function(t,e,i){"use strict";t.exports=i(1577)},765:function(t,e,i){"use strict";var o=i(3),r=[[-1,0],[1,0],[0,-1],[0,1]];function s(t){return.5-.25*Math.min(1,.5*t)}function n(t,e,i){var o,s,n,a,h,l,c,u,f,d,p,v,g,m=0;for(a=0;a<e.length;a++){for(s=(o=e[a])[0],n=o[1],p=t[s][n],d=0,f=0,h=0;h<4;h++)(c=t[s+(l=r[h])[0]])&&void 0!==(u=c[n+l[1]])&&(0===d?v=g=u:(v=Math.min(v,u),g=Math.max(g,u)),f++,d+=u);if(0===f)throw"iterateInterp2d order is wrong: no defined neighbors";t[s][n]=d/f,void 0===p?f<4&&(m=1):(t[s][n]=(1+i)*t[s][n]-i*p,g>v&&(m=Math.max(m,Math.abs(t[s][n]-p)/(g-v))))}return m}t.exports=function(t,e){var i,r=1;for(n(t,e),i=0;i<e.length&&!(e[i][2]<4);i++);for(e=e.slice(i),i=0;i<100&&r>.01;i++)r=n(t,e,s(r));return r>.01&&o.log("interp2d didn't converge quickly",r),t}},766:function(t,e,i){"use strict";var o=i(3).maxRowLength;t.exports=function(t){var e,i,r,s,n,a,h,l,c=[],u={},f=[],d=t[0],p=[],v=[0,0,0],g=o(t);for(i=0;i<t.length;i++)for(e=p,p=d,d=t[i+1]||[],r=0;r<g;r++)void 0===p[r]&&((a=(void 0!==p[r-1]?1:0)+(void 0!==p[r+1]?1:0)+(void 0!==e[r]?1:0)+(void 0!==d[r]?1:0))?(0===i&&a++,0===r&&a++,i===t.length-1&&a++,r===p.length-1&&a++,a<4&&(u[[i,r]]=[i,r,a]),c.push([i,r,a])):f.push([i,r]));for(;f.length;){for(h={},l=!1,n=f.length-1;n>=0;n--)(a=((u[[(i=(s=f[n])[0])-1,r=s[1]]]||v)[2]+(u[[i+1,r]]||v)[2]+(u[[i,r-1]]||v)[2]+(u[[i,r+1]]||v)[2])/20)&&(h[s]=[i,r,a],f.splice(n,1),l=!0);if(!l)throw"findEmpties iterated with no new neighbors";for(s in h)u[s]=h[s],c.push(h[s])}return c.sort((function(t,e){return e[2]-t[2]}))}},824:function(t,e,i){"use strict";var o=i(52),r=i(112),s=i(154).hovertemplateAttrs,n=i(59),a=i(32).extendFlat,h=i(111).overrideAll;function l(t){return{valType:"boolean",role:"info",dflt:!1,description:["Determines whether or not these contour lines are projected","on the",t,"plane.","If `highlight` is set to *true* (the default), the projected","lines are shown on hover.","If `show` is set to *true*, the projected lines are shown","in permanence."].join(" ")}}function c(t){return{show:{valType:"boolean",role:"info",dflt:!1,description:["Determines whether or not contour lines about the",t,"dimension are drawn."].join(" ")},start:{valType:"number",dflt:null,role:"style",editType:"plot",description:["Sets the starting contour level value.","Must be less than `contours.end`"].join(" ")},end:{valType:"number",dflt:null,role:"style",editType:"plot",description:["Sets the end contour level value.","Must be more than `contours.start`"].join(" ")},size:{valType:"number",dflt:null,min:0,role:"style",editType:"plot",description:["Sets the step between each contour level.","Must be positive."].join(" ")},project:{x:l("x"),y:l("y"),z:l("z")},color:{valType:"color",role:"style",dflt:o.defaultLine,description:"Sets the color of the contour lines."},usecolormap:{valType:"boolean",role:"info",dflt:!1,description:["An alternate to *color*.","Determines whether or not the contour lines are colored using","the trace *colorscale*."].join(" ")},width:{valType:"number",role:"style",min:1,max:16,dflt:2,description:"Sets the width of the contour lines."},highlight:{valType:"boolean",role:"info",dflt:!0,description:["Determines whether or not contour lines about the",t,"dimension are highlighted on hover."].join(" ")},highlightcolor:{valType:"color",role:"style",dflt:o.defaultLine,description:"Sets the color of the highlighted contour lines."},highlightwidth:{valType:"number",role:"style",min:1,max:16,dflt:2,description:"Sets the width of the highlighted contour lines."}}}var u=t.exports=h(a({z:{valType:"data_array",description:"Sets the z coordinates."},x:{valType:"data_array",description:"Sets the x coordinates."},y:{valType:"data_array",description:"Sets the y coordinates."},text:{valType:"string",role:"info",dflt:"",arrayOk:!0,description:["Sets the text elements associated with each z value.","If trace `hoverinfo` contains a *text* flag and *hovertext* is not set,","these elements will be seen in the hover labels."].join(" ")},hovertext:{valType:"string",role:"info",dflt:"",arrayOk:!0,description:"Same as `text`."},hovertemplate:s(),connectgaps:{valType:"boolean",dflt:!1,role:"info",editType:"calc",description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data are filled in."].join(" ")},surfacecolor:{valType:"data_array",description:["Sets the surface color values,","used for setting a color scale independent of `z`."].join(" ")}},r("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:c("x"),y:c("y"),z:c("z")},hidesurface:{valType:"boolean",role:"info",dflt:!1,description:["Determines whether or not a surface is drawn.","For example, set `hidesurface` to *false*","`contours.x.show` to *true* and","`contours.y.show` to *true* to draw a wire frame plot."].join(" ")},lightposition:{x:{valType:"number",role:"style",min:-1e5,max:1e5,dflt:10,description:"Numeric vector, representing the X coordinate for each vertex."},y:{valType:"number",role:"style",min:-1e5,max:1e5,dflt:1e4,description:"Numeric vector, representing the Y coordinate for each vertex."},z:{valType:"number",role:"style",min:-1e5,max:1e5,dflt:0,description:"Numeric vector, representing the Z coordinate for each vertex."}},lighting:{ambient:{valType:"number",role:"style",min:0,max:1,dflt:.8,description:"Ambient light increases overall color visibility but can wash out the image."},diffuse:{valType:"number",role:"style",min:0,max:1,dflt:.8,description:"Represents the extent that incident rays are reflected in a range of angles."},specular:{valType:"number",role:"style",min:0,max:2,dflt:.05,description:"Represents the level that incident rays are reflected in a single direction, causing shine."},roughness:{valType:"number",role:"style",min:0,max:1,dflt:.5,description:"Alters specular reflection; the rougher the surface, the wider and less contrasty the shine."},fresnel:{valType:"number",role:"style",min:0,max:5,dflt:.2,description:["Represents the reflectance as a dependency of the viewing angle; e.g. paper is reflective","when viewing it from the edge of the paper (almost 90 degrees), causing shine."].join(" ")}},opacity:{valType:"number",role:"style",min:0,max:1,dflt:1,description:["Sets the opacity of the surface.","Please note that in the case of using high `opacity` values for example a value","greater than or equal to 0.5 on two surfaces (and 0.25 with four surfaces), an","overlay of multiple transparent surfaces may not perfectly be sorted in depth by the","webgl API. This behavior may be improved in the near future and is subject to change."].join(" ")},opacityscale:{valType:"any",role:"style",editType:"calc",description:["Sets the opacityscale."," The opacityscale must be an array containing"," arrays mapping a normalized value to an opacity value."," At minimum, a mapping for the lowest (0) and highest (1)"," values are required. For example,"," `[[0, 1], [0.5, 0.2], [1, 1]]` means that higher/lower values would have"," higher opacity values and those in the middle would be more transparent"," Alternatively, `opacityscale` may be a palette name string"," of the following list: 'min', 'max', 'extremes' and 'uniform'."," The default is 'uniform'."].join("")},_deprecated:{zauto:a({},r.zauto,{description:"Obsolete. Use `cauto` instead."}),zmin:a({},r.zmin,{description:"Obsolete. Use `cmin` instead."}),zmax:a({},r.zmax,{description:"Obsolete. Use `cmax` instead."})},hoverinfo:a({},n.hoverinfo),showlegend:a({},n.showlegend,{dflt:!1})}),"calc","nested");u.x.editType=u.y.editType=u.z.editType="calc+clearAxisTypes",u.transforms=void 0}}]);