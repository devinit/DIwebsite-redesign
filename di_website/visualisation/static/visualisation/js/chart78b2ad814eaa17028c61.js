(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1021:function(t,r,e){"use strict";t.exports=function(t,r){var e=t.length;if(0===e)throw new Error("Must have at least d+1 points");var n=t[0].length;if(e<=n)throw new Error("Must input at least d+1 points");var o=t.slice(0,n+1),a=i.apply(void 0,o);if(0===a)throw new Error("Input not in general position");for(var h=new Array(n+1),p=0;p<=n;++p)h[p]=p;a<0&&(h[0]=1,h[1]=0);var l=new s(h,new Array(n+1),!1),f=l.adjacent,c=new Array(n+2);for(p=0;p<=n;++p){for(var v=h.slice(),d=0;d<=n;++d)d===p&&(v[d]=-1);var g=v[0];v[0]=v[1],v[1]=g;var m=new s(v,new Array(n+1),!0);f[p]=m,c[p]=m}c[n+1]=l;for(p=0;p<=n;++p){v=f[p].vertices;var y=f[p].adjacent;for(d=0;d<=n;++d){var x=v[d];if(x<0)y[d]=l;else for(var b=0;b<=n;++b)f[b].vertices.indexOf(x)<0&&(y[d]=f[b])}}var A=new u(n,o,c),w=!!r;for(p=n+1;p<e;++p)A.insert(t[p],w);return A.boundary()};var i=e(417),n=e(1416).compareCells;function s(t,r,e){this.vertices=t,this.adjacent=r,this.boundary=e,this.lastVisited=-1}function o(t,r,e){this.vertices=t,this.cell=r,this.index=e}function a(t,r){return n(t.vertices,r.vertices)}s.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var r=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=r};var h=[];function u(t,r,e){this.dimension=t,this.vertices=r,this.simplices=e,this.interior=e.filter((function(t){return!t.boundary})),this.tuple=new Array(t+1);for(var n=0;n<=t;++n)this.tuple[n]=this.vertices[n];var s=h[t];s||(s=h[t]=function(t){for(var r=["function orient(){var tuple=this.tuple;return test("],e=0;e<=t;++e)e>0&&r.push(","),r.push("tuple[",e,"]");r.push(")}return orient");var n=new Function("test",r.join("")),s=i[t+1];return s||(s=i),n(s)}(t)),this.orient=s}var p=u.prototype;p.handleBoundaryDegeneracy=function(t,r){var e=this.dimension,i=this.vertices.length-1,n=this.tuple,s=this.vertices,o=[t];for(t.lastVisited=-i;o.length>0;){(t=o.pop()).vertices;for(var a=t.adjacent,h=0;h<=e;++h){var u=a[h];if(u.boundary&&!(u.lastVisited<=-i)){for(var p=u.vertices,l=0;l<=e;++l){var f=p[l];n[l]=f<0?r:s[f]}var c=this.orient();if(c>0)return u;u.lastVisited=-i,0===c&&o.push(u)}}}return null},p.walk=function(t,r){var e=this.vertices.length-1,i=this.dimension,n=this.vertices,s=this.tuple,o=r?this.interior.length*Math.random()|0:this.interior.length-1,a=this.interior[o];t:for(;!a.boundary;){for(var h=a.vertices,u=a.adjacent,p=0;p<=i;++p)s[p]=n[h[p]];a.lastVisited=e;for(p=0;p<=i;++p){var l=u[p];if(!(l.lastVisited>=e)){var f=s[p];s[p]=t;var c=this.orient();if(s[p]=f,c<0){a=l;continue t}l.boundary?l.lastVisited=-e:l.lastVisited=e}}return}return a},p.addPeaks=function(t,r){var e=this.vertices.length-1,i=this.dimension,n=this.vertices,h=this.tuple,u=this.interior,p=this.simplices,l=[r];r.lastVisited=e,r.vertices[r.vertices.indexOf(-1)]=e,r.boundary=!1,u.push(r);for(var f=[];l.length>0;){var c=(r=l.pop()).vertices,v=r.adjacent,d=c.indexOf(e);if(!(d<0))for(var g=0;g<=i;++g)if(g!==d){var m=v[g];if(m.boundary&&!(m.lastVisited>=e)){var y=m.vertices;if(m.lastVisited!==-e){for(var x=0,b=0;b<=i;++b)y[b]<0?(x=b,h[b]=t):h[b]=n[y[b]];if(this.orient()>0){y[x]=e,m.boundary=!1,u.push(m),l.push(m),m.lastVisited=e;continue}m.lastVisited=-e}var A=m.adjacent,w=c.slice(),j=v.slice(),_=new s(w,j,!0);p.push(_);var k=A.indexOf(r);if(!(k<0)){A[k]=_,j[d]=m,w[g]=-1,j[g]=r,v[g]=_,_.flip();for(b=0;b<=i;++b){var S=w[b];if(!(S<0||S===e)){for(var C=new Array(i-1),I=0,V=0;V<=i;++V){var E=w[V];E<0||V===b||(C[I++]=E)}f.push(new o(C,_,b))}}}}}}f.sort(a);for(g=0;g+1<f.length;g+=2){var M=f[g],O=f[g+1],F=M.index,N=O.index;F<0||N<0||(M.cell.adjacent[M.index]=O.cell,O.cell.adjacent[O.index]=M.cell)}},p.insert=function(t,r){var e=this.vertices;e.push(t);var i=this.walk(t,r);if(i){for(var n=this.dimension,s=this.tuple,o=0;o<=n;++o){var a=i.vertices[o];s[o]=a<0?t:e[a]}var h=this.orient(s);h<0||(0!==h||(i=this.handleBoundaryDegeneracy(i,t)))&&this.addPeaks(t,i)}},p.boundary=function(){for(var t=this.dimension,r=[],e=this.simplices,i=e.length,n=0;n<i;++n){var s=e[n];if(s.boundary){for(var o=new Array(t),a=s.vertices,h=0,u=0,p=0;p<=t;++p)a[p]>=0?o[h++]=a[p]:u=1&p;if(u===(1&t)){var l=o[0];o[0]=o[1],o[1]=l}r.push(o)}}return r}},1093:function(t,r,e){"use strict";var i=e(1412),n=e(1413),s=e(1415);t.exports=function(t){var r=t.length;if(0===r)return[];if(1===r)return[[0]];var e=t[0].length;if(0===e)return[];if(1===e)return i(t);if(2===e)return n(t);return s(t,e)}},1094:function(t,r,e){"use strict";var i=e(1421);function n(t){for(var r="robustLinearSolve"+t+"d",e=["function ",r,"(A,b){return ["],n=0;n<t;++n){e.push("det([");for(var s=0;s<t;++s){s>0&&e.push(","),e.push("[");for(var o=0;o<t;++o)o>0&&e.push(","),o===n?e.push("+b[",s,"]"):e.push("+A[",s,"][",o,"]");e.push("]")}e.push("]),")}e.push("det(A)]}return ",r);var a=new Function("det",e.join(""));return a(t<6?i[t]:i)}var s=[function(){return[0]},function(t,r){return[[r[0]],[t[0][0]]]}];!function(){for(;s.length<6;)s.push(n(s.length));for(var r=[],e=["function dispatchLinearSolve(A,b){switch(A.length){"],i=0;i<6;++i)r.push("s"+i),e.push("case ",i,":return s",i,"(A,b);");e.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),r.push("CACHE","g",e.join(""));var o=Function.apply(void 0,r);for(t.exports=o.apply(void 0,s.concat([s,n])),i=0;i<6;++i)t.exports[i]=s[i]}()},1406:function(t,r){r.vertexNormals=function(t,r,e){for(var i=r.length,n=new Array(i),s=void 0===e?1e-6:e,o=0;o<i;++o)n[o]=[0,0,0];for(o=0;o<t.length;++o)for(var a=t[o],h=0,u=a[a.length-1],p=a[0],l=0;l<a.length;++l){h=u,u=p,p=a[(l+1)%a.length];for(var f=r[h],c=r[u],v=r[p],d=new Array(3),g=0,m=new Array(3),y=0,x=0;x<3;++x)d[x]=f[x]-c[x],g+=d[x]*d[x],m[x]=v[x]-c[x],y+=m[x]*m[x];if(g*y>s){var b=n[u],A=1/Math.sqrt(g*y);for(x=0;x<3;++x){var w=(x+1)%3,j=(x+2)%3;b[x]+=A*(m[w]*d[j]-m[j]*d[w])}}}for(o=0;o<i;++o){b=n[o];var _=0;for(x=0;x<3;++x)_+=b[x]*b[x];if(_>s)for(A=1/Math.sqrt(_),x=0;x<3;++x)b[x]*=A;else for(x=0;x<3;++x)b[x]=0}return n},r.faceNormals=function(t,r,e){for(var i=t.length,n=new Array(i),s=void 0===e?1e-6:e,o=0;o<i;++o){for(var a=t[o],h=new Array(3),u=0;u<3;++u)h[u]=r[a[u]];var p=new Array(3),l=new Array(3);for(u=0;u<3;++u)p[u]=h[1][u]-h[0][u],l[u]=h[2][u]-h[0][u];var f=new Array(3),c=0;for(u=0;u<3;++u){var v=(u+1)%3,d=(u+2)%3;f[u]=p[v]*l[d]-p[d]*l[v],c+=f[u]*f[u]}c=c>s?1/Math.sqrt(c):0;for(u=0;u<3;++u)f[u]*=c;n[o]=f}return n}},1407:function(t,r,e){"use strict";t.exports=function(t,r,e,a){e=e||0,void 0===a&&(a=function(t){for(var r=t.length,e=0,i=0;i<r;++i)e=0|Math.max(e,t[i].length);return e-1}(t));if(0===t.length||a<1)return{cells:[],vertexIds:[],vertexWeights:[]};var h=function(t,r){for(var e=t.length,i=n.mallocUint8(e),s=0;s<e;++s)i[s]=t[s]<r|0;return i}(r,+e),u=function(t,r){for(var e=t.length,o=r*(r+1)/2*e|0,a=n.mallocUint32(2*o),h=0,u=0;u<e;++u)for(var p=t[u],l=(r=p.length,0);l<r;++l)for(var f=0;f<l;++f){var c=p[f],v=p[l];a[h++]=0|Math.min(c,v),a[h++]=0|Math.max(c,v)}s(i(a,[h/2|0,2]));var d=2;for(u=2;u<h;u+=2)a[u-2]===a[u]&&a[u-1]===a[u+1]||(a[d++]=a[u],a[d++]=a[u+1]);return i(a,[d/2|0,2])}(t,a),p=function(t,r,e,s){for(var o=t.data,a=t.shape[0],h=n.mallocDouble(a),u=0,p=0;p<a;++p){var l=o[2*p],f=o[2*p+1];if(e[l]!==e[f]){var c=r[l],v=r[f];o[2*u]=l,o[2*u+1]=f,h[u++]=(v-s)/(v-c)}}return t.shape[0]=u,i(h,[u])}(u,r,h,+e),l=function(t,r){var e=n.mallocInt32(2*r),i=t.shape[0],s=t.data;e[0]=0;for(var o=0,a=0;a<i;++a){var h=s[2*a];if(h!==o){for(e[2*o+1]=a;++o<h;)e[2*o]=a,e[2*o+1]=a;e[2*o]=a}}e[2*o+1]=i;for(;++o<r;)e[2*o]=e[2*o+1]=i;return e}(u,0|r.length),f=o(a)(t,u.data,l,h),c=function(t){for(var r=0|t.shape[0],e=t.data,i=new Array(r),n=0;n<r;++n)i[n]=[e[2*n],e[2*n+1]];return i}(u),v=[].slice.call(p.data,0,p.shape[0]);return n.free(h),n.free(u.data),n.free(p.data),n.free(l),{cells:f,vertexIds:c,vertexWeights:v}};var i=e(431),n=e(402),s=e(1408),o=e(1410)},1408:function(t,r,e){"use strict";var i=e(1409),n={};t.exports=function(t){var r=t.order,e=t.dtype,s=[r,e].join(":"),o=n[s];return o||(n[s]=o=i(r,e)),o(t),t}},1409:function(t,r,e){"use strict";var i=e(402),n=32;function s(t){switch(t){case"uint8":return[i.mallocUint8,i.freeUint8];case"uint16":return[i.mallocUint16,i.freeUint16];case"uint32":return[i.mallocUint32,i.freeUint32];case"int8":return[i.mallocInt8,i.freeInt8];case"int16":return[i.mallocInt16,i.freeInt16];case"int32":return[i.mallocInt32,i.freeInt32];case"float32":return[i.mallocFloat,i.freeFloat];case"float64":return[i.mallocDouble,i.freeDouble];default:return null}}function o(t){for(var r=[],e=0;e<t;++e)r.push("s"+e);for(e=0;e<t;++e)r.push("n"+e);for(e=1;e<t;++e)r.push("d"+e);for(e=1;e<t;++e)r.push("e"+e);for(e=1;e<t;++e)r.push("f"+e);return r}t.exports=function(t,r){var e=["'use strict'"],i=["ndarraySortWrapper",t.join("d"),r].join("");e.push(["function ",i,"(",["array"].join(","),"){"].join(""));for(var a=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],h=0;h<t.length;++h)a.push(["s",h,"=stride[",h,"]|0,n",h,"=shape[",h,"]|0"].join(""));var u=new Array(t.length),p=[];for(h=0;h<t.length;++h){0!==(c=t[h])&&(0===p.length?u[c]="1":u[c]=p.join("*"),p.push("n"+c))}var l=-1,f=-1;for(h=0;h<t.length;++h){var c,v=t[h];0!==v&&(l>0?a.push(["d",v,"=s",v,"-d",l,"*n",l].join("")):a.push(["d",v,"=s",v].join("")),l=v),0!==(c=t.length-1-h)&&(f>0?a.push(["e",c,"=s",c,"-e",f,"*n",f,",f",c,"=",u[c],"-f",f,"*n",f].join("")):a.push(["e",c,"=s",c,",f",c,"=",u[c]].join("")),f=c)}e.push("var "+a.join(","));var d=["0","n0-1","data","offset"].concat(o(t.length));e.push(["if(n0<=",n,"){","insertionSort(",d.join(","),")}else{","quickSort(",d.join(","),")}"].join("")),e.push("}return "+i);var g=new Function("insertionSort","quickSort",e.join("\n")),m=function(t,r){var e=["'use strict'"],i=["ndarrayInsertionSort",t.join("d"),r].join(""),n=["left","right","data","offset"].concat(o(t.length)),a=s(r),h=["i,j,cptr,ptr=left*s0+offset"];if(t.length>1){for(var u=[],p=1;p<t.length;++p)h.push("i"+p),u.push("n"+p);a?h.push("scratch=malloc("+u.join("*")+")"):h.push("scratch=new Array("+u.join("*")+")"),h.push("dptr","sptr","a","b")}else h.push("scratch");function l(t){return"generic"===r?["data.get(",t,")"].join(""):["data[",t,"]"].join("")}function f(t,e){return"generic"===r?["data.set(",t,",",e,")"].join(""):["data[",t,"]=",e].join("")}if(e.push(["function ",i,"(",n.join(","),"){var ",h.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),t.length>1){e.push("dptr=0;sptr=ptr");for(p=t.length-1;p>=0;--p){0!==(c=t[p])&&e.push(["for(i",c,"=0;i",c,"<n",c,";++i",c,"){"].join(""))}e.push("scratch[dptr++]=",l("sptr"));for(p=0;p<t.length;++p){0!==(c=t[p])&&e.push("sptr+=d"+c,"}")}e.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0");for(p=1;p<t.length;++p)1===p&&e.push("__l:"),e.push(["for(i",p,"=0;i",p,"<n",p,";++i",p,"){"].join(""));e.push(["a=",l("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(p=t.length-1;p>=1;--p)e.push("sptr+=e"+p,"dptr+=f"+p,"}");e.push("dptr=cptr;sptr=cptr-s0");for(p=t.length-1;p>=0;--p){0!==(c=t[p])&&e.push(["for(i",c,"=0;i",c,"<n",c,";++i",c,"){"].join(""))}e.push(f("dptr",l("sptr")));for(p=0;p<t.length;++p){0!==(c=t[p])&&e.push(["dptr+=d",c,";sptr+=d",c].join(""),"}")}e.push("cptr-=s0\n}"),e.push("dptr=cptr;sptr=0");for(p=t.length-1;p>=0;--p){0!==(c=t[p])&&e.push(["for(i",c,"=0;i",c,"<n",c,";++i",c,"){"].join(""))}e.push(f("dptr","scratch[sptr++]"));for(p=0;p<t.length;++p){var c;0!==(c=t[p])&&e.push("dptr+=d"+c,"}")}}else e.push("scratch="+l("ptr"),"while((j--\x3eleft)&&("+l("cptr-s0")+">scratch)){",f("cptr",l("cptr-s0")),"cptr-=s0","}",f("cptr","scratch"));return e.push("}"),t.length>1&&a&&e.push("free(scratch)"),e.push("} return "+i),a?new Function("malloc","free",e.join("\n"))(a[0],a[1]):new Function(e.join("\n"))()}(t,r),y=function(t,r,e){var i=["'use strict'"],a=["ndarrayQuickSort",t.join("d"),r].join(""),h=["left","right","data","offset"].concat(o(t.length)),u=s(r),p=0;i.push(["function ",a,"(",h.join(","),"){"].join(""));var l=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(t.length>1){for(var f=[],c=1;c<t.length;++c)f.push("n"+c),l.push("i"+c);for(c=0;c<8;++c)l.push("b_ptr"+c);l.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+f.join("*")),u?l.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):l.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else l.push("pivot1","pivot2");function v(t){return["(offset+",t,"*s0)"].join("")}function d(t){return"generic"===r?["data.get(",t,")"].join(""):["data[",t,"]"].join("")}function g(t,e){return"generic"===r?["data.set(",t,",",e,")"].join(""):["data[",t,"]=",e].join("")}function m(r,e,n){if(1===r.length)i.push("ptr0="+v(r[0]));else for(var s=0;s<r.length;++s)i.push(["b_ptr",s,"=s0*",r[s]].join(""));e&&i.push("pivot_ptr=0"),i.push("ptr_shift=offset");for(s=t.length-1;s>=0;--s){0!==(o=t[s])&&i.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(r.length>1)for(s=0;s<r.length;++s)i.push(["ptr",s,"=b_ptr",s,"+ptr_shift"].join(""));i.push(n),e&&i.push("++pivot_ptr");for(s=0;s<t.length;++s){var o;0!==(o=t[s])&&(r.length>1?i.push("ptr_shift+=d"+o):i.push("ptr0+=d"+o),i.push("}"))}}function y(r,e,n,s){if(1===e.length)i.push("ptr0="+v(e[0]));else{for(var o=0;o<e.length;++o)i.push(["b_ptr",o,"=s0*",e[o]].join(""));i.push("ptr_shift=offset")}n&&i.push("pivot_ptr=0"),r&&i.push(r+":");for(o=1;o<t.length;++o)i.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""));if(e.length>1)for(o=0;o<e.length;++o)i.push(["ptr",o,"=b_ptr",o,"+ptr_shift"].join(""));i.push(s);for(o=t.length-1;o>=1;--o)n&&i.push("pivot_ptr+=f"+o),e.length>1?i.push("ptr_shift+=e"+o):i.push("ptr0+=e"+o),i.push("}")}function x(){t.length>1&&u&&i.push("free(pivot1)","free(pivot2)")}function b(r,e){var n="el"+r,s="el"+e;if(t.length>1){var o="__l"+ ++p;y(o,[n,s],!1,["comp=",d("ptr0"),"-",d("ptr1"),"\n","if(comp>0){tmp0=",n,";",n,"=",s,";",s,"=tmp0;break ",o,"}\n","if(comp<0){break ",o,"}"].join(""))}else i.push(["if(",d(v(n)),">",d(v(s)),"){tmp0=",n,";",n,"=",s,";",s,"=tmp0}"].join(""))}function A(r,e){t.length>1?m([r,e],!1,g("ptr0",d("ptr1"))):i.push(g(v(r),d(v(e))))}function w(r,e,n){if(t.length>1){var s="__l"+ ++p;y(s,[e],!0,[r,"=",d("ptr0"),"-pivot",n,"[pivot_ptr]\n","if(",r,"!==0){break ",s,"}"].join(""))}else i.push([r,"=",d(v(e)),"-pivot",n].join(""))}function j(r,e){t.length>1?m([r,e],!1,["tmp=",d("ptr0"),"\n",g("ptr0",d("ptr1")),"\n",g("ptr1","tmp")].join("")):i.push(["ptr0=",v(r),"\n","ptr1=",v(e),"\n","tmp=",d("ptr0"),"\n",g("ptr0",d("ptr1")),"\n",g("ptr1","tmp")].join(""))}function _(r,e,n){t.length>1?(m([r,e,n],!1,["tmp=",d("ptr0"),"\n",g("ptr0",d("ptr1")),"\n",g("ptr1",d("ptr2")),"\n",g("ptr2","tmp")].join("")),i.push("++"+e,"--"+n)):i.push(["ptr0=",v(r),"\n","ptr1=",v(e),"\n","ptr2=",v(n),"\n","++",e,"\n","--",n,"\n","tmp=",d("ptr0"),"\n",g("ptr0",d("ptr1")),"\n",g("ptr1",d("ptr2")),"\n",g("ptr2","tmp")].join(""))}function k(t,r){j(t,r),i.push("--"+r)}function S(r,e,n){t.length>1?m([r,e],!0,[g("ptr0",d("ptr1")),"\n",g("ptr1",["pivot",n,"[pivot_ptr]"].join(""))].join("")):i.push(g(v(r),d(v(e))),g(v(e),"pivot"+n))}function C(r,e){i.push(["if((",e,"-",r,")<=",n,"){\n","insertionSort(",r,",",e,",data,offset,",o(t.length).join(","),")\n","}else{\n",a,"(",r,",",e,",data,offset,",o(t.length).join(","),")\n","}"].join(""))}function I(r,e,n){t.length>1?(i.push(["__l",++p,":while(true){"].join("")),m([r],!0,["if(",d("ptr0"),"!==pivot",e,"[pivot_ptr]){break __l",p,"}"].join("")),i.push(n,"}")):i.push(["while(",d(v(r)),"===pivot",e,"){",n,"}"].join(""))}return i.push("var "+l.join(",")),b(1,2),b(4,5),b(1,3),b(2,3),b(1,4),b(3,4),b(2,5),b(2,3),b(4,5),t.length>1?m(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",d("ptr1"),"\n","pivot2[pivot_ptr]=",d("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",d("ptr0"),"\n","y=",d("ptr2"),"\n","z=",d("ptr4"),"\n",g("ptr5","x"),"\n",g("ptr6","y"),"\n",g("ptr7","z")].join("")):i.push(["pivot1=",d(v("el2")),"\n","pivot2=",d(v("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",d(v("el1")),"\n","y=",d(v("el3")),"\n","z=",d(v("el5")),"\n",g(v("index1"),"x"),"\n",g(v("index3"),"y"),"\n",g(v("index5"),"z")].join("")),A("index2","left"),A("index4","right"),i.push("if(pivots_are_equal){"),i.push("for(k=less;k<=great;++k){"),w("comp","k",1),i.push("if(comp===0){continue}"),i.push("if(comp<0){"),i.push("if(k!==less){"),j("k","less"),i.push("}"),i.push("++less"),i.push("}else{"),i.push("while(true){"),w("comp","great",1),i.push("if(comp>0){"),i.push("great--"),i.push("}else if(comp<0){"),_("k","less","great"),i.push("break"),i.push("}else{"),k("k","great"),i.push("break"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),i.push("}else{"),i.push("for(k=less;k<=great;++k){"),w("comp_pivot1","k",1),i.push("if(comp_pivot1<0){"),i.push("if(k!==less){"),j("k","less"),i.push("}"),i.push("++less"),i.push("}else{"),w("comp_pivot2","k",2),i.push("if(comp_pivot2>0){"),i.push("while(true){"),w("comp","great",2),i.push("if(comp>0){"),i.push("if(--great<k){break}"),i.push("continue"),i.push("}else{"),w("comp","great",1),i.push("if(comp<0){"),_("k","less","great"),i.push("}else{"),k("k","great"),i.push("}"),i.push("break"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),S("left","(less-1)",1),S("right","(great+1)",2),C("left","(less-2)"),C("(great+2)","right"),i.push("if(pivots_are_equal){"),x(),i.push("return"),i.push("}"),i.push("if(less<index1&&great>index5){"),I("less",1,"++less"),I("great",2,"--great"),i.push("for(k=less;k<=great;++k){"),w("comp_pivot1","k",1),i.push("if(comp_pivot1===0){"),i.push("if(k!==less){"),j("k","less"),i.push("}"),i.push("++less"),i.push("}else{"),w("comp_pivot2","k",2),i.push("if(comp_pivot2===0){"),i.push("while(true){"),w("comp","great",2),i.push("if(comp===0){"),i.push("if(--great<k){break}"),i.push("continue"),i.push("}else{"),w("comp","great",1),i.push("if(comp<0){"),_("k","less","great"),i.push("}else{"),k("k","great"),i.push("}"),i.push("break"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),i.push("}"),x(),C("less","great"),i.push("}return "+a),t.length>1&&u?new Function("insertionSort","malloc","free",i.join("\n"))(e,u[0],u[1]):new Function("insertionSort",i.join("\n"))(e)}(t,r,m);return g(m,y)}},1410:function(t,r,e){"use strict";t.exports=function(t){var r=s[t];r||(r=s[t]=function(t){var r=0,e=new Array(t+1);e[0]=[[]];for(var s=1;s<=t;++s)for(var o=e[s]=n(s),a=0;a<o.length;++a)r=Math.max(r,o[s].length);var h=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",t,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function u(t){if(!(t.length<=0)){h.push("R.push(");for(var r=0;r<t.length;++r){var e=t[r];r>0&&h.push(","),h.push("[");for(var i=0;i<e.length;++i){var n=e[i];i>0&&h.push(","),h.push("B(C,E,c[",n[0],"],c[",n[1],"])")}h.push("]")}h.push(");")}}for(s=t+1;s>1;--s){s<t+1&&h.push("else "),h.push("if(l===",s,"){");var p=[];for(a=0;a<s;++a)p.push("(S[c["+a+"]]<<"+a+")");h.push("var M=",p.join("+"),";if(M===0||M===",(1<<s)-1,"){continue}switch(M){");for(o=e[s-1],a=0;a<o.length;++a)h.push("case ",a,":"),u(o[a]),h.push("break;");h.push("}}")}return h.push("}return R;};return getContour",t,"d"),new Function("pool",h.join(""))(i)}(t));return r};var i=e(402),n=e(1411),s={}},1411:function(t,r,e){"use strict";t.exports=function(t){for(var r=1<<t+1,e=new Array(r),i=0;i<r;++i)e[i]=s(t,i);return e};var i=e(1093);function n(t,r,e){for(var i=new Array(t),n=0;n<t;++n)i[n]=0,n===r&&(i[n]+=.5),n===e&&(i[n]+=.5);return i}function s(t,r){if(0===r||r===(1<<t+1)-1)return[];for(var e=[],s=[],o=0;o<=t;++o)if(r&1<<o){e.push(n(t,o-1,o-1)),s.push(null);for(var a=0;a<=t;++a)~r&1<<a&&(e.push(n(t,o-1,a-1)),s.push([o,a]))}var h=i(e),u=[];t:for(o=0;o<h.length;++o){var p=h[o],l=[];for(a=0;a<p.length;++a){if(!s[p[a]])continue t;l.push(s[p[a]].slice())}u.push(l)}return u}},1412:function(t,r,e){"use strict";t.exports=function(t){for(var r=0,e=0,i=1;i<t.length;++i)t[i][0]<t[r][0]&&(r=i),t[i][0]>t[e][0]&&(e=i);return r<e?[[r],[e]]:r>e?[[e],[r]]:[[r]]}},1413:function(t,r,e){"use strict";t.exports=function(t){var r=i(t),e=r.length;if(e<=2)return[];for(var n=new Array(e),s=r[e-1],o=0;o<e;++o){var a=r[o];n[o]=[s,a],s=a}return n};var i=e(1414)},1414:function(t,r,e){"use strict";t.exports=function(t){var r=t.length;if(r<3){for(var e=new Array(r),n=0;n<r;++n)e[n]=n;return 2===r&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:e}var s=new Array(r);for(n=0;n<r;++n)s[n]=n;s.sort((function(r,e){var i=t[r][0]-t[e][0];return i||t[r][1]-t[e][1]}));var o=[s[0],s[1]],a=[s[0],s[1]];for(n=2;n<r;++n){for(var h=s[n],u=t[h],p=o.length;p>1&&i(t[o[p-2]],t[o[p-1]],u)<=0;)p-=1,o.pop();for(o.push(h),p=a.length;p>1&&i(t[a[p-2]],t[a[p-1]],u)>=0;)p-=1,a.pop();a.push(h)}e=new Array(a.length+o.length-2);for(var l=0,f=(n=0,o.length);n<f;++n)e[l++]=o[n];for(var c=a.length-2;c>0;--c)e[l++]=a[c];return e};var i=e(417)[3]},1415:function(t,r,e){"use strict";t.exports=function(t,r){try{return i(t,!0)}catch(o){var e=n(t);if(e.length<=r)return[];var s=function(t,r){for(var e=t.length,i=new Array(e),n=0;n<r.length;++n)i[n]=t[r[n]];var s=r.length;for(n=0;n<e;++n)r.indexOf(n)<0&&(i[s++]=t[n]);return i}(t,e);return function(t,r){for(var e=t.length,i=r.length,n=0;n<e;++n)for(var s=t[n],o=0;o<s.length;++o){var a=s[o];if(a<i)s[o]=r[a];else{a-=i;for(var h=0;h<i;++h)a>=r[h]&&(a+=1);s[o]=a}}return t}(i(s,!0),e)}};var i=e(1021),n=e(1417)},1416:function(t,r,e){"use strict";var i=e(428),n=e(704);function s(t,r){var e=t.length,i=t.length-r.length,n=Math.min;if(i)return i;switch(e){case 0:return 0;case 1:return t[0]-r[0];case 2:return(a=t[0]+t[1]-r[0]-r[1])||n(t[0],t[1])-n(r[0],r[1]);case 3:var s=t[0]+t[1],o=r[0]+r[1];if(a=s+t[2]-(o+r[2]))return a;var a,h=n(t[0],t[1]),u=n(r[0],r[1]);return(a=n(h,t[2])-n(u,r[2]))||n(h+t[2],s)-n(u+r[2],o);default:var p=t.slice(0);p.sort();var l=r.slice(0);l.sort();for(var f=0;f<e;++f)if(i=p[f]-l[f])return i;return 0}}function o(t,r){return s(t[0],r[0])}function a(t,r){if(r){for(var e=t.length,i=new Array(e),n=0;n<e;++n)i[n]=[t[n],r[n]];i.sort(o);for(n=0;n<e;++n)t[n]=i[n][0],r[n]=i[n][1];return t}return t.sort(s),t}function h(t){if(0===t.length)return[];for(var r=1,e=t.length,i=1;i<e;++i){var n=t[i];if(s(n,t[i-1])){if(i===r){r++;continue}t[r++]=n}}return t.length=r,t}function u(t,r){for(var e=0,i=t.length-1,n=-1;e<=i;){var o=e+i>>1,a=s(t[o],r);a<=0?(0===a&&(n=o),e=o+1):a>0&&(i=o-1)}return n}function p(t,r){for(var e=new Array(t.length),n=0,o=e.length;n<o;++n)e[n]=[];for(var a=[],h=(n=0,r.length);n<h;++n)for(var p=r[n],l=p.length,f=1,c=1<<l;f<c;++f){a.length=i.popCount(f);for(var v=0,d=0;d<l;++d)f&1<<d&&(a[v++]=p[d]);var g=u(t,a);if(!(g<0))for(;e[g++].push(n),!(g>=t.length||0!==s(t[g],a)););}return e}function l(t,r){if(r<0)return[];for(var e=[],n=(1<<r+1)-1,s=0;s<t.length;++s)for(var o=t[s],h=n;h<1<<o.length;h=i.nextCombination(h)){for(var u=new Array(r+1),p=0,l=0;l<o.length;++l)h&1<<l&&(u[p++]=o[l]);e.push(u)}return a(e)}r.dimension=function(t){for(var r=0,e=Math.max,i=0,n=t.length;i<n;++i)r=e(r,t[i].length);return r-1},r.countVertices=function(t){for(var r=-1,e=Math.max,i=0,n=t.length;i<n;++i)for(var s=t[i],o=0,a=s.length;o<a;++o)r=e(r,s[o]);return r+1},r.cloneCells=function(t){for(var r=new Array(t.length),e=0,i=t.length;e<i;++e)r[e]=t[e].slice(0);return r},r.compareCells=s,r.normalize=a,r.unique=h,r.findCell=u,r.incidence=p,r.dual=function(t,r){if(!r)return p(h(l(t,0)),t);for(var e=new Array(r),i=0;i<r;++i)e[i]=[];i=0;for(var n=t.length;i<n;++i)for(var s=t[i],o=0,a=s.length;o<a;++o)e[s[o]].push(i);return e},r.explode=function(t){for(var r=[],e=0,i=t.length;e<i;++e)for(var n=t[e],s=0|n.length,o=1,h=1<<s;o<h;++o){for(var u=[],p=0;p<s;++p)o>>>p&1&&u.push(n[p]);r.push(u)}return a(r)},r.skeleton=l,r.boundary=function(t){for(var r=[],e=0,i=t.length;e<i;++e)for(var n=t[e],s=0,o=n.length;s<o;++s){for(var h=new Array(n.length-1),u=0,p=0;u<o;++u)u!==s&&(h[p++]=n[u]);r.push(h)}return a(r)},r.connectedComponents=function(t,r){return r?function(t,r){for(var e=new n(r),i=0;i<t.length;++i)for(var s=t[i],o=0;o<s.length;++o)for(var a=o+1;a<s.length;++a)e.link(s[o],s[a]);var h=[],u=e.ranks;for(i=0;i<u.length;++i)u[i]=-1;for(i=0;i<t.length;++i){var p=e.find(t[i][0]);u[p]<0?(u[p]=h.length,h.push([t[i].slice(0)])):h[u[p]].push(t[i].slice(0))}return h}(t,r):function(t){for(var r=h(a(l(t,0))),e=new n(r.length),i=0;i<t.length;++i)for(var s=t[i],o=0;o<s.length;++o)for(var p=u(r,[s[o]]),f=o+1;f<s.length;++f)e.link(p,u(r,[s[f]]));var c=[],v=e.ranks;for(i=0;i<v.length;++i)v[i]=-1;for(i=0;i<t.length;++i){var d=e.find(u(r,[t[i][0]]));v[d]<0?(v[d]=c.length,c.push([t[i].slice(0)])):c[v[d]].push(t[i].slice(0))}return c}(t)}},1417:function(t,r,e){"use strict";t.exports=function(t){var r=t.length;if(0===r)return[];if(1===r)return[0];for(var e=t[0].length,i=[t[0]],s=[0],o=1;o<r;++o)if(i.push(t[o]),n(i,e)){if(s.push(o),s.length===e+1)return s}else i.pop();return s};var i=e(417);function n(t,r){for(var e=new Array(r+1),n=0;n<t.length;++n)e[n]=t[n];for(n=0;n<=t.length;++n){for(var s=t.length;s<=r;++s){for(var o=new Array(r),a=0;a<r;++a)o[a]=Math.pow(s+1-n,a);e[s]=o}if(i.apply(void 0,e))return!0}return!1}},1418:function(t,r,e){var i=e(413),n=i("./triangle-vertex.glsl"),s=i("./triangle-fragment.glsl"),o=i("./edge-vertex.glsl"),a=i("./edge-fragment.glsl"),h=i("./point-vertex.glsl"),u=i("./point-fragment.glsl"),p=i("./pick-vertex.glsl"),l=i("./pick-fragment.glsl"),f=i("./pick-point-vertex.glsl"),c=i("./contour-vertex.glsl"),v=i("./contour-fragment.glsl");r.meshShader={vertex:n,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},r.wireShader={vertex:o,fragment:a,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},r.pointShader={vertex:h,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},r.pickShader={vertex:p,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},r.pointPickShader={vertex:f,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},r.contourShader={vertex:c,fragment:v,attributes:[{name:"position",type:"vec3"}]}},1419:function(t,r,e){"use strict";var i=e(1420),n=e(1423);function s(t,r){for(var e=[0,0,0,0],i=0;i<4;++i)for(var n=0;n<4;++n)e[n]+=t[4*i+n]*r[i];return e}function o(t,r,e,i,n){for(var o=s(i,s(e,s(r,[t[0],t[1],t[2],1]))),a=0;a<3;++a)o[a]/=o[3];return[.5*n[0]*(1+o[0]),.5*n[1]*(1-o[1])]}function a(t,r){for(var e=[0,0,0],i=0;i<t.length;++i)for(var n=t[i],s=r[i],o=0;o<3;++o)e[o]+=s*n[o];return e}t.exports=function(t,r,e,s,h,u){if(1===t.length)return[0,t[0].slice()];for(var p=new Array(t.length),l=0;l<t.length;++l)p[l]=o(t[l],e,s,h,u);var f=0,c=1/0;for(l=0;l<p.length;++l){for(var v=0,d=0;d<2;++d)v+=Math.pow(p[l][d]-r[d],2);v<c&&(c=v,f=l)}var g=function(t,r){if(2===t.length){for(var e=0,s=0,o=0;o<2;++o)e+=Math.pow(r[o]-t[0][o],2),s+=Math.pow(r[o]-t[1][o],2);return e=Math.sqrt(e),s=Math.sqrt(s),e+s<1e-6?[1,0]:[s/(e+s),e/(s+e)]}if(3===t.length){var a=[0,0];return n(t[0],t[1],t[2],r,a),i(t,a)}return[]}(p,r),m=0;for(l=0;l<3;++l){if(g[l]<-.001||g[l]>1.0001)return null;m+=g[l]}if(Math.abs(m-1)>.001)return null;return[f,a(t,g),g]}},1420:function(t,r,e){"use strict";t.exports=function(t,r){for(var e=r.length,s=new Array(e+1),o=0;o<e;++o){for(var a=new Array(e+1),h=0;h<=e;++h)a[h]=t[h][o];s[o]=a}s[e]=new Array(e+1);for(o=0;o<=e;++o)s[e][o]=1;var u=new Array(e+1);for(o=0;o<e;++o)u[o]=r[o];u[e]=1;var p=i(s,u),l=n(p[e+1]);0===l&&(l=1);var f=new Array(e+1);for(o=0;o<=e;++o)f[o]=n(p[o])/l;return f};var i=e(1094);function n(t){for(var r=0,e=0;e<t.length;++e)r+=t[e];return r}},1421:function(t,r,e){"use strict";var i=e(458),n=e(439),s=e(496),o=e(1422);function a(t,r){for(var e=new Array(t.length-1),i=1;i<t.length;++i)for(var n=e[i-1]=new Array(t.length-1),s=0,o=0;s<t.length;++s)s!==r&&(n[o++]=t[i][s]);return e}function h(t){for(var r=new Array(t),e=0;e<t;++e){r[e]=new Array(t);for(var i=0;i<t;++i)r[e][i]=["m[",e,"][",i,"]"].join("")}return r}function u(t){if(2===t.length)return["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("");for(var r=[],e=0;e<t.length;++e)r.push(["scale(",u(a(t,e)),",",(i=e,1&i?"-":""),t[0][e],")"].join(""));return function t(r){if(1===r.length)return r[0];if(2===r.length)return["sum(",r[0],",",r[1],")"].join("");var e=r.length>>1;return["sum(",t(r.slice(0,e)),",",t(r.slice(e)),")"].join("")}(r);var i}function p(t){return new Function("sum","scale","prod","compress",["function robustDeterminant",t,"(m){return compress(",u(h(t)),")};return robustDeterminant",t].join(""))(n,s,i,o)}var l=[function(){return[0]},function(t){return[t[0][0]]}];!function(){for(;l.length<6;)l.push(p(l.length));for(var r=[],e=["function robustDeterminant(m){switch(m.length){"],i=0;i<6;++i)r.push("det"+i),e.push("case ",i,":return det",i,"(m);");e.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),r.push("CACHE","gen",e.join(""));var n=Function.apply(void 0,r);for(t.exports=n.apply(void 0,l.concat([l,p])),i=0;i<l.length;++i)t.exports[i]=l[i]}()},1422:function(t,r,e){"use strict";t.exports=function(t){for(var r=t.length,e=t[t.length-1],i=r,n=r-2;n>=0;--n){var s=e,o=t[n];(h=o-((e=s+o)-s))&&(t[--i]=e,e=h)}var a=0;for(n=i;n<r;++n){var h;s=t[n];(h=(o=e)-((e=s+o)-s))&&(t[a++]=h)}return t[a++]=e,t.length=a,t}},1423:function(t,r,e){"use strict";var i=new Float64Array(4),n=new Float64Array(4),s=new Float64Array(4);t.exports=function(t,r,e,o,a){i.length<o.length&&(i=new Float64Array(o.length),n=new Float64Array(o.length),s=new Float64Array(o.length));for(var h=0;h<o.length;++h)i[h]=t[h]-o[h],n[h]=r[h]-t[h],s[h]=e[h]-t[h];var u=0,p=0,l=0,f=0,c=0,v=0;for(h=0;h<o.length;++h){var d=n[h],g=s[h],m=i[h];u+=d*d,p+=d*g,l+=g*g,f+=m*d,c+=m*g,v+=m*m}var y,x,b,A,w,j=Math.abs(u*l-p*p),_=p*c-l*f,k=p*f-u*c;if(_+k<=j)if(_<0)k<0&&f<0?(k=0,-f>=u?(_=1,y=u+2*f+v):y=f*(_=-f/u)+v):(_=0,c>=0?(k=0,y=v):-c>=l?(k=1,y=l+2*c+v):y=c*(k=-c/l)+v);else if(k<0)k=0,f>=0?(_=0,y=v):-f>=u?(_=1,y=u+2*f+v):y=f*(_=-f/u)+v;else{var S=1/j;y=(_*=S)*(u*_+p*(k*=S)+2*f)+k*(p*_+l*k+2*c)+v}else _<0?(b=l+c)>(x=p+f)?(A=b-x)>=(w=u-2*p+l)?(_=1,k=0,y=u+2*f+v):y=(_=A/w)*(u*_+p*(k=1-_)+2*f)+k*(p*_+l*k+2*c)+v:(_=0,b<=0?(k=1,y=l+2*c+v):c>=0?(k=0,y=v):y=c*(k=-c/l)+v):k<0?(b=u+f)>(x=p+c)?(A=b-x)>=(w=u-2*p+l)?(k=1,_=0,y=l+2*c+v):y=(_=1-(k=A/w))*(u*_+p*k+2*f)+k*(p*_+l*k+2*c)+v:(k=0,b<=0?(_=1,y=u+2*f+v):f>=0?(_=0,y=v):y=f*(_=-f/u)+v):(A=l+c-p-f)<=0?(_=0,k=1,y=l+2*c+v):A>=(w=u-2*p+l)?(_=1,k=0,y=u+2*f+v):y=(_=A/w)*(u*_+p*(k=1-_)+2*f)+k*(p*_+l*k+2*c)+v;var C=1-_-k;for(h=0;h<o.length;++h)a[h]=C*t[h]+_*r[h]+k*e[h];return y<0?0:y}},751:function(t,r,e){"use strict";var i=e(418),n=e(411),s=e(475),o=e(540),a=e(1406),h=e(558),u=e(529),p=e(431),l=e(883),f=e(1407),c=e(402),v=e(1418),d=e(1419),g=v.meshShader,m=v.wireShader,y=v.pointShader,x=v.pickShader,b=v.pointPickShader,A=v.contourShader,w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function j(t,r,e,i,n,s,o,a,h,u,p,l,f,c,v,d,g,m,y,x,b,A,j,_,k,S,C){this.gl=t,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=r,this.dirty=!0,this.triShader=e,this.lineShader=i,this.pointShader=n,this.pickShader=s,this.pointPickShader=o,this.contourShader=a,this.trianglePositions=h,this.triangleColors=p,this.triangleNormals=f,this.triangleUVs=l,this.triangleIds=u,this.triangleVAO=c,this.triangleCount=0,this.lineWidth=1,this.edgePositions=v,this.edgeColors=g,this.edgeUVs=m,this.edgeIds=d,this.edgeVAO=y,this.edgeCount=0,this.pointPositions=x,this.pointColors=A,this.pointUVs=j,this.pointSizes=_,this.pointIds=b,this.pointVAO=k,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=S,this.contourVAO=C,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=w,this._view=w,this._projection=w,this._resolution=[1,1]}var _=j.prototype;function k(t,r){if(!r)return 1;if(!r.length)return 1;for(var e=0;e<r.length;++e){if(r.length<2)return 1;if(r[e][0]===t)return r[e][1];if(r[e][0]>t&&e>0){var i=(r[e][0]-t)/(r[e][0]-r[e-1][0]);return r[e][1]*(1-i)+i*r[e-1][1]}}return 1}function S(t){var r=i(t,g.vertex,g.fragment);return r.attributes.position.location=0,r.attributes.color.location=2,r.attributes.uv.location=3,r.attributes.normal.location=4,r}function C(t){var r=i(t,m.vertex,m.fragment);return r.attributes.position.location=0,r.attributes.color.location=2,r.attributes.uv.location=3,r}function I(t){var r=i(t,y.vertex,y.fragment);return r.attributes.position.location=0,r.attributes.color.location=2,r.attributes.uv.location=3,r.attributes.pointSize.location=4,r}function V(t){var r=i(t,x.vertex,x.fragment);return r.attributes.position.location=0,r.attributes.id.location=1,r}function E(t){var r=i(t,b.vertex,b.fragment);return r.attributes.position.location=0,r.attributes.id.location=1,r.attributes.pointSize.location=4,r}function M(t){var r=i(t,A.vertex,A.fragment);return r.attributes.position.location=0,r}_.isOpaque=function(){return!this.hasAlpha},_.isTransparent=function(){return this.hasAlpha},_.pickSlots=1,_.setPickBase=function(t){this.pickId=t},_.highlight=function(t){if(t&&this.contourEnable){for(var r=f(this.cells,this.intensity,t.intensity),e=r.cells,i=r.vertexIds,n=r.vertexWeights,s=e.length,o=c.mallocFloat32(6*s),a=0,h=0;h<s;++h)for(var u=e[h],p=0;p<2;++p){var l=u[0];2===u.length&&(l=u[p]);for(var v=i[l][0],d=i[l][1],g=n[l],m=1-g,y=this.positions[v],x=this.positions[d],b=0;b<3;++b)o[a++]=g*y[b]+m*x[b]}this.contourCount=a/3|0,this.contourPositions.update(o.subarray(0,a)),c.free(o)}else this.contourCount=0},_.update=function(t){t=t||{};var r=this.gl;this.dirty=!0,"contourEnable"in t&&(this.contourEnable=t.contourEnable),"contourColor"in t&&(this.contourColor=t.contourColor),"lineWidth"in t&&(this.lineWidth=t.lineWidth),"lightPosition"in t&&(this.lightPosition=t.lightPosition),this.hasAlpha=!1,"opacity"in t&&(this.opacity=t.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in t&&(this.opacityscale=t.opacityscale,this.hasAlpha=!0),"ambient"in t&&(this.ambientLight=t.ambient),"diffuse"in t&&(this.diffuseLight=t.diffuse),"specular"in t&&(this.specularLight=t.specular),"roughness"in t&&(this.roughness=t.roughness),"fresnel"in t&&(this.fresnel=t.fresnel),t.texture?(this.texture.dispose(),this.texture=o(r,t.texture)):t.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=r.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=r.LINEAR,this.texture.setPixels(function(t,r){for(var e=l({colormap:t,nshades:256,format:"rgba"}),i=new Uint8Array(1024),n=0;n<256;++n){for(var s=e[n],o=0;o<3;++o)i[4*n+o]=s[o];i[4*n+3]=r?255*k(n/255,r):255*s[3]}return p(i,[256,256,4],[4,0,1])}(t.colormap,this.opacityscale)),this.texture.generateMipmap());var e=t.cells,i=t.positions;if(i&&e){var n=[],s=[],h=[],u=[],f=[],c=[],v=[],d=[],g=[],m=[],y=[],x=[],b=[],A=[];this.cells=e,this.positions=i;var w=t.vertexNormals,j=t.cellNormals,_=void 0===t.vertexNormalsEpsilon?1e-6:t.vertexNormalsEpsilon,S=void 0===t.faceNormalsEpsilon?1e-6:t.faceNormalsEpsilon;t.useFacetNormals&&!j&&(j=a.faceNormals(e,i,S)),j||w||(w=a.vertexNormals(e,i,_));var C=t.vertexColors,I=t.cellColors,V=t.meshColor||[1,1,1,1],E=t.vertexUVs,M=t.vertexIntensity,O=t.cellUVs,F=t.cellIntensity,N=1/0,L=-1/0;if(!E&&!O)if(M)if(t.vertexIntensityBounds)N=+t.vertexIntensityBounds[0],L=+t.vertexIntensityBounds[1];else for(var z=0;z<M.length;++z){var P=M[z];N=Math.min(N,P),L=Math.max(L,P)}else if(F)if(t.cellIntensityBounds)N=+t.cellIntensityBounds[0],L=+t.cellIntensityBounds[1];else for(z=0;z<F.length;++z){P=F[z];N=Math.min(N,P),L=Math.max(L,P)}else for(z=0;z<i.length;++z){P=i[z][2];N=Math.min(N,P),L=Math.max(L,P)}this.intensity=M||(F||function(t){for(var r=t.length,e=new Array(r),i=0;i<r;++i)e[i]=t[i][2];return e}(i)),this.pickVertex=!(F||I);var U=t.pointSizes,B=t.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(z=0;z<i.length;++z)for(var T=i[z],W=0;W<3;++W)!isNaN(T[W])&&isFinite(T[W])&&(this.bounds[0][W]=Math.min(this.bounds[0][W],T[W]),this.bounds[1][W]=Math.max(this.bounds[1][W],T[W]));var R=0,q=0,D=0;t:for(z=0;z<e.length;++z){var H=e[z];switch(H.length){case 1:for(T=i[Y=H[0]],W=0;W<3;++W)if(isNaN(T[W])||!isFinite(T[W]))continue t;m.push(T[0],T[1],T[2]),J=C?C[Y]:I?I[z]:V,this.opacityscale&&M?s.push(J[0],J[1],J[2],this.opacity*k((M[Y]-N)/(L-N),this.opacityscale)):3===J.length?y.push(J[0],J[1],J[2],this.opacity):(y.push(J[0],J[1],J[2],J[3]*this.opacity),J[3]<1&&(this.hasAlpha=!0)),K=E?E[Y]:M?[(M[Y]-N)/(L-N),0]:O?O[z]:F?[(F[z]-N)/(L-N),0]:[(T[2]-N)/(L-N),0],x.push(K[0],K[1]),U?b.push(U[Y]):b.push(B),A.push(z),D+=1;break;case 2:for(W=0;W<2;++W){T=i[Y=H[W]];for(var G=0;G<3;++G)if(isNaN(T[G])||!isFinite(T[G]))continue t}for(W=0;W<2;++W){T=i[Y=H[W]];c.push(T[0],T[1],T[2]),J=C?C[Y]:I?I[z]:V,this.opacityscale&&M?s.push(J[0],J[1],J[2],this.opacity*k((M[Y]-N)/(L-N),this.opacityscale)):3===J.length?v.push(J[0],J[1],J[2],this.opacity):(v.push(J[0],J[1],J[2],J[3]*this.opacity),J[3]<1&&(this.hasAlpha=!0)),K=E?E[Y]:M?[(M[Y]-N)/(L-N),0]:O?O[z]:F?[(F[z]-N)/(L-N),0]:[(T[2]-N)/(L-N),0],d.push(K[0],K[1]),g.push(z)}q+=1;break;case 3:for(W=0;W<3;++W)for(T=i[Y=H[W]],G=0;G<3;++G)if(isNaN(T[G])||!isFinite(T[G]))continue t;for(W=0;W<3;++W){var Y,J,K,Q;T=i[Y=H[2-W]];n.push(T[0],T[1],T[2]),(J=C?C[Y]:I?I[z]:V)?this.opacityscale&&M?s.push(J[0],J[1],J[2],this.opacity*k((M[Y]-N)/(L-N),this.opacityscale)):3===J.length?s.push(J[0],J[1],J[2],this.opacity):(s.push(J[0],J[1],J[2],J[3]*this.opacity),J[3]<1&&(this.hasAlpha=!0)):s.push(.5,.5,.5,1),K=E?E[Y]:M?[(M[Y]-N)/(L-N),0]:O?O[z]:F?[(F[z]-N)/(L-N),0]:[(T[2]-N)/(L-N),0],u.push(K[0],K[1]),Q=w?w[Y]:j[z],h.push(Q[0],Q[1],Q[2]),f.push(z)}R+=1}}this.pointCount=D,this.edgeCount=q,this.triangleCount=R,this.pointPositions.update(m),this.pointColors.update(y),this.pointUVs.update(x),this.pointSizes.update(b),this.pointIds.update(new Uint32Array(A)),this.edgePositions.update(c),this.edgeColors.update(v),this.edgeUVs.update(d),this.edgeIds.update(new Uint32Array(g)),this.trianglePositions.update(n),this.triangleColors.update(s),this.triangleUVs.update(u),this.triangleNormals.update(h),this.triangleIds.update(new Uint32Array(f))}},_.drawTransparent=_.draw=function(t){t=t||{};for(var r=this.gl,e=t.model||w,i=t.view||w,n=t.projection||w,s=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],o=0;o<3;++o)s[0][o]=Math.max(s[0][o],this.clipBounds[0][o]),s[1][o]=Math.min(s[1][o],this.clipBounds[1][o]);var a={model:e,view:i,projection:n,inverseModel:w.slice(),clipBounds:s,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};a.inverseModel=u(a.inverseModel,a.model),r.disable(r.CULL_FACE),this.texture.bind(0);var p=new Array(16);h(p,a.view,a.model),h(p,a.projection,p),u(p,p);for(o=0;o<3;++o)a.eyePosition[o]=p[12+o]/p[15];var l,f=p[15];for(o=0;o<3;++o)f+=this.lightPosition[o]*p[4*o+3];for(o=0;o<3;++o){for(var c=p[12+o],v=0;v<3;++v)c+=p[4*v+o]*this.lightPosition[v];a.lightPosition[o]=c/f}this.triangleCount>0&&((l=this.triShader).bind(),l.uniforms=a,this.triangleVAO.bind(),r.drawArrays(r.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind());this.edgeCount>0&&this.lineWidth>0&&((l=this.lineShader).bind(),l.uniforms=a,this.edgeVAO.bind(),r.lineWidth(this.lineWidth*this.pixelRatio),r.drawArrays(r.LINES,0,2*this.edgeCount),this.edgeVAO.unbind());this.pointCount>0&&((l=this.pointShader).bind(),l.uniforms=a,this.pointVAO.bind(),r.drawArrays(r.POINTS,0,this.pointCount),this.pointVAO.unbind());this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((l=this.contourShader).bind(),l.uniforms=a,this.contourVAO.bind(),r.drawArrays(r.LINES,0,this.contourCount),this.contourVAO.unbind())},_.drawPick=function(t){t=t||{};for(var r=this.gl,e=t.model||w,i=t.view||w,n=t.projection||w,s=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],o=0;o<3;++o)s[0][o]=Math.max(s[0][o],this.clipBounds[0][o]),s[1][o]=Math.min(s[1][o],this.clipBounds[1][o]);this._model=[].slice.call(e),this._view=[].slice.call(i),this._projection=[].slice.call(n),this._resolution=[r.drawingBufferWidth,r.drawingBufferHeight];var a,h={model:e,view:i,projection:n,clipBounds:s,pickId:this.pickId/255};((a=this.pickShader).bind(),a.uniforms=h,this.triangleCount>0&&(this.triangleVAO.bind(),r.drawArrays(r.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),r.lineWidth(this.lineWidth*this.pixelRatio),r.drawArrays(r.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0)&&((a=this.pointPickShader).bind(),a.uniforms=h,this.pointVAO.bind(),r.drawArrays(r.POINTS,0,this.pointCount),this.pointVAO.unbind())},_.pick=function(t){if(!t)return null;if(t.id!==this.pickId)return null;for(var r=t.value[0]+256*t.value[1]+65536*t.value[2],e=this.cells[r],i=this.positions,n=new Array(e.length),s=0;s<e.length;++s)n[s]=i[e[s]];var o=t.coord[0],a=t.coord[1];if(!this.pickVertex){var h=this.positions[e[0]],u=this.positions[e[1]],p=this.positions[e[2]],l=[(h[0]+u[0]+p[0])/3,(h[1]+u[1]+p[1])/3,(h[2]+u[2]+p[2])/3];return{_cellCenter:!0,position:[o,a],index:r,cell:e,cellId:r,intensity:this.intensity[r],dataCoordinate:l}}var f=d(n,[o*this.pixelRatio,this._resolution[1]-a*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!f)return null;var c=f[2],v=0;for(s=0;s<e.length;++s)v+=c[s]*this.intensity[e[s]];return{position:f[1],index:e[f[0]],cell:e,cellId:r,intensity:v,dataCoordinate:this.positions[e[f[0]]]}},_.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},t.exports=function(t,r){1===arguments.length&&(t=(r=t).gl);var e=t.getExtension("OES_standard_derivatives")||t.getExtension("MOZ_OES_standard_derivatives")||t.getExtension("WEBKIT_OES_standard_derivatives");if(!e)throw new Error("derivatives not supported");var i=S(t),a=C(t),h=I(t),u=V(t),l=E(t),f=M(t),c=o(t,p(new Uint8Array([255,255,255,255]),[1,1,4]));c.generateMipmap(),c.minFilter=t.LINEAR_MIPMAP_LINEAR,c.magFilter=t.LINEAR;var v=n(t),d=n(t),g=n(t),m=n(t),y=n(t),x=s(t,[{buffer:v,type:t.FLOAT,size:3},{buffer:y,type:t.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:d,type:t.FLOAT,size:4},{buffer:g,type:t.FLOAT,size:2},{buffer:m,type:t.FLOAT,size:3}]),b=n(t),A=n(t),w=n(t),_=n(t),k=s(t,[{buffer:b,type:t.FLOAT,size:3},{buffer:_,type:t.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:t.FLOAT,size:4},{buffer:w,type:t.FLOAT,size:2}]),O=n(t),F=n(t),N=n(t),L=n(t),z=n(t),P=s(t,[{buffer:O,type:t.FLOAT,size:3},{buffer:z,type:t.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:F,type:t.FLOAT,size:4},{buffer:N,type:t.FLOAT,size:2},{buffer:L,type:t.FLOAT,size:1}]),U=n(t),B=s(t,[{buffer:U,type:t.FLOAT,size:3}]),T=new j(t,c,i,a,h,u,l,f,v,y,d,g,m,x,b,_,A,w,k,O,z,F,N,L,P,U,B);return T.update(r),T}}}]);